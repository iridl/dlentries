\begin{ingrid}

%For detailed commentaries see the temperature index.tex file. Here I will document only the specificities of that dataset

%/CarterCenter dataareRestricted

continuedataset:

%This starts the definition of specific colorscales for this dataset
%Go to the IRI Data Library tutorials to find out how to make colorscales

Ingrid:

/rfediff_colors { %starts teh definition of a colorscale names  rfediff_colors.
startcolormap -150 150 RANGE
DimGray sienna
sienna -150 VALUE
sienna sienna -100 bandmax
peru peru -50 bandmax
burlywood burlywood -25 bandmax
wheat wheat -5 bandmax
LightYellow LightYellow 5 bandmax
LightCyan LightCyan 25 bandmax
PaleTurquoise PaleTurquoise 50 bandmax
MediumAquamarine MediumAquamarine 100 bandmax
CadetBlue CadetBlue 150 bandmax
CadetBlue
endcolormap
}defcolorscale %ends the definition of colorscales

%the same for another colorscale

/rfepercent_colors {
startcolormap
0 300 RANGE
transparent white SaddleBrown
0 VALUE
SaddleBrown SaddleBrown
25 bandmax
peru peru
50 bandmax
burlywood burlywood
75 bandmax
wheat wheat
100 bandmax
LightCyan LightCyan
120 bandmax
aquamarine aquamarine 140
bandmax
MediumAquamarine MediumAquamarine 160
bandmax
MediumSeaGreen MediumSeaGreen 180
bandmax
SeaGreen SeaGreen 200
bandmax
DarkSeaGreen DarkSeaGreen 300
bandmax
DarkSeaGreen endcolormap
}defcolorscale

pop %ends the definition of colorscales

%datasetdefs:
/T
1 Jan 1983 julian_day
31 Dec 2014 julian_day
%systemtime (%d %b %Y) 12 strftime interp julian_day
dekadGRID
/defaultvalue { last } def
def
%:datasetdefs

grid:
/name /X def
/units /degree_east def
 33.01875  0.0375 47.98125
/long_name (Longitude) def
:grid


grid:
/name /Y def
/units /degree_north def
 3.01875 0.0375 14.98125
/long_name (Latitude) def
:grid

 /rr_mrg{
[ X Y | T] (/Data/data23/NMA_Ethiopia_v4/RR/Merged/MON/rr_mrg_%Y%m[T]%-d[dekad]_MON.nc)
[T dup day2dom 5. add 10. div toi4 /name /dekad def ]
readdatafile:
/name (precip) def
/long_name (Merged Station-Satellite Rainfall) def
/units /mm def
%/missing_value -99 def
/shortarraytype netcdfrecords
:readdatafile
cmorph_dekad_colors %applies a colorscale named cmorph_dekad_colors to the variable
}defasvarsilent

%This section defines variables that are computed from the variables that were read from datafiles. They don't read any actual datafiles, theyr are pure Ingrid code.

/SPI-rr_mrg_1-dekad { %starts a varaible and names it
rr_mrg %selects the rfe_adf precipitation variable
  1 36 gamma3par %starts the computation of SPI for dekadla precipitation variable
  pcpn_accum gmean gsd gskew pzero 1 gammaprobs
  1 gammastandardize %ends computation SPI for dekadal precipitation variable
  /long_name (Standard Precipitation Index 1-dekad) def %gives the variables a more understandable name to show up in maps and graphs
}defasvarsilent %ends the definition of the variables

/rr_mrgdiff { %starts a variable and names it
  rr_mrg %selects rfe_adj variable
  SOURCES .Ethiopia .NMA .ENACTS_v4 .rainfall .MRG .MON .dekadly .climatologies .rr_mrg %selects dekadal climatology
   T 2 index .T %starts the computation of dekadal anomalies from dekadal climatology
     a: .first cvsunits
       :a: .last cvsunits :a
      RANGE
   T 2 index .T replaceGRID
   sub %ends the computation of dekadal anomalies from dekadal climatology
%Note that you can use those few lines for any dekadal data for which you have a dekadal climatology

startcolormap -150 150 RANGE %starts the definition of a new colorscale for this variable
DimGray sienna
sienna -150 VALUE
sienna sienna -100 bandmax
peru peru -50 bandmax
burlywood burlywood -25 bandmax
wheat wheat -5 bandmax
LightYellow LightYellow 5 bandmax
LightCyan LightCyan 25 bandmax
PaleTurquoise PaleTurquoise 50 bandmax
MediumAquamarine MediumAquamarine 100 bandmax
CadetBlue CadetBlue 150 bandmax
CadetBlue
endcolormap % ends the definition of a new colorscale for this variable

/long_name (Merged Station-Satellite Rainfall Anomaly) def %gives the variable a more descriptive name

}defasvarsilent %ends the variable definiton

%Same as above but computes the relative difference between rfe_adj and its climatology
%Try to copy and paste the code that is within the curly brackets '{' and '}' and see what the code is doing step by step

/rr_mrgdiff_percent {
rr_mrg
  SOURCES .Ethiopia .NMA .ENACTS_v4 .rainfall .MRG .MON .dekadly .climatologies .rr_mrg
   T 2 index .T
     a: .first cvsunits
       :a: .last cvsunits :a
      RANGE
   T 2 index .T replaceGRID
   sub
  SOURCES .Ethiopia .NMA .ENACTS_v4 .rainfall .MRG .MON .dekadly .climatologies .rr_mrg
   10 maskle
   T 2 index .T
     a: .first cvsunits
       :a: .last cvsunits :a
      RANGE
   T 2 index .T replaceGRID
   div
  100 mul
%  -1000 replaceNaN
/units /percent def
  startcolormap
    -100 400 RANGE
%    LightSteelBlue ivory SaddleBrown
transparent ivory SaddleBrown
       -100 VALUE
       SaddleBrown SaddleBrown
         -60 bandmax
         peru peru
           -40 bandmax
           burlywood burlywood
             -20 bandmax
             wheat wheat
               0 bandmax
               LightCyan LightCyan
                 40 bandmax
                 aquamarine aquamarine
                   80 bandmax
                   MediumAquamarine MediumAquamarine 120
                     bandmax
                     MediumSeaGreen MediumSeaGreen 200
                     bandmax
                     SeaGreen SeaGreen 300
                     bandmax
                     DarkSeaGreen DarkSeaGreen 400
                     bandmax
                     DarkSeaGreen endcolormap
  /long_name (Merged Station-Satellite Rainfall Difference Expressed as Percent of Long-Term Average (%)) def
}defasvar

/rr_mrg_vs_meanrr_mrg {
rr_mrg
  SOURCES .Ethiopia .NMA .ENACTS_v4 .rainfall .MRG .MON .dekadly .climatologies .rr_mrg
   7 maskle
   T 2 index .T
     a: .first cvsunits
       :a: .last cvsunits :a
      RANGE
   T 2 index .T replaceGRID
   div
  100 mul
%  -1000 replaceNaN
/units /percent def
rfepercent_colors
  /long_name (Merged Station-Satellite Rainfall Expressed as Percentages of the Long-Term Average) def
}defasvar

:dataset

\end{ingrid}
