\begin{ingrid}
  continuedataset:
  
  grid:
  /name (S) def
  /units (days since 1960-01-01) def
  /long_name (forecast start time) def
  /standard_name (forecast_reference_time) def
  13 Nov 2024 julian_day 01 Jan 1960 julian_day sub
  1.0
  systemtime
  (%d %b %Y) 12 strftime interp julian_day
  01 Jan 1960 julian_day sub
  /pointwidth 0. def
  /defaultvalue { last } def
  :grid
  
  %Adjustment of S grid according to the owner's specification -> 
  %      1/3/5/7/9/11/13/15/17/19/21/23/25/27/29/31 of each month (excluding 29 February)
  S monthlyedgesgrid
     name units gridtype mark gridvalues
        %The owner does not provide the 29th of Feb, so Feb will always go up to the 27th.
          {dup cvsunits (Feb) search {3 {pop}repeat 13 {dup 2 add}repeat}{ 
           % Apr, Jun, Sep and Nov They are months with 30 days, so these months will always go up to the 29th.
           (Apr) search {3 {pop}repeat 14 {dup 2 add}repeat} { 
              (Jun) search {3 {pop}repeat 14 {dup 2 add}repeat} { 
                 (Sep) search {3 {pop}repeat 14 {dup 2 add}repeat} { 
                    (Nov) search {3 {pop}repeat 14 {dup 2 add}repeat} 
                       %For the rest of the months, it will be shown up to the 31st.
                       {pop 15 {dup 2 add}repeat}
                       ifelse}
                    ifelse}
                 ifelse}
              ifelse}
           ifelse
           }forall counttomark realarray astore
          nip NewGRID
      /pointwidth 0.0 def
      %The calculations are done for each month starting on the 1st day, then it moves to November 13th, 
      % which is the date indicated by the owner as the first data of this version. 
      first 12 add last subgrid
      /defaultvalue { last } def
      replaceGRID


 S {(/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_2016%m%d[S]00_%Y%m%d[S].txt) [S]} removeextrausing
 name exch def

 S
 last
 35 add
 cvsunits interp
   3 -2 roll
   0.5 add
   exch ymd2systemtime
 nip
 /expires exch def
 name exch def
 
 /expires S .expires def


 grid:
 /name /hdate def
 /units (months since 1960-01-01) def
 01 Jul 2004 ensotime
 12.0
 % hdate must be one less year than the current year
 01 Jul  
 systemtime
 (%Y) 12 strftime
 interp 
 1 sub
 ensotime
 /defaultvalue { last } def
 :grid
 
 grid:
 /name /L def
 /long_name (Lead) def
 /standard_name (forecast_period) def
 /units (days) def
 1. 1. 46.
 /pointwidth 0. def
 :grid

 grid:
  /name /M def
  /long_name (Ensemble Member) def
  /standard_name (realization) def
  /units (ids) def
  0 1 10
:grid

dataset:
/name (ensembles) def

[ M L S hdate ] {name exch def } forall

 /RMM1 { [ M L | S hdate ] 
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
readdatafile:
((/,45(/,11(11X,F6.3,/)),(/,10(11X,F6.3,/),(11X,F6.3)))) formatted
:readdatafile
/missing_value -999 def
/long_name (RMM1) def
/units (unitless) def
} defasvarsilent

 /RMM2 { [ M L | S hdate ] 
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
 readdatafile:
 ((/,45(/,11(18X,F6.3,/)),(/,10(18X,F6.3,/),(18X,F6.3)))) formatted
 :readdatafile
 /missing_value -999 def
 /long_name (RMM2) def
 /units (unitless) def
 } defasvarsilent

 /amplitude { [ M L | S hdate ]
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
 readdatafile:
 ((/,45(/,11(25X,F6.3,/)),(/,10(25X,F6.3,/),(25X,F6.3)))) formatted
 :readdatafile
 /missing_value -999 def
 /long_name (amplitude) def
 /units (unitless) def
 } defasvarsilent

 /phase { [ M L | S hdate ]
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
 readdatafile:
 ((/,45(/,11(32X,F1.0,/)),(/,10(32X,F1.0,/),(32X,F1.0)))) formatted
 :readdatafile
 /missing_value -999 def
 /long_name (phase) def
 /units (unitless) def
 } defasvarsilent
:dataset

dataset:
/name (ensemble_mean) def

[ L S hdate ] {name exch def } forall

 /RMM1 { [ L | S hdate ] 
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
 readdatafile:
 ((/,45(11X,F6.3,12(/)),(11X,F6.3))) formatted
 :readdatafile
 /missing_value -999 def
 /long_name (RMM1) def
 /units (unitless) def
 } defasvarsilent

 /RMM2 { [ L | S hdate ]
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
 readdatafile:
 ((/,45(18X,F6.3,12(/)),(18X,F6.3))) formatted
 :readdatafile
 /missing_value -999 def
 /long_name (RMM2) def
 /units (unitless) def
 } defasvarsilent

 /amplitude { [ L | S hdate ] 
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
 readdatafile:
 /missing_value -999 def
 ((/,45(25X,F6.3,12(/)),(25X,F6.3))) formatted
 :readdatafile
 /long_name (amplitude) def
 /units (unitless) def
 } defasvarsilent

 /phase { [ L | S hdate ] 
 (/Data/data25/ECMWF/S2S/ECMF/REF/RMMS/%Y[S]/%m[S]/z_s2s_rmm_ecmf_prod_rf_%Y[hdate]%m%d[S]00_%Y%m%d[S].txt) [ S hdate ]
 readdatafile:
 /missing_value -999 def
 ((/,45(32X,F1.0,12(/)),(32X,F1.0))) formatted
 :readdatafile
 /long_name (phase) def
 /units (unitless) def
 } defasvarsilent

:dataset

  :dataset
\end{ingrid}
