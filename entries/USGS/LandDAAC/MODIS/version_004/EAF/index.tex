Output image info
-----------------
output image corners (lat/lon):
    UL:  40.000000000000 20.000000000000
    UR:  40.000000000000 60.002062980451
    LL:  -0.002062980451 20.000000000000
    LR:  -0.002062980451 60.002062980451

output image corners (X-Y projection units):
    UL:  20.000000000000 40.000000000000
    UR:  60.002062980451 40.000000000000
    LL:  20.000000000000 -0.002062980451
    LR:  60.002062980451 -0.002062980451

     band               type lines smpls pixsiz      min    max   fill
  1) 250m 16 days blue reflectance  INT16 18043 18043 0.0022      0  10000  -1000
End Time:  Mon Jul 31 18:06:09 2006
\begin{ingrid}
continuedataset:
/long_name (East Africa) def
/iridl:hasSemantics [(iridl:MiddleEast) (irigaz:Africa_East_303_0) ] def
grid:
/name /X def
degE
20. 60.002062980451
2 copy exch sub 18043 div exch
% converts edges to centers
1 index .5 mul sub
3 -1 roll
2 index .5 mul add
3 1 roll
:grid
grid:
/name /Y def
degN
40. -0.002062980451
2 copy exch sub 18043 div exch
% converts edges to centers
1 index .5 mul sub
3 -1 roll
2 index .5 mul add
3 1 roll
:grid
grid:
/name /T def
/units (days since 2003-01-01) def
\end{ingrid}
file 2004.05.08/MOD13Q1.A2004129.h17v07.004.2004148112503.hdf to  ../modus.2004/MOD13Q1.A2004129.h17v07.004.2004148112503.hdf

file 2004.05.24/MOD13Q1.A2004145.h19v08.004.2004165081004.hdf to  ../modus.2004/MOD13Q1.A2004145.h19v08.004.2004165081004.hdf

Turns out the first number is the first day of the interval, the second date is
not the end of the interval (the interval is 16 days wide). 
So I enter the edges grid and take the partial to get the right time grid.
Filenames are generated from the left edge values.
\begin{ingrid}
/pointwidth 0 def
values:
2000 
1
2000
{
dup  1 1 ymd2rjt 096 add 2003 1 1 ymd2rjt sub
exch
16. exch
1 add 1 1 ymd2rjt 2003 1 1 ymd2rjt sub
{} for
} for
2001
1
2008 % systemtime systemtime2ymd pop pop 1 sub
{
dup  1 1 ymd2rjt 2003 1 1 ymd2rjt sub
exch
16. exch
1 add 1 1 ymd2rjt 2003 1 1 ymd2rjt sub
{} for
} for
\end{ingrid}
systemtime systemtime2ymd pop pop 
1 1 ymd2rjt 2003 1 1 ymd2rjt sub
16.
systemtime
    systemtime2ymd ymd2rjt 2003 1 1 ymd2rjt sub
2 index 
     sub
    16 div
    cvi
    16 mul
2 index add
{} for
\begin{ingrid}
:values
:grid
/T T 
first
1 index
{(/Data/data21/usgs/landdaac/componentimagesAF_v004/A%Y%j[T]AF2.250m_16_days_MIR_reflectance.dat.gz) [T]}
removeextrausing
3 1 roll
     /last_modified 3 index .last_modified def
     3 -1 roll
.npts indextovalue subgrid
\end{ingrid}
this dataset no longer updates
/expires last 2003 1 1 ymd2rjt add 16 add
3 add % processing time
rjt2ymd ymd2systemtime
%(/Data/data8/usgs/landdaac/getmodisAF.rerun) fileexists?
%{
%systemtime systemtime2ymd ymd2systemtime 86400 add imin
%} if
def
\begin{ingrid}
partialgrid
/defaultvalue {last} def
def
%/expires T .expires def
/last_modified T .last_modified def
grid:
/name /band def
values: /MIR /NIR /red /blue :values
:grid
/reflectance
{[X Y | band T]
(/Data/data21/usgs/landdaac/componentimagesAF_v004/A%Y%j[T]AF2.250m_16_days_%s[band]_reflectance.dat.gz)
     [band T integralgrid first secondtolast subgrid]
readdatafile:
/missing_value -1000 def
/valid_min 0 def
/valid_max 10000 def
ui*2 :readdatafile
9999.   254 div   1 255 SCALEtoui1
}
%defasvarcachesilent
defasvarsilent
/NDVI
{[X Y | T]
(/Data/data21/usgs/landdaac/componentimagesAF_v004/A%Y%j[T]AF2.250m_16_days_NDVI.dat.gz)
     [T integralgrid first secondtolast subgrid]
readdatafile:
/missing_value -3000 def
/valid_min -2000 def
/valid_max 10000 def
/scale_factor 1e-4 def
ndvi_colorsMODIS
/scale_min valid_min def
/scale_max valid_max def
/iridl:hasSemantics (iridl:NDVI) def
ui*2 :readdatafile
%9999.   254 div   1 255 SCALEtoui1
} 
defasvarsilent
%defasvarcachesilent
/NDVI_Quality
{[X Y | T]
(/Data/data21/usgs/landdaac/componentimagesAF_v004/A%Y%j[T]AF2.250m_16_days_NDVI_Quality.dat.gz)
     [T integralgrid first secondtolast subgrid]
readdatafile:
/missing_value 65535 def
/valid_min 0 def
/valid_max 65534 def
ui*2 :readdatafile
%9999.   254 div   1 255 SCALEtoui1
} defasvarsilent
%defasvarcachesilent
/EVI
{[X Y | T]
(/Data/data21/usgs/landdaac/componentimagesAF_v004/A%Y%j[T]AF2.250m_16_days_EVI.dat.gz)
     [T integralgrid first secondtolast subgrid]
readdatafile:
/missing_value -3000 def
/valid_min -2000 def
/valid_max 10000 def
/scale_factor 1e-4 def
ndvi_colorsMODIS
/scale_min valid_min def
/scale_max valid_max def
ui*2 :readdatafile
%9999.   254 div   1 255 SCALEtoui1
} %defasvarsilent
defasvarcachesilent
/EVI_Quality
{[X Y | T]
(/Data/data21/usgs/landdaac/componentimagesAF_v004/A%Y%j[T]AF2.250m_16_days_EVI_Quality.dat.gz)
     [T integralgrid first secondtolast subgrid]
readdatafile:
/missing_value 65535 def
/valid_min 0 def
/valid_max 65534 def
ui*2 :readdatafile
%9999.   254 div   1 255 SCALEtoui1
} defasvarsilent
%defasvarcachesilent
:dataset
\end{ingrid}
