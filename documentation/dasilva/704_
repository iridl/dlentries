% Currently all figures are included 
%This file has been updated to include Volume 6.
% Check to make sure \epsfbox command is (un)commented.
%  file: atlas.tex - last update: 9/8/95 (ccy) 
%












%\documentstyle[art10,twocolumn,twoside,epsf]{article}
\documentstyle[epsf]{article}

  
%%%\include{epsf}

%This is used to in/ex-clude figures.
% Comment it out to include figures.
%-----------------------------------
%%%\def\epsfbox{\vspace{2in}}


% Text dimensions
% ---------------
\textheight 9.25in
\topmargin 0pt
\textwidth 40pc
%%%\oddsidemargin 0.25in
%%%\evensidemargin 0.25in
%%%\marginparwidth 0.25in
\oddsidemargin 0in
\evensidemargin 0in
\marginparwidth 0in
\columnsep 20pt 
\headsep 0pt
\headheight 0pt
\footskip 0.37in

\def\etall{{\em et al.}}
\def\deg{°}
%\def\deg{$^\circ$}
\def\[{\left [}
\def\]{\right ]}
\def\({\left (}
\def\){\right )}
\def\<{\left \langle}
\def\>{\right \rangle}
\let\text\mbox
\def\oW{{\overline{W}}}

\def\one{$1^\circ \times 1^\circ$}
\def\two{$2^\circ \times 2^\circ$}
\def\half{$0.5^\circ \times 0.5^\circ$}
\def\x{$\times$}
\def\text#1{{\mbox{\small #1}}}
\def\bQ{{\overline{Q_{net}}}}
\def\der#1#2{{ \partial #1\over \partial #2}}
\def\cH{{\cal H}}
\def\cHy{{\cal H}_y}
\def\cHd{ \hat{{\cal H}}_y}
\def\cF{{\cal F}}
\def\cFy{ {\cal F}_y}
\def\cFd{ \hat{{\cal F}_y} }
\def\cA{{\cal A}}
\def\cB{{\cal B}}


% Short hand for LaTeX environments
% ---------------------------------
\def\be{\begin{equation}}
\def\ee{\end{equation}}
\def\bea{\begin{eqnarray}}
\def\eea{\end{eqnarray}}
\def\bi{\begin{itemize}}
\def\ei{\end{itemize}}
\def\bn{\begin{enumerate}}
\def\en{\end{}}
\def\bd{\begin{description}}
\def\e{\end{description}}
\def\bt{\begin{tabular}}
\def\et{\end{tabular}}
\let\mcol\multicolumn
\def\diag{\mathop{\rm diag}}
\def\vp{{\bf p}}
\def\vq{{\bf q}}
\def\req#1{\ref{eq:#1}}
\def\reF#1{\ref{fig:#1}}
\def\ret#1{\ref{tab:#1}}
\def\bp{{\bf p}}
\def\dbp{{\delta {\bf p}}}
\def\Re{I\!\!R}
\def\bE{{\bf E}}
\def\bA{{\bf A}}
\def\bR{{\bf R}}
\def\bw{{\bf w}}
\def\bd{{\bf d}}
\def\ship{{\rm ship}}
\def\rand{{\rm rand}}
\def\fwb{{\rm fwb}}
\let\eps\epsilon


 




\def\titpage#1{\begin{titlepage}
\title{ {\bf Atlas of Surface Marine Data 1994}\\
%%%\vspace{1in}
 #1\\ \mbox{}}
\author{{\sc Arlindo M. da Silva
%%%\protect\footnote{Present affiliation:
%%%Data Assimilation Office, NASA/Goddard Space Flight Center, Greenbelt, Maryland.}
and Christine C. Young}\\ %%%\protect\footnote{Present affiliation:}}\\
{\em Department of Geosciences, University of Wisconsin--Milwaukee}\\
{\sc and}\\
{\sc Sydney Levitus} \\
{\em NOAA/National Oceanographic Data Center}}
%%%\date{Draft of \today}
\date{\vspace{2in}}
%%%\date{}

\end{titlepage}
}





\titpage{ {\bf Vol. 1: Algorithms and Procedures}}












\begin{document}


%%these four lines should be commented out in final make method
%%\tableofcontents
%%\newpage
%%\listoffigures
%%\newpage
%%\listoftables

\maketitle



\pagenumbering{roman}

%.....................................................................
\setcounter{page}{3}

%.................................................................


%.....................End Cover Pages, Begin Body...................


\pagenumbering{arabic}
\setcounter{page}{1}


%.....................................................................

\section{Introduction}

The compilation of the Comprehensive Ocean-Atmosphere Data Set (COADS)
as documented by Slutz \etall \ (1985) and Woodruff \etall\ (1987) has
provided climate researchers with the most complete record of surface
marine climate to date. The availability of this data set has
contributed significantly to advancing our understanding of the
atmosphere-ocean climate system. In addition to observational studies
based on COADS, atmospheric and oceanic modelers have relied on this
data set for boundary conditions in long-term integrations of
atmospheric and oceanic circulation models.

One of the main contributions of the COADS project was to unify
several historical data sets in a single, consistent format, and to
subject the ship reports to the same quality control procedure. This
homogenized data set is available in two forms: as monthly mean summaries
in 2- by 2-degree boxes over the global oceans, and as raw individual
observations.  Due to the massive number of individual ship reports,
the majority of researchers have used the monthly mean summaries.

In addition to the directly observed quantities (sea surface
temperature, surface air temperature, etc.), COADS monthly mean
summaries include a wealth of derived quantities such as moisture and
pseudo oceanic fluxes, in which transfer coefficients have been 
ignored.
In an
attempt to extend and improve the oceanic fluxes in COADS, a
collaborative project between the Department of Geosciences of the
University of Wisconsin-Milwaukee (UWM) and the National Oceanographic
Data Center/NOAA was initiated. The main goal of this project was to
produce high resolution (1-degree by 1-degree), stability dependent
heat and momentum fluxes, as well as evaporation, precipitation and
radiational fluxes which were absent from the COADS monthly mean
summaries. In addition to improved resolution and boundary layer
parameterizations, a new scientific Beaufort equivalent scale was
developed which reduces wind speed bias and artificial wind speed
trends in the post World War II period.


Our revised monthly mean summaries (henceforth referred to as
UWM/COADS monthly mean summaries) are available in the form of raw
monthly means, standard deviations, and number of observations in 1
by 1-degree boxes over the global oceans, from 1945 to 1989.  These
raw data are made available for those users desiring to perform their
own objective analysis. In addition, the monthly mean fields have been
objectively analyzed with essentially the same successive correction
scheme used by Levitus (1982).  It is important to note that although
the analyzed fields are given with a 1-degree grid spacing, only
wavelengths greater than about 770~km remain due to the smoothing
effects of the analysis. Climatological half-degree by half-degree
analyses have also been produced; these results will be
discussed elsewhere.


%........................... 1 ..........................

This atlas series presents objectively analyzed seasonal mean
anomalies along with climatology, standard deviations,
and observation density. This publication describes in detail the
method of analysis, bias corrections, and parameterizations adopted.
Also described is the format of the data in the UWM/COADS data set,
along with information on the software used to read the data.
The actual anomaly maps appear in subsequent volumes.  The directly
observed quantities are presented in Volume 2.  Volume 3 deals with heat
and momentum fluxes at the ocean surface. The buoyancy and fresh water
fluxes are presented in Volume 4 and additional derived quantities are
included in Volume 5.


%........................... OBSERVED ..............................


%........................... STRESS ..............................


%........................... FRESH ..............................


%........................... DERIVED ..............................


%........................... GRADIENTS ..............................



%.............................. 1 ..........................
%%% Discuss document organization %%%%


\section{Overview of data products}


The UWM/COADS data set is a collection of global \one \ raw and
analyzed gridded fields covering the period from January 1945 to
December 1989.  These fields have been derived primarily from
individual observations in COADS (see section~\ref{sec:data}), with
additional corrections as described in section~\ref{sec:correc}. Our
quality control procedure uses a more stringent criterion over regions
climatologically covered by sea ice; the climatological ice mask
used was derived from the sea surface temperature and sea ice data set
by Alexander and Mobley (1976).  In the calculation of buoyancy fluxes
(section~\ref{sec:parameterizations}) we use the recent estimates of
monthly mean salinity by Levitus \etall \ (1994). These two data sets
are included in UWM/COADS for the sake of completeness.


\begin{table*}[p] \caption[List of objectively analyzed
quantities.]{List of objectively analyzed quantities in UWM/COADS,
along with NetCDF file name and units.
Each file contains 12 monthly climatological grids and 540 monthly mean
anomaly grids from January/45 to December/89. The size of each file 
(with the exception of {\tt icemask.nc} and {\tt salinity.nc})
is approximately 46 Megabytes.}
\label{tab:vars}
\begin{center}
\begin{tabular}{lll}
\hline
\multicolumn{3}{c}{Directly Observed Quantities} \\
\hline
File Name &     Units &         Description \\ 
\hline
cloud.nc &      \%/100. &       fractional cloudiness \\
qair.nc &       g/kg    &       specific humidity \\
sat.nc  &       C       &       air temperature at measurement height\\
slp.nc  &       hPa     &       sea level air pressure \\
sst.nc  &       C       &       sea surface temperature \\
u3.nc   &       m/s     &       zonal wind \\
v3.nc   &       m/s     &       meridional wind \\
w3.nc   &       m/s     &       wind speed \\*[1ex]
\multicolumn{3}{c}{Heat and Momentum Fluxes} \\
\hline
ac.nc   &       W/m$^2$ &       short wave cloudiness sensitivity parameter \\
achi.nc &       W/m$^2$ &       long wave Chi sensitivity parameter \\
ae.nc   &       hPa     &       long wave vapor pressure sensitivity parameter \\
fvcubed.nc &    m$^3$/s$^3$ &   oceanic friction velocity cubed \\
latent3.nc &    W/m$^2$ &       latent heat flux \\
longrad.nc &    W/m$^2$ &       net long wave radiation \\
netheat.nc &    W/m$^2$ &       constrained net heat flux \\
sensib3.nc &    W/m$^2$ &       sensible heat flux \\
shortrad.nc &   W/m$^2$ &       net short wave radiation \\
taux3.nc &      N/m$^2$ &       zonal wind stress \\
tauy3.nc &      N/m$^2$ &       meridional stress \\*[1ex]
\multicolumn{3}{c}{Fresh Water Fluxes} \\
\hline
buoyancy.nc &   kg/(ms$^3$) &   constrained buoyancy flux \\
eminusp.nc &    mm/(3 hours) &  constrained evaporation minus
precipitation \\
evaprate.nc &   mm/(3 hours) &  evaporation rate \\
precip.nc &     mm/(3 hours) &  precipitation rate \\
uq.nc   &       m/s     &       surface zonal moisture flux\\
vq.nc   &       m/s     &       surface moisture flux\\*[1ex]
\multicolumn{3}{c}{Miscellaneous Derived Quantities} \\
\hline
airdens.nc &    kg/m$^3$ &      sea level air density \\
qs\_qa.nc &     g/kg    &       qsea minus qair \\
qsea.nc &       g/kg    &       sea level specific humidity \\
rh.nc &         \%      &       relative humidity \\
sst\_sat.nc &   C       &       sea minus air temperature \\
ua.nc   &       K\, m/s &       atmospheric zonal heat flux \\
va.nc   &       K\, m/s &       atmospheric meridional heat flux \\
vappress.nc &   hPa     &       vapor pressure \\
virtemp.nc &    C       &       virtual temperature \\
zdl.nc  &       ---     &       10m/(Monin Obukhov length) \\*[1ex]
\multicolumn{3}{c}{Other (about 1~Mb each)} \\
\hline
icemask.nc &    (none)  &       ice masks (Alexander and Mobley 1976)\\
salinity.nc &   p.s.u.  &       monthly salinity (Levitus \etall \ 1994)\\
\hline
\end{tabular}
\end{center}
\end{table*}

\begin{table*}[p]
\caption[List of raw (unanalyzed) quantities.]{List of raw
(unanalyzed) quantities in UWM/COADS, along with NetCDF file names and
units. For each quantity, there are 46 files consisting of 45 annual files
from 1945 to 1989, and a climatological file with statistics computed,
including all the data from 1945 to 1989 for each month. 
Each annual/climatological file contains monthly means, standard
deviations and number of observations for each calendar month.
In the file names below, $yy$ stands for 2 digits denoting the year.
For example, {\tt sst\_77.nc} is the file with sea surface temperature
data for 1977. File sizes are variable and tend to increase with time.}
\label{tab:raw}
\begin{center}
\begin{tabular}{lll}
\hline
\multicolumn{3}{c}{Directly Observed Quantities} \\
\hline
File Name &     Units &         Description \\ 
\hline
cld\_$yy$.nc &  \%/100. &       fractional cloudiness \\
q\_$yy$.nc &    g/kg    &       specific humidity \\
sat\_$yy$.nc &  C       &       air temperature at measurement height\\
slp\_$yy$.nc &  hPa     &       sea level pressure \\
sst\_$yy$.nc &  C       &       sea surface temperature \\
u3\_$yy$.nc &   m/s     &       zonal wind \\
v3\_$yy$.nc &   m/s     &       meridional wind \\
w3\_$yy$.nc &   m/s     &       scalar wind \\*[1ex]
\multicolumn{3}{c}{Heat and Momentum Fluxes} \\
\hline
achi\_$yy$.nc & W/m$^2$ &       long wave Chi sensitivity coefficient \\
ae\_$yy$.nc &   W/m$^2$ &       long wave vapor pressure sensitivity coefficient \\
fv3\_$yy$.nc &  m$^3$/$s^3$ &   oceanic friction velocity cubed \\
latn\_$yy$.nc & W/m$^2$ &       latent heat flux \\
long\_$yy$.nc & W/m$^2$ &       net long wave radiation \\
sens\_$yy$.nc & W/m$^2$ &       sensible heat flux \\
taux\_$yy$.nc & N/m$^2$ &       zonal wind stress \\
tauy\_$yy$.nc & N/m$^2$ &       meridional wind stress \\*[1ex]
\multicolumn{3}{c}{Fresh Water Fluxes} \\
\hline
evap\_$yy$.nc & mm/(3 hours) &  evaporation rate \\
prcp\_$yy$.nc & mm/(3 hours) &  precipitation rate \\
uq\_$yy$.nc &   m/s     &       surface zonal moisture flux \\
vq\_$yy$.nc &   m/s     &       surface meridional moisture flux \\*[1ex]
\multicolumn{3}{c}{Miscellaneous Derived Quantities} \\
\hline
rho\_$yy$.nc &  kg/m$^3$ &      sea level air density \\
dq\_$yy$.nc &   g/kg    &       sea minus air specific humidity \\
qs\_$yy$.nc &   g/kg    &       sea level specific humidity \\
rh\_$yy$.nc &   \%      &       relative humidity \\
dt\_$yy$.nc &   C       &       sst minus sat \\
ua\_$yy$.nc &   K\, m/s &       atmospheric zonal heat flux \\
va\_$yy$.nc &   K\, m/s &       atmospheric meridional heat flux \\
e\_$yy$.nc &    hPa     &       vapor pressure \\
tv\_$yy$.nc &   C       &       virtual temperature \\
zdl\_$yy$.nc &  ---     &       10~m/Monin Obukhov length \\
\hline
\end{tabular}
\end{center}
\end{table*}


\begin{table*}[p]
\caption[List of climatological statistics.]{List of climatological
statistics available in UWM/COADS.  Each file contains 12 monthly
grids of climatology, standard deviation ($\sigma$), or interannual standard
deviation ($\sigma_i$).  Standard deviation is not available for quantities
derived from analyzed fields (short wave radiation, net heat flux,
buoyancy flux, and E minus P).  Standard deviation and interannual
standard deviation are not available for the sensitivity parameters
(ac, achi, and ae). }
\label{tab:clm}
\begin{center}
\begin{tabular}{lllll}
\hline
\multicolumn{5}{c}{Directly Observed Quantities} \\
\hline
\multicolumn{3}{c}{File Name} & & \\
Climatology & \multicolumn{1}{c}{$\sigma$} & \multicolumn{1}{c}{$\sigma_i$}
& Units & Description \\
\hline
c\_clm.nc & c\_std.nc & c\_san.nc & \%/100. & fractional cloudiness \\
q\_clm.nc & q\_std.nc & q\_san.nc & g/kg & specific humidity \\
sat\_clm.nc & sat\_std.nc & sat\_san.nc & C & air temperature at
                                              measurement height \\
slp\_clm.nc & slp\_std.nc & slp\_san.nc & hPa & sea level air pressure \\
sst\_clm.nc & sst\_std.nc & sst\_san.nc & C  & sea surface temperature \\
u3\_clm.nc & u3\_std.nc & u3\_san.nc & m/s      & zonal wind \\
v3\_clm.nc & v3\_std.nc & v3\_san.nc & m/s      & meridional wind \\
w3\_clm.nc & w3\_std.nc & w3\_san.nc & m/s      & wind speed \\*[1ex]
\multicolumn{5}{c}{Heat and Momentum Fluxes} \\
\hline
ac\_clm.nc & & & W/m$^2$ & short wave cloudiness sensitivity parameter \\
achi\_clm.nc & & & W/m$^2$ & long wave Chi sensitivity parameter \\
ae\_clm.nc & & & hPa & long wave vapor pressure sensitivity parameter \\
fv3\_clm.nc & fv3\_std.nc & fv3\_san.nc & m$^3$/s$^3$ & oceanic friction velocity cubed \\
latn\_clm.nc & latn\_std.nc & latn\_san.nc & W/m$^2$ & latent heat flux \\
long\_clm.nc & long\_std.nc & long\_san.nc & W/m$^2$ & net long wave radiation \\
neth\_clm.nc & & neth\_san.nc & W/m$^2$ & constrained net heat flux \\
sens\_clm.nc & sens\_std.nc & sens\_san.nc & W/m$^2$ & sensible heat flux \\
shrt\_clm.nc & & shrt\_san.nc & W/m$^2$ & net short wave radiation \\
taux\_clm.nc & taux\_std.nc & taux\_san.nc & N/m$^2$ & zonal wind stress \\
tauy\_clm.nc & tauy\_std.nc & tauy\_san.nc & N/m$^2$ & meridional stress \\*[1ex]
\multicolumn{5}{c}{Fresh Water Fluxes} \\
\hline
buoy\_clm.nc & & buoy\_san.nc & kg/(ms$^3$) & constrained buoyancy flux \\
emp\_clm.nc & & emp\_san.nc & mm/(3 hours) & constrained evaporation
minus precipitation \\
evap\_clm.nc & evap\_std.nc & evap\_san.nc & mm/(3 hours) & evaporation rate \\
prcp\_clm.nc & prcp\_std.nc & prcp\_san.nc & mm/(3 hours) & precipitation rate \\
uq\_clm.nc & uq\_std.nc & uq\_san.nc & m/s & surface zonal moisture flux \\
vq\_clm.nc & vq\_std.nc & vq\_san.nc & m/s & surface meridional moisture flux \\*[1ex]
\multicolumn{5}{c}{Miscellaneous Derived Quantities} \\
\hline
rho\_clm.nc & rho\_std.nc & rho\_san.nc & kg/m$^3$ & sea level air density \\
dq\_clm.nc & dq\_std.nc & dq\_san.nc & g/kg & qsea minus qair \\
qsea\_clm.nc & qsea\_std.nc & qsea\_san.nc & g/kg & sea level specific humidity \\
rh\_clm.nc & rh\_std.nc & rh\_san.nc & \% & relative humidity \\
dt\_clm.nc & dt\_std.nc & dt\_san.nc & C & sea minus air temperature \\
ua\_clm.nc & ua\_std.nc & ua\_san.nc & K\, m/s & atmospheric zonal heat flux \\
va\_clm.nc & va\_std.nc & va\_san.nc & K\, m/s & atmospheric meridional
                                           heat flux \\
vapp\_clm.nc & vapp\_std.nc & vapp\_san.nc & hPa & vapor pressure \\
virt\_clm.nc & virt\_std.nc & virt\_san.nc & C & virtual temperature \\
zdl\_clm.nc & zdl\_std.nc & zdl\_san.nc & --- & 10m/(Monin Obukhov length) \\
\hline
\end{tabular}
\end{center}

\end{table*}



The data set is organized in 5 main subsets:
\begin{description}

\item[Directly Observed Quantities.] This subset contains the most
basic surface marine parameters entering our calculations. Although
monthly mean nonlinear fluxes cannot be directly derived from the
monthly means of these parameters, many of the qualitative features in
the fluxes can be traced to the seasonal and interannual
characteristics of these basic fields. See
Table~\ref{tab:vars} for a list of these quantities.

\item[Heat and Momentum Fluxes.] This subset includes estimates of
wind stress, sensible and latent heat fluxes, as well as radiational
fluxes at the ocean surface. The wind speed entering these
calculations has been corrected according to our revised Beaufort
equivalent scale (section \ref{sec:new_beaufort}).  This correction
eliminates much
of the bias and artificial trends associated with the erroneous WMO
Code 1100 scale used in COADS Release 1. Transfer coefficients are
based on Large and Pond (1981, 1982). The estimates of heat and
radiational fluxes, when combined to form the net heat flux at the
ocean surface, do not yield a physically plausible implied oceanic heat
transport. This problem is circumvented by a simple linear inverse
calculation which provides a systematic way to fine tune parameters in
the bulk formulas (section~\ref{sec:tuning}). Gridded sensitivity
parameters are included in this subset to allow users to experiment
with different ways of constraining the surface fluxes.

\item[Fresh Water Fluxes.] This subset includes estimates of
evaporation, precipitation, and the corresponding buoyancy fluxes
based on Levitus \etall\ (1994) climatological sea surface salinity. 

\item[Miscellaneous Derived Quantities.] This subset contains several
derived quantities of general interest, most of which are available in
the original COADS Monthly Mean Summaries. Refer to
Table~\ref{tab:vars} for a list of these
parameters.

\item[Number of Observations.] The \nolinebreak distribution
of \linebreak surface marine data
is highly variable in space and time. The surface marine observing
system is clearly not adequate to truly resolve global anomalies,
especially in the decade following World War II. Even today, large
portions of the tropics and the southern oceans are extremely
under-sampled. However, there is no simple way to determine the
validity of
our analysis over the oceans. Some regions of the tropics that were
void of data in the early years have experienced an increase in
coverage throughout the years. In order to assist users determining
the reliability of our analyses we have included files with the number
of observations for some of the basic quantities. Some issues related
to sampling and fair weather bias are addressed in
section~\ref{sec:fwb}. 

\end{description}

The data is stored using Unidata's Network Common Data Format (NetCDF)
described in Rew \etall\ (1993). NetCDF is self-describing and
system-independent software for storing scientific data and is
currently available for most Unix workstations, supercomputers and
personal computers.  A description of the UWM/COADS data formats,
FORTRAN subroutines needed to read the data, and a description of
NetCDF commands can be found in Appendices \ref{sec:fortran}--\ref{sec:netcdf}.
FORTRAN access software and examples of how to read the data are also
included in the data distribution.

The objectively analyzed anomaly and
climatology files are listed in Table~\ref{tab:vars}. The companion
raw (non-analyzed) monthly mean files appear in Table~\ref{tab:raw}.
Table~\ref{tab:clm} lists files with analyzed climatological
statistics such as means, standard deviations and number of
observations (see section~\ref{sec:analysis} for definitions of these
statistics).  


%.....................................................................


\section{Data source and COADS quality control}
\label{sec:data}


The primary data source for this study is Release 1 of
COADS which covers the
period 1854--1979. For the 1980's we rely on an interim data
product that preceded COADS Release 1A (recently made available).
Release 1A adds more observations to the interim data base
and extends it to 1993. This improved data base, which was not
available in time for our calculations, will be used in future versions
of our analyses.

As described below, our detailed calculations require the
consideration of individual ship reports.  Product 10 of COADS,
the {\em Compressed Marine Reports} (CMR-5), contains individual
reports of surface marine and atmospheric observations from merchant
vessels, research vessels, buoys, and bathythermographs (Woodruff
\etall \ 1987). The reports in CMR-5 include the following directly reported
quantities:
%
\begin{itemize}
        \item zonal and meridional wind components
        \item air temperature
        \item sea surface temperature
        \item sea level pressure
        \item dew point depression 
        \item cloudiness
        \item present weather
\end{itemize}
% 
along with quality control indicators which are briefly described
next.  The interested reader should consult the original COADS
documentation (Slutz \etall \ 1985) for a detailed description of the
quality control procedure. Note that wind, dew point depression and
sea level pressure are not directly observed but rather calculated by
ship personnel.  When measured, the reported wind speed and
direction are computed from the anemometer reading taking in
consideration the ship velocity, a procedure that often introduces
errors. Dew point depression is computed from the measured dry and wet
bulb temperatures. Sea level pressure is computed from the measured
pressure with a height correction to reduce it to sea level.  WMO
Publication No. 47 (e.g., WMO 1990), available yearly since 
1955 (in digital form since
1973), lists all the Ships of the Voluntary Observing Fleet along with
the ship instrumentation and routes. Kent and Taylor (1991) describes
in some detail observing practice by VOS and the instruments they used
during the VSOP-NA project (May/88 to September/90).

Quality control in COADS is implemented by means of a multiple step
statistical procedure to identify ``outliers.'' The first step is to
generate {\em Decadal Summary Untrimmed Limits} for six variables: sea
surface temperature, air temperature, air pressure, zonal wind,
meridional wind, and humidity.  Sextiles are calculated for each
variable in every 2\deg \ box for each decade and month.  Next, the
first, third (the median), and fifth sextiles are averaged across
latitude, longitude, month, and decade.  Averaging is done for three
non-overlapping periods (1854--1909, 1910--1949, 1950--79) in an attempt
to separate possible climatic epochs or observational discontinuities.
Further smoothing is done for the resulting 216 sets of sextile
triplets (6 variables \x \ 3 periods \x \ 12 months).  The result is
three sets of smoothed lower and upper limits ($\sigma_1, \sigma_5$)
around the smoothed mean ($\overline{x}$) for each variable, month, and 2\deg \
box.  These means and limits are used to create trimming bounds for
the variables.  A detailed description of the statistical process can
be found in Slutz \etall \ (1985), section~C\@.  Trimming flags for sea
surface temperature, air temperature, humidity, wind and sea level
pressure are included in CMR-5 for each observation.  Note that
trimming does not take into account different methods of observation
within the same period, nor were bias corrections applied when the limits
were generated.

We have used the COADS/CMR-5 flags to perform quality control on the
data used as input to our 1-degree statistics and analysis.
Table~\ref{tab:qc} summarizes the possible values of the quality control
flags in COADS/CMR-5.  In general, an observation is rejected if it
differs from the smoothed median by more than 3.5 ``standard
deviations'' (flag value equal to 2) or the smoothed limits are not
available (flag value equal to -999).  However, over the regions
climatologically covered by sea ice, this trimming procedure still
yields very noisy fields.  This is due to the irregular coverage of
observations in ice-covered regions in both area and time.  In an
effort to generate
smoother fields in regions where sea ice is common, a more stringent
trimming criterion is used.  If an
observation occurs in a climatologically ice-covered
region, the observation is trimmed if it differs from the smoothed
median by more than 2.8 ``standard
deviations'' (flag value equal to 1 or 2).


\def\xbar{\overline{x}}

\begin{table}[htp]
\caption[Quality control flags in COADS/CMR-5.]{Quality control flags
in COADS/CMR-5, where $x$ is is an
individual observation of the variable under scrutiny, $\xbar$ is the
smoothed median and $\sigma_1$ and $\sigma_5$ are the smoothed lower
and upper median deviation. See text for details.}
\label{tab:qc}
\begin{center}
\begin{tabular}{ccc}\hline
Flag  &  Trimming & Trim?\\
Value &  Limits  \\ \hline \hline
0     & $\xbar -2.8 \sigma_1 \le x \le \xbar+2.8 \sigma_5$ &no\\
%%%1     & $\xbar -3.5 \sigma_1 \le x \le \xbar+3.5 \sigma_5$&if ice\\
1     & $\xbar-3.5 \sigma_1 \le x < \xbar -2.8 \sigma_1$ & if obs. \\
      & or $\xbar+2.8 \sigma_5 < x \le \xbar+3.5 \sigma_5$ & over ice\\
2     & $x < \xbar -3.5 \sigma_1$ or $x > \xbar+3.5 \sigma_5$&yes\\ 
-999  & missing & yes\\ \hline
\end{tabular}
\end{center}
\end{table}


%..........................................................................

\section{Known biases in COADS}
\label{sec:biases}

The purpose of this section is to discuss some of the known biases and
other problems in COADS surface marine reports.  In subsequent
sections, we describe our bias correction schemes for wind speed,
cloudiness, and Present Weather.







\subsection{Sea surface temperature}

Biases in sea surface temperature are associated with different
methods of measurements (basically {\em bucket} and {\em intake}),
which also respond in different ways to atmospheric conditions.  On
average, measurement with an uninsulated canvas bucket introduces an
error of about 0.5\deg C due to evaporative cooling.  Folland and
Hsiung (1986) [see also Folland 1991] have developed a physical model
for a typical canvas bucket that predicts the amount of evaporative
cooling as a function of the atmospheric conditions and exposure time
of the bucket.  This model has been used effectively to correct the
bias in bucket observations (Farmer \etall \ 1989).  However,
Farmer \etall \ (1989) have used the bucket correction
method only for pre-World War II observations.  Observations after
that time were assumed to be almost exclusively measured by intake
or by insulated buckets.
This is consistent with the fact that the largest
discontinuity in SST due to changes in measurement procedure
(approximately one-half degree rise in SST around 1940) took place prior
to our analysis period (Bottomley \etall \ 1990, Kushnir 1994).

Recently, the {\em Voluntary Observing Ships Special Observing Program
for the North Atlantic} (VSOP-NA, Kent \etall \ 1993a) has found that
observations of SST from insulated buckets and hull contact sensors are
reliable. A constant bias of 0.35\deg C was found in observations from
ships' intake thermometers compared to those measured by bucket.

The unreliability of the bucket/intake
indicator in COADS and the lack of reliable information about the kind
of bucket used make this correction impractical from individual
observations.  Therefore, we do not include a sea surface temperature
correction in this version of our calculations.

\subsection{Air temperature}

Systematic errors in air temperature are believed to be caused
primarily by the heating of the ship superstructure, causing biases of
0.4\deg--0.8\deg C in some regions of the tropics (Isemer and Hasse
1987 and references within).  In view of this, some authors (Folland
\etall \ 1984) have preferred to discard daytime observations.
Although night time observations may be adequate to study long term
trends in air temperature, we feel that it significantly reduces the
number of observations and tends to bias the data toward a generally
lower night time temperature.

Kent \etall\ (1993b) devised a method of correction for daytime
surface air temperature based on wind speed and the incoming short
wave radiation. Preliminary calculations by these authors indicate
correcting daytime air temperature results in increases in mean
sensible and latent heat fluxes of 3.3 and 1.0 W/m$^2$, respectively,
in the North Atlantic Ocean (Kent and Taylor~1995).  We
intend to include such a correction in future versions of our data
set, but we do not do so at this time.

%%%Preliminary results by the authors for selected
%%%regions of the global oceans did not indicate any trend in day time
%%%surface air temperature that could not be identified in night time
%%%observations. 

\subsection{Dew point temperature}

Biases in dew point temperature are generally associated with
contamination of the wet bulb thermometer by salt or insufficient
moistening of the wet bulb thermometer wick.  These instrumentation
problems lead to a systematically higher value of the specific
humidity.  On average, the dew point temperature is biased about
0.5\deg C (Isemer and Hasse 1987 and references within).  Since this
bias is due mainly to human errors for which no record is available,
it is very difficult to devise a correction.

Kent \etall\ (1993a) have found that dew point temperature measured by
psychrometers were on average lower than those reported from 
ships using
screens. By considering the many factors that might have contributed to
this discrepancy, Kent \etall\ (1993a) concluded that psychrometer
observations were more reliable and a simple regression equation was
devised to correct screen-measured dew point temperatures. Because of
inadequate metadata in COADS/CMR-5 (there is no indicator of the 
method of measurement for dew point temperature) this correction
could not be implemented at the present time.



\subsection{Wind speed}
\label{sec:wind_bias}

Because wind is a key parameter for the determination of the air-sea
fluxes at the ocean surface, a great deal of effort has been devoted
to sort out the problems with ship winds.  Wind speeds reported by
ships are either directly measured with anemometers or are
estimated from the {\em sea state}.  Instrumentation problems with
anemometers are believed (or better, assumed) to be non-systematic and
are expected to cancel out when spatial/temporal averages are taken.
Estimated winds are somewhat subjective and depend on the skill of the
observer.  But even when a correct identification of the sea state is
made, it still needs to be converted to wind speed through a Beaufort
equivalent scale.

Since 1946, a Beaufort equivalent scale developed by Simpson (1906),
combined with a well defined sea state devised by Petersen (1927), has been
used by meteorological weather services (Roll 1965; Isemer and Hasse
1991).  This scale is known as Code 1100 and is sometimes referred to
as the {\em old\/} WMO scale.  It is now widely accepted that the old
WMO Beaufort equivalent scale results in systematic biases when
compared to anemometer measured winds.
There are a few alternative Beaufort equivalent scales (WMO 1970;
Cardone 1969; Kaufeld 1981), and they all suggest
that the old WMO scale underestimates the winds for Beaufort numbers
less than about 6 and overestimates winds for Beaufort numbers greater
than about 6.  As pointed out by Isemer and Hasse (1991), this
systematic error causes climatological wind speeds to be
underestimated, and climatological wind speed standard deviation to be
overestimated in the North Atlantic Ocean. Concerning long term
variability, Cardone \etall \ (1990) have shown that a Beaufort scale
correction, ship anemometer height adjustment, and stability
correction strongly reduce artificial trends in wind speed, and
drastically improve the agreement between measured and estimated
winds.

Finally, most definitions of transfer coefficients are
calibrated to work with winds from a reference level of 10~m above the
ocean surface.  Cardone \etall \  (1990) suggest that the average ship
anemometer height is actually 20~m. Kent~\etall \ (1993a) shows that
during VSOP-NA a typical anemometer height is in the range
15--20~m, but on modern container ships the anemometer heights are
about 30~m. 
A common approximation is to take
the 20~m wind in place of the required 10~m.  Since virtually all ship
anemometers are higher than 10~m, this approximation introduces a
systematic error.  Isemer and Hasse (1991) estimated that the 10~m wind
speed is on average 93\% of the wind speed at 20~m.  Calculations by
the authors show that for light winds under stable conditions, the
surface layer has strong shear and the wind at 10~m can be as low as
40\% of the wind speed at 20~m.  This result suggests that a careful
stability dependent correction is warranted.

The ship type indicator, however, is often incorrect or missing
in COADS/CMR-5.  This is particularly significant in the
1980's when large numbers of drifting buoys were placed in the
southern oceans.  We have found that nearly all buoy observations in
the COADS/CMR-5 1980's interim product are not identified correctly.
The result is that a wind observation measured at 5~m is treated as if
it were taken at 20~m.  Winds in regions sampled mainly by drifting
buoys will be biased toward lower values. This problem has 
apparently been fixed in
COADS Release 1A and the correct identification of buoys will be
included in future analyses.

%.....................Cloudiness...................................

\subsection{Cloudiness}

Cloudiness observations on board ships are estimated visually.
In very low light conditions, observers often miss high level clouds.
This tends to bias night time cloudiness toward a smaller fraction of
cloud cover (Sverdrup 1933; Riehl 1947; Schneider \etall \ 1989).  It is 
possible to reduce this bias by rejecting cloudiness observations
taken during dark sky conditions.  These conditions can be determined
by the altitude of the sun and the phase and altitude of the moon.

Another bias in cloudiness results from {\em sky obscured}
observations.  A sky obscured observation means that clouds are not
visible due to smoke, blowing dust, fog, snow, or some other
phenomenon.  This condition represents over 6\% of the observations in
the period 1952--81 (Hahn \etall\ 1992).  Sky obscured observations are coded
separately and cannot be assigned one cloudiness value, as not all sky
obscuring phenomena are associated with clouds.  But if none of these
observations are included, heavy fog-- or snow--associated cloudiness
would be eliminated and the cloudiness would be biased toward a lower
value.  To eliminate this bias, the {\em present weather} code can be
checked for each sky obscured observation (see section~\ref{sec:cloudcorr}).


%.............................. Present Weather ..........................


\subsection{Present Weather}
A code number signifying the present weather conditions is recorded as a
standard part of a ship's observation.  This code can be used as a proxy for 
precipitation, as precipitation is rarely measured on ships.
Beginning in the early 1980's, the WMO no longer required Present Weather (PW)
to be recorded for clear weather observations (S. Woodruff, personal
communication).  Previously, in clear
weather episodes, the observer entered a code number indicating there
was no weather observed.  When the observations in the 1980's were
entered into the COADS interim product, the missing clear weather observations
were given the missing flag, just as truly missing PW observations were.
Using such observations as they are recorded in COADS would eliminate
most if not all clear weather (rainless and snowless) reports.  If few
clear weather reports are available, the result would be a wet 
bias in the 1980's precipitation.  This effect would be particularly evident
in climatologically clear areas, such as below the subtropical highs.
In the course of this investigation, it was discovered that there is
indeed a sharp increase in the number of missing PW observations
beginning in 1982.

%The method of correction links PW with cloudiness.  It is reasonable
%to assume that any observer making a cloud cover observation will also
%make a PW observation, and vice versa.  Therefore, when encountering a
%missing observation from 1982 and later observations, cloudiness is
%checked.  If cloudiness is missing, it can be assumed that the PW is
%truly missing.  If a cloudiness observation is present, however, it
%can be assumed that there was a PW observation and that the weather
%was clear.  This method seems likely to introduce very little error.


%.............................. 1 ..........................


\section{A revised Beaufort \, equiv\-a\-lent
scale de\-rived from COADS}
\label{sec:new_beaufort}

The estimated wind speeds included in COADS are based on the old WMO
Code 1100 Beaufort equivalent scale.  As already discussed in
section~\ref{sec:wind_bias}, there are serious biases associated with
this scale and several alternative scientific Beaufort equivalent
scales exist (WMO 1970, Cardone 1969, Kaufeld 1981, Ramage 1987).  The
purpose of this section is to document the performance of these
Beaufort equivalent scales using individual ship reports in COADS.
Having diagnosed climatological biases in these scales, we introduce
in section~\ref{sec:newscale} a very simple formula
(eq.~\ref{eq:jan}) to correct estimated wind speeds reported in COADS.
The performance of this correction for individual oceans, seasons, and
decades is briefly discussed in section~\ref{sec:anew}.  The impact of
our estimated wind speed correction on the long term climatology and
wind speed trends is discussed in section~\ref{sec:climatology}.


%.....................................................................
\subsection{Method of analysis}

Flag ``WI'' included in each COADS/CMR-5 wind observation is used to
discriminate measured from estimated wind speeds.  This flag takes
only two values: 1 for measured winds and 0 for winds estimated or
unknown.  It is conceivable that some of the observations flagged as
estimated/unknown could in fact be measured (see Cardone \etall \
[1990] for a discussion of problems with the measured/estimated
indicator in a similar data set).  In order to homogenize estimated
winds we found it necessary to bracket all COADS estimated wind speeds
according to the old WMO scale (Table~\ref{tab:codes}) and replace
them with the appropriate equivalent wind speeds. To have a
good balance between measured and estimated wind speed observations
 we restricted the analysis to the last two decades (1970-89).

\begin{table*}[p]
\caption[UWM Beaufort scale equivalents]{WMO Code 1100 and UWM Beaufort equivalent scales.}
\label{tab:codes}
\begin{center}
\begin{tabular}{c|ccc|ccc}
\hline
\multicolumn{1}{c}{ } &
 \multicolumn{3}{c}{WMO Code 1100} & \multicolumn{3}{c}{UWM} \\
\multicolumn{1}{c}{Beaufort} &
 \multicolumn{2}{c}{Interval of equivalent} &
 \multicolumn{1}{c}{Mean equivalent } &
 \multicolumn{2}{c}{Interval of equivalent} &
 \multicolumn{1}{c}{Mean equivalent } \\
\multicolumn{1}{c}{Number} &
 \multicolumn{2}{c}{wind speed} &
 \multicolumn{1}{c}{wind speed } &
 \multicolumn{2}{c}{wind speed} &
 \multicolumn{1}{c}{wind speed } \\
\multicolumn{1}{c}{ } &
 \multicolumn{1}{c}{knots} & \multicolumn{1}{c}{m/s} &
\multicolumn{1}{c}{m/s} &
 \multicolumn{1}{c}{knots} & \multicolumn{1}{c}{m/s} &
\multicolumn{1}{c}{m/s} \\
\hline
0 & $<$ 1    & 0.0 -- 0.2   & 0.0  & 0 -- 2 & 0.0 --1.0 & 0.0 \\
1 & 1 -- 3   & 0.3 -- 1.8   & 0.8  & 3 -- 5 & 1.1 --3.0 & 1.5 \\
2 & 4 -- 6   & 1.9 -- 3.3   & 2.4  & 6 -- 8 & 3.1 --4.5 & 3.4 \\
3 & 7 -- 10  & 3.4 -- 5.4   & 4.3  & 9 -- 13 & 4.6-- 6.7 & 5.4 \\
4 & 11 -- 16 & 5.5 -- 8.5   & 6.7  & 14 -- 18 & 6.8-- 9.7 & 7.7 \\
5 & 17 -- 21 & 8.6 -- 11.0  & 9.4  & 19 -- 23 & 9.8-- 12.0 & 10.4 \\
6 & 22 -- 27 & 11.1 -- 14.1 & 12.3 & 24 -- 28 & 12.1-- 14.9 & 13.0 \\
7 & 28 -- 33 & 14.2 -- 17.2 & 15.5 & 29 -- 34 & 15.0-- 17.7 & 16.0 \\
8 & 34 -- 40 & 17.3 -- 20.8 & 18.9 & 35 -- 40 & 17.8-- 20.9 & 19.0 \\
9 & 41 -- 47 & 20.9 -- 24.4 & 22.6 & 41 -- 46 & 21.0-- 24.1 & 22.4 \\
10 & 44 -- 55 & 24.5 -- 28.6 & 26.4 & 47 -- 54 & 24.2-- 27.8 & 25.7 \\
11 & 56 -- 63 & 28.7 -- 32.7 & 30.5 & 55 -- 60 & 27.9-- 31.4 & 29.3 \\
12 & $\geq$ 64 & $\geq$ 32.8 & 34.9 & $\geq$ 61 & $\geq$ 31.5 & 33.1 \\
\hline
\end{tabular}
\end{center}
\end{table*}

In order to eliminate spatial and temporal noise due to inhomogeneous
sampling over the oceans, we have objectively analyzed our fields to
fill in gaps in data sparse regions and remove small scale noise.
Objective analysis is also effective in outlier removal, which is
beneficial to the regression analysis of section~\ref{sec:newscale}.
Details of the objective analysis can be found in 
section~\ref{sec:analysis} and Levitus (1982).

%.....................................................................
\subsection{Assessing current Beaufort equivalent scales}
\label{sec:assess}

It is well established that the old WMO (Code 1100) Beaufort
equivalent scale has systematic biases and that several alternative scales
have been proposed.  Although all these new scales confirm that the
old WMO scale underestimates low wind speeds and overestimates high
wind speeds (Fig.~\ref{fig:bars}), they all differ in the precise
amount.  This
section further documents the performance of these scales by comparing
anemometer-measured winds with estimated winds based on each scale, in
a climatological sense. The scales considered are WMO Code 1100, WMO
CMM-IV (WMO 1970), Cardone (1969) and Kaufeld (1981).

\begin{figure}[htp]
\centerline{
\epsfxsize=3.0in
\epsfbox[20 25 550 555]{ps/bars.ps} }
\caption[Five Beaufort equivalent scales]{The old WMO Beaufort scale 
(Code 1100) and four alternative
scientific Beaufort scales: CMM-IV (WMO 1970), Cardone (1969), Kaufeld
(1981), and the UWM Beaufort climatological scale.}
\label{fig:bars}
\end{figure}

Figure~\ref{fig:ws4} plots estimated against measured Northern
Hemisphere annual 
mean winds for the period 1970--1989 for each of the scales
described above.  Wind speeds estimated with Kaufeld's scale have been
converted from 25~m (average
anemometer height in Kaufeld's [1981] study) to 20~m, under the
assumption of neutral stability.
These scatter diagrams present several
measures of {\em error} and {\em goodness of fit}, viz.
\begin{eqnarray}
\sigma &=& \[ {1\over N} \sum_i \( {\oW_e}_i - {\oW_m}_i \)
^2\]^{1/2}\label{eq:std}\\
\text{bias} &=& {1\over N} \sum_i \({\oW_e}_i - {\oW_m}_i\)\\
\text{scatter} &=& \[ {1\over N} \sum_i \( {\oW_e}_i - {\oW_m}_i 
- b \) ^2\]^{1/2} \label{eq:scatter}
\end{eqnarray}
where $\sigma$ is the standard deviation, ${\oW_e}_i/{\oW_m}_i$ stands
for climatological estimated/measured wind speed at
gridpoint $i$, $N$ is the total number of gridpoints, and $b$ is the bias.
Figure~\ref{fig:ws4} also shows the slope and intercept of the least
square fit relating $W_e$ to $W_m$ in this figure.

\begin{figure*}[tp]
\centerline{
\epsfxsize=6.5in
\epsfbox[25 25 550 555]{ps/ws4.ps} }
\caption[Performance of four Beaufort equivalent scales in the northern
hemisphere]{Analyzed estimated versus measured winds (annual mean,
northern hemisphere, 1970--89) with estimated winds based on several Beaufort
equivalent scales: a) old WMO (Code 1100), b) CMM-IV (WMO 1970), c)
Kaufeld (1981), d) Cardone (1969).  Each point in the diagram
corresponds to measured/estimated winds on a grid point over the
northern hemisphere oceans (\one).  See text for scatter, standard
deviation ($\sigma$) and bias definitions.}
\label{fig:ws4}
\end{figure*}

Although the old WMO scale yields a slope very close to 1, it is clear
from Fig.~\ref{fig:ws4}a that it underestimates wind speed with a standard
deviation of almost 1 m/s.  
The CMM-IV Beaufort equivalent scale (Fig.~\ref{fig:ws4}b) does a
better job for 
wind speeds in the range 5--9 m/s but tends to underestimate
wind speeds greater than 9 m/s and overestimate
wind speeds less than 5 m/s.
Kaufeld's scale (Fig.~\ref{fig:ws4}c) systematically
overestimates wind 
speeds with a standard deviation of about 0.6 m/s and bias of 0.5 m/s.
Like Kaufeld, Cardone's scale (Fig.~\ref{fig:ws4}d) tends to overestimate wind
speeds less than 9 m/s, but does a much better job at higher values of
the wind speed; both bias and standard deviations are two-thirds to
three-quarters of Kaufeld's.  

%...................................................................
\subsection{Correcting estimated winds in COADS}
\label{sec:newscale}

The main objective of this section 
is to devise a correction to the Code 1100 Beaufort
equivalent scale that would bring not only average measured/estimated
wind speed in closer agreement, but also produce consistent 
mean estimates of nonlinear quantities
such as the average pseudo wind stress
($ \overline{P} = \overline{W^2} = \overline{W}^2 + \overline{{W'}^2}
$). It would seem that a simple linear regression formula
\begin{equation}
W_{new} = x_1 W_{old} + x_2 
%%%\label{eq:linearcorr}
\end{equation}
would bring measured/estimated wind speeds in Fig.~\ref{fig:ws4}a in close
agreement, as discussed in the previous section.
In the above formula
$W_{new}$ and
$W_{old}$ stand for the corrected and old WMO 
Code 1100 wind speed, respectively, and $x_1$, $x_2$ 
constants to be determined.
However,
consistency between measured/estimated average pseudo wind stress
$\overline{P}$ requires not only the mean speeds to be consistent
($\oW_e = \oW_m$), but also a consistency of standard deviations 
($\overline{{W_e'}^2} = \overline{{W_m'}^2}$).  Such consistency
of standard deviations cannot be accomplished with a simple linear
regression. As mentioned earlier, a correction 
to the old WMO
scale should increase low wind speeds and decrease high wind speeds. 
After much experimentation it was determined that such correction can
be accomplished by a function of the form
\begin{equation}
W_{new} = x_1 W_{old} + x_2 \sqrt{W_{old}} \, .
\label{eq:corr}
\end{equation}
All of the three alternative Beaufort equivalent scales of the last section 
can accurately be
expressed in the form of eq. (\ref{eq:corr}). The constants $x_1$,
$x_2$ are determined by means of a least squares fit.

Figure~\ref{fig:ws9} shows the results of these computations based on northern
hemisphere data, base years 1970--89.  Each ``row'' in this diagram
corresponds to a different set of constants $x_1$/$x_2$, and each
``column'' corresponds to test data for a particular period (annual,
January or July).  For example, the diagonal depicts estimated vs.
measured wind speeds with the corrected Beaufort equivalent scale
developed for that particular month.

\begin{figure*}[tp]
\centerline{
\epsfxsize=6.5in
\epsfbox[20 100 510 585]{ps/ws9.ps} }
\caption[Performance of three COADS-based Beaufort equivalent scales
on annual, January, and July data]{Analyzed estimated versus measured
winds (northern
hemisphere, 1970--89) with estimated winds based on several versions of our new
Beaufort scale: a) the scale is developed based on annual mean data
and used for annual mean estimated winds; b) as in a) but the scale is
used on January mean data; c) as in a) but the scale is used on July
mean data; d) the scale is developed based on January mean data
and used for annual mean estimated winds; e) as in d) but the scale is
used on January mean data; f) as in d) but the scale is used on July
mean data; g) the scale is developed based on July mean data
and used for annual mean estimated winds; h) as in g) but the scale is
used on January mean data; and i) as in g) but the scale is used on July
mean data.  See text for scatter, standard deviation ($\sigma$) and
bias definitions.}
\label{fig:ws9}
\end{figure*}

It is clear from Figs.~\ref{fig:ws9}a,d,g that any of the new Beaufort equivalent 
scales
performs better on climatological annual winds than the CMM-IV scale
(Fig.~\ref{fig:ws4}b), the ``best'' among the current scales. The new January
scale (middle row) performs nearly as well on annual data as the
optimal annual scale,
with standard errors equal to 0.17 and 0.16 m/s, respectively (compare
Figs.~\ref{fig:ws9}d and \ref{fig:ws9}a).  A close examination of
Fig.~\ref{fig:ws9} reveals that on
January/July data the January scale is slightly more accurate than the annual
scale.  The July scale only outperforms the annual/January scales on
the July data, but marginally so.  The seasonal dependence of the
scales is modest and does not warrant the use of a different scale
for each month.  Based on this analysis, and additional plots for
other oceans, we selected the January scale as our primary scale.  
In this case eq. (\ref{eq:corr}) reads:
\begin{equation}
W_{new} = 0.7870 \, W_{old} + 0.9547 \sqrt{W_{old}} \, .
\label{eq:jan}
\end{equation}
Notice that when this equation is applied to climatological winds 
the second term on
the right hand side (RHS) should be the average of $W^{1/2}_{old}$,
($\overline{\sqrt{W}}$) rather than the square-root of the average
wind, ($\sqrt{\overline{W}}$).

The wind speed correction given in eq.~(\ref{eq:jan}) can be used to
derive a revised Beaufort equivalent scale for use in COADS\@.  In
Table~\ref{tab:codes} the mean equivalent wind speed and respective
interval of wind speeds for the WMO Code 1100 scale have been mapped
using eq.~(\ref{eq:jan}) to produce a new corrected scale.
Figure~\ref{fig:bars} depicts the difference between this corrected
scale and the other Beaufort equivalent scales.  Consistent with the
other scales, the UWM scale indicates that the old WMO Code 1100 scale
underestimates low wind speeds and overestimates high wind speeds.
However, the magnitude of the correction is generally smaller than
previous alternatives to the old WMO scale.

%...................................................................
\subsection{Sensitivity study}
\label{sec:anew}

\begin{table*}[htp]
\caption[UWM Beaufort climatological scale performance]{Performance of the
UWM Beaufort climatological scale (base
month: January) applied to data from several months.  Standard deviation ($\sigma$), bias, and
scatter are defined in section~\ref{sec:assess}, eqs. (\ref{eq:std})--(\ref{eq:scatter}). }
\label{tab:wmonths}
\begin{center}
\begin{tabular}{lrrrrr}
\hline
month & slope & intercept & $\sigma$ & bias & scatter \\
\hline
January & 0.99 & 0.07 & 0.35 & -0.00 & 0.35 \\
April & 1.03 & -0.21 & 0.34 & 0.01 & 0.34 \\
July & 0.95 & 0.34 & 0.36 & -0.01 & 0.36 \\
October & 1.02 & -0.20 & 0.40 & 0.04 & 0.40 \\
Annual & 1.03 & -0.24 & 0.18 & 0.01 & 0.18 \\
\hline
\end{tabular}
\end{center}
\end{table*}

Table~\ref{tab:wmonths} summarizes the relationship between
measured/estimated wind
speed in COADS for different months when our correction is applied.
As expected, the best performance is attained for January, the base
month used to derive the scale.  The slopes of the least squares fit
lines are consistent throughout the year within 5\% of 1.

Table~\ref{tab:OWS} summarizes the performance of the UWM scale for 5
degree boxes around Ocean Weather Stations (OWS) in the North Pacific and
North Atlantic oceans.  For each month from 1970 to 1989, separate
monthly mean wind speeds are computed for measured and estimated wind
reports.  These boxes are chosen to include OWS so that a great
number of anemometer measured reports are present (although not all
OWS were reporting the entire period).  Monthly means
with fewer than 30 observations for a particular month are eliminated.
Note that no objective analysis is performed.  As before, the WI
flag in COADS CMR-5 was taken at face value, although H.-J. Isemer
(personal communication) has brought to our attention apparent
inconsistencies in this flag in the neighborhood of some OWS.  A
sensitivity test eliminating dubious WI reports has been conducted 
for some OWS and
the main conclusions of this section are not affected by this tighter
quality control.  The most striking feature in Table~\ref{tab:OWS} is
the larger standard deviation (and scatter) compared to the
climatological results presented in the previous sections.  This
increase in standard deviation is partially due to the absence of
objective analysis, combined with the noisier character of monthly
mean, regional data.  In ten out of the 16 boxes near ocean weather
stations that were studied, the measured/estimated wind pairs have slopes 
within 10\% of 1.  Biases are generally small, although a few boxes
(OWS B, E, N, and T) have biases in excess of 0.25 m/s.  As an
illustration of the results for a box in which the UWM Beaufort scale
has moderate performance,
Fig.~\ref{fig:owsp} depicts measured vs. estimated wind
speeds for the box around OWS P.

\begin{figure}[htp]
\centerline{
\epsfxsize=3.0in
\epsfbox[20 25 370 370]{ps/owsp.ps} }
\caption[Performance of UWM Beaufort climatological scale near OWS
P]{Estimated vs.\ measured winds for a 5\deg \ box around
Ocean Weather Station Papa. Each dot corresponds to a monthly mean in
the period 1970-89 in which more than 30 observations of each type
were made inside the box. Estimated winds were corrected with the UWM
Beaufort climatological scale.}
\label{fig:owsp}
\end{figure}

\begin{table*}[p]
\caption[Interannual performance of the UWM scale.]{Interannual 
performance of the UWM scale near Ocean Weather
Stations. Data are unanalyzed monthly means for $5^\circ\times5^\circ$ boxes
around Ocean Weather Stations.  Estimated/measured pairs are
included only if more than 30 estimated and 30 measured wind
observations occur during that month.  The 
period covered is 1970--89 with the maximum number of pairs being
240.  Standard deviation ($\sigma$), bias, and
scatter are defined in section~\ref{sec:assess}, eqs. (\ref{eq:std})--(\ref{eq:scatter}).}
\label{tab:OWS}
\begin{center}
\begin{tabular}{cccrrrrr}
\hline
Nearby OWS & $5^\circ\times5^\circ$ box center & No. pairs
& slope & intercept & $\sigma$ & bias & scatter \\
\hline
A & 62.5\deg N 32.5\deg W  & 98  & 0.70 & 2.64 & 1.47 & 0.07 & 1.47 \\
B & 56.5\deg N 50.5\deg W  & 36  & 1.09 & -1.20 & 1.48 & 0.34 & 1.44 \\
C & 52.5\deg N 35.5\deg W  & 170 & 0.79 & 2.10 & 1.18 & 0.03 & 1.18 \\
D & 44.5\deg N 40.5\deg W  & 199 & 0.92 & 0.84 & 0.96 & -0.04 & 0.96 \\
E & 35.5\deg N 47.5\deg W  & 213 & 0.91 & 0.50 & 0.93 & 0.26 & 0.89 \\
I & 59.5\deg N 18.5\deg W  & 133 & 0.92 & 0.82 & 1.32 & -0.06 & 1.32 \\
J & 52.5\deg N 19.5\deg W  & 155 & 0.93 & 0.60 & 1.03 & 0.12 & 1.02 \\
K & 45.5\deg N 15.5\deg W  & 215 & 0.94 & 0.57 & 0.73 & -0.02 & 0.73 \\
L & 57.5\deg N 19.5\deg W  & 224 & 0.89 & 0.94 & 1.17 & 0.18 & 1.15 \\
M & 66.5\deg N 2.5\deg E   & 95  & 0.93 & 0.62 & 1.26 & 0.05 & 1.26 \\
N & 30.5\deg N 139.5\deg W & 235 & 0.98 & -0.14 & 0.83 & 0.29 & 0.78 \\
P & 50.5\deg N 144.5\deg W & 227 & 0.83 & 1.72 & 0.88 & -0.03 & 0.88 \\
R & 47.5\deg N 16.5\deg W  & 214 & 0.95 & 0.54 & 0.82 & -0.04 & 0.82 \\
T & 29.5\deg N 135.5\deg E & 223 & 0.79 & 1.29 & 1.03 & 0.39 & 0.95 \\
V & 34.5\deg N 164.5\deg E & 180 & 0.95 & 0.58 & 1.10 & -0.06 & 1.10 \\
X & 39.5\deg N 153.5\deg E & 206 & 0.82 & 1.80 & 0.96 & -0.10 & 0.95 \\
\hline
\end{tabular}
\end{center}
\end{table*}

Figure~\ref{fig:wemglo} shows the global distribution of annual mean
measured and estimated winds.  Most of the large scale patterns of
measured/estimated winds match quite well, surprisingly even in the
data sparse regions of the southern oceans.  

\begin{figure*}[tp]
\centerline{
\epsfxsize=6.5in
\epsfbox[70 270 550 565]{ps/wemgloa.ps} }
\centerline{
\epsfxsize=6.5in
\epsfbox[70 270 550 565]{ps/wemglob.ps} }
\caption[Measured versus estimated global wind speeds]{Analyzed annual
a) estimated and b) measured winds over the
global oceans (1970--89).  Our new Beaufort equivalent scale has been used to
produce the estimated winds in a).  Contour interval: 1~m/s.}
\label{fig:wemglo}
\end{figure*}

Figure~\ref{fig:ptau} shows the performance of the UWM Beaufort
climatological scale on pseudo stress.
Our correction produces a consistent estimate of pseudo wind stress
with a slope about 0.98 and small bias.  However, there is a tendency to
underestimate annual mean pseudo wind stress above 175~m$^2$/s$^2$.

\begin{figure}[tp]
\centerline{
\epsfxsize=3.0in
\epsfbox[20 25 442 442]{ps/ptaua.ps} }
\centerline{
\epsfxsize=3.0in
\epsfbox[20 25 442 442]{ps/ptaub.ps} }
\caption[Performance of UWM Beaufort climatological scale on
pseudo stress]{Analyzed estimated vs.\ measured pseudo stress climatology
for a) January and b) July in the northern hemisphere (1970-89).
Estimated winds used to calculate pseudo stress ($W^2$) were corrected
using the UWM Beaufort climatological scale.  Each dot corresponds to
measured/estimated pseudo stress on a grid point over the northern
hemisphere oceans (\one).  Points more than 3.5 standard deviations from
the mean were trimmed from these figures.  Of these trimmed
points (37 points in January, 67 points in July), the majority
represent coastal locations where smoothing is not effected. See text for
scatter, standard deviation ($\sigma$) and bias definitions.}
\label{fig:ptau}
\end{figure}

%.....................................................................
\subsection{Effect on long term climatology and trends}
\label{sec:climatology}

Figure~\ref{fig:wstd} shows mean wind speed and standard deviation
valid at 20~m for January, both corrected (Figs.~\ref{fig:wstd}a,c) and
the difference of corrected minus uncorrected (Figs.~\ref{fig:wstd}b,d).
In this calculation all quality controlled COADS data from 1945 to
1989 were used, correcting all estimated wind speeds according to 
eq.~(\ref{eq:jan}).  Consistent with previous studies, corrected mean
speeds exceed uncorrected mean speeds by about 0.5 m/s in parts of the
North Atlantic, with smaller differences in the North Pacific.  The
corrected standard deviation (Figs.~\ref{fig:wstd}c,d) is reduced in
the extra-tropics, with a more pronounced reduction ($\sim$~0.3 m/s)
in the North Atlantic ocean. The corrected standard deviation is
generally increased in the tropics with magnitudes around 0.1 m/s in
the eastern tropical Atlantic and Pacific oceans.  Similar
calculations for the month of July show that the correction to the
wind speed (not shown) is positive and greater than that for January,
primarily due to the lower wind speed in July.
 Consistent with the findings of Cardone \etall \
(1990), we note a reduction in the wind speed's temporal linear trend
for most of the globe due to our scientific Beaufort scale correction
(not shown).  This artificial upward trend in wind speed can adversely impact
studies of long term variability of the ocean-atmosphere climate
system.

% figure wstda,b,c,d is at the end of the summary section.  This was
% necessary to get the figure to come after the ptau figure.
%\begin{figure*}[tp]
%\centerline{
%\epsfysize2.0in
%\epsfbox[70 300 550 520]{ps/wstda.ps} }
%\centerline{
%\epsfysize2.0in
%\epsfbox[70 300 550 520]{ps/wstdb.ps} }
%\centerline{
%\epsfysize2.0in
%\epsfbox[70 300 550 520]{ps/wstdc.ps} }
%\centerline{
%\epsfysize2.0in
%\epsfbox[70 300 550 520]{ps/wstdd.ps} }
%\caption[Corrected wind speed and wind speed $\sigma$]{January mean
%wind speed and standard deviation (1945--89)
%over the ocean, including both measured and estimated winds: a)
%corrected wind speed (contour interval: 1~m/s), b) difference between
%corrected and reported wind speeds in COADS (contour interval:
%0.1~m/s), c) corrected standard deviation (contour interval: 0.5~m/s),
%and d) standard deviation difference (contour interval: 0.1~m/s).}
%\label{fig:wstd}
%\end{figure*}

%.....................................................................
\subsection{Summary}
\label{sec:conclusion}

Using individual observations from the COADS Compressed Marine Reports
(CMR-5) analyses of wind speed climatologies have been produced for the
global oceans during the period 1970--89.  Computing climatological
wind speeds based on (anemometer) measured and (sea state) estimated
ship reports, the performance of 4 current scientific
Beaufort scales have been analyzed: a) WMO Code 1100, b) CMM-IV (WMO
1970), c) Cardone 
(1969), and d) Kaufeld (1981).  This analysis confirmed previous
findings that the old WMO Code 1100 scale underestimates lower
wind speeds and overestimates high wind speeds.  Nevertheless, the other three
so-called scientific Beaufort equivalent scales have biases of their
own, with the CMM-IV being more accurate for intermediate winds (5--9
m/s).
Having established the need for a new scale, the
following formula is proposed to correct estimated wind speeds in COADS: 
$$ 
W_{new} = 0.7870 W_{old} + 0.9547 \sqrt{W_{old}} 
$$ 
where $W_{old}$ is wind speed given in COADS based on WMO Code 1100
scale, and $W_{new}$ is the corrected estimate at the mean anemometer
height, assumed here to 20~m above sea 
level.  Note that the above formula is valid only for individual
observations and cannot be applied directly to monthly mean wind
speeds.  This proposed correction performs reasonably well for all
seasons, and marginally so in the southern hemisphere, where the poor
sampling gives considerably more scatter compared to the northern
hemisphere.  For the month of January, there is also a poor
correspondence between measured/estimated wind speeds in the Indian
ocean.  Overall, the new scale produces higher average wind speeds throughout
the globe, and reduced standard deviations.  The magnitude of such
corrections is generally larger in July compared to January.  In
agreement with Cardone \etall \ (1990), the artificial long term
increase in wind speed is reduced for most of the globe.

It is important to note that the validity of this correction is
dependent on the reliability of flag WI in COADS/CMR-5. (Flag WI
allows us to discriminate measured/estimated wind observations).
Recently, S.  Woodruff (personal communication) has brought to the
authors' attention results of some preliminary tests in which some
wind reports flagged as {\em measured} were determined to be {\em
estimated}.  If such inconsistencies exist in COADS/CMR-5, they have
been incorporated in our scale, which effectively brings
measured/estimated wind speeds into agreement.  To settle this
uncertainty regarding the accuracy of the measured/estimated flag,
detailed information about the reporting ships is required.  Although
in principle it is possible to compile some of this metadata, it is a
formidable task and such information is not likely to be included in
COADS in the near future.  As more reliable data becomes available,
this analysis will be updated to reflect these changes.  In the
meantime, we claim that the corrections proposed in here produce a
more consistent estimate of COADS wind speed over the global oceans.

\begin{figure*}[tp]
\centerline{
\epsfysize2.0in
\epsfbox[70 300 550 520]{ps/wstda.ps} }
\centerline{
\epsfysize2.0in
\epsfbox[70 300 550 520]{ps/wstdb.ps} }
\centerline{
\epsfysize2.0in
\epsfbox[70 300 550 520]{ps/wstdc.ps} }
\centerline{
\epsfysize2.0in
\epsfbox[70 300 550 520]{ps/wstdd.ps} }
\caption[Corrected wind speed and wind speed $\sigma$]{January mean
wind speed and standard deviation (1945--89)
over the ocean, including both measured and estimated winds: a)
corrected wind speed (contour interval: 1~m/s), b) difference between
corrected and reported wind speeds in COADS (contour interval:
0.1~m/s), c) corrected standard deviation (contour interval: 0.5~m/s),
and d) standard deviation difference (contour interval: 0.1~m/s).}
\label{fig:wstd}
\end{figure*}


%.......................................................................

\section{Bias corrections}
\label{sec:correc}


This section documents our bias correction procedures for wind speed,
cloudiness and Present Weather. No additional correction is applied to
the other directly observed quantities.







%......................wind speed correction........................

\subsection{Wind speed}
As described in section~\ref{sec:newscale}, to reduce the bias in wind speed
due to the WMO Code 1100, a wind speed correction of the form 
shown in eq.~(\ref{eq:jan}),
\begin{equation}
W_\text{new} = 0.7870\, W_\text{old} + 0.9547 \sqrt{W_\text{old}} \nonumber
\end{equation}
is used to correct estimated winds,
where $W_\text{old}$ is the WMO Code 1100 speed of the estimated wind
and $W_\text{new}$ is the corrected wind speed.
It is important to realize
that this new Beaufort equivalent scale produces wind speeds valid at
a 20~meter reference level.  Whenever 10~meter wind speed is required,
the proper conversion from 20~meters is performed using
stability dependent surface layer theory (Appendix~\ref{sec:sfc}).



%............................Cloudiness............................


\subsection{Cloudiness}
\label{sec:cloudcorr}
To reduce the bias caused by the underestimation of cloudiness in low
light levels, we reject all observations taken under dark skies.
A cloudiness observation is considered 
acceptable only if one of the following {\em bright sky} conditions apply 
(Hahn \etall \ 1992):
\begin{equation}
a_s \geq -8^\circ
\end{equation}
or
\begin{equation}
P_m\, \sin a_m \geq 0.2
\end{equation}
where $a_s$ and $a_m$ are the altitudes of the sun
and moon, respectively, with negative altitudes being below the
horizon.  The phase of the moon $P_m$ can vary
between 0 (new moon) and 1 (full moon).  
Equations to determine the altitude of the sun and altitude and phase of
the moon can be found in Appendix~\ref{sec:astronomy}.

We also use the treatment of the {\em sky obscured} observation after 
Hahn \etall \ (1992).  Some of the
phenomena which obscure the sky, such as fog, are associated with
overcast skies.  If the Present Weather code indicates that
the sky is obscured due to rain, snow, fog, or any other
cloud-induced phenomenon, we consider the fractional cloudiness for the 
{\em sky obscured} observation to be 1 and include it as a valid observation.





%.........................Present Weather.................................


\subsection{Present Weather}

Beginning in 1982, clear weather observations are often recorded with
a missing Present Weather indicator.  This practice has an adverse
effect on our precipitation estimates as it introduces a {\em wet} bias.
In order to circumvent this problem we have devised a method of correction
which links PW with cloudiness.  It is assumed that any observer making
a cloud cover observation will also make a PW observation, and vice
versa.  Therefore, when encountering a missing observation from 1982
and later observations, cloudiness is checked.  If cloudiness is
missing, PW is assumed to be missing, and is not included in the
precipitation calculation.  If a cloudiness observation is
present, however, it is assumed that there was a PW observation and that
the weather was clear.  The observation is used as a clear weather
observation in the precipitation calculation. As a test, PW
and cloudiness observations were checked prior to 1982.  Cases in
which a cloudiness observation was present but the PW
observation was missing were very rare.  We are confident, therefore,
that our method of correcting PW is accurate.




%...................Parameterizations......................................



\section{Parameterizations}
\label{sec:parameterizations}

This section describes the parameterizations used in the production
of the data sets. The thermodynamic quantities described below (e.g.,
specific humidity, vapor pressure, etc.) are computed as in COADS
(Slutz \etall~1985) using the software documented in 
Schlatter \etall~(1981).

\subsection*{Symbols}

\begin{tabular}{p{0.5in}p{2.6in}}
$A_a$ & water vapor and $O_3$ coefficient (unitless)\\
$B$ & buoyancy flux (kg m$^{-1}$s$^{-3}$)\\
$c$ & fractional cloud cover (unitless)\\
$c_{p}^{\text{air}}$ & specific heat of air constant (J K$^{-1}$kg$^{-1}$)\\
$c_{p}^{w}$ & specific heat of water as a function of 
              temperature and salinity (J K$^{-1}$kg$^{-1}$)\\
$C_D$ & drag coefficient (unitless)\\
$C_E$ & Dalton number (unitless)\\
$C_T$ & Stanton number (unitless)
\end{tabular}
\begin{tabular}{p{0.5in}p{2.6in}}
$e$ & atmospheric vapor pressure (mb or Pa)\\
$E$ & evaporation rate (m s$^{-1}$ or mm/(3hr))\\
$F_S$ & flux of salt at ocean's surface (p.s.u. m s$^{-1}$)\\
$F_T$ & normalized net heat flux (K m s$^{-1}$)\\
$g$ & acceleration due to gravity (m s$^{-2}$)

\end{tabular}
\begin{tabular}{p{0.5in}p{2.6in}}
$L_E$ & latent heat of evaporation (J kg$^{-1}$), $L_E(T_a) = (
2494- 2.2 * T_a ) * 1000$, $T_a$ in Celsius. \\
$p$ & sea level pressure (mb or Pa)\\
$P$ & precipitation rate (m s$^{-1}$ or mm/(3hr))\\
$q$ & specific humidity (g kg$^{-1}$)\\
$q_s$ & saturation specific humidity at the surface (g kg$^{-1}$),
$q_s = 0.98q_{satur}(T_s)$ \\
$Q_0$ & incident radiation at the top of the atmosphere (W m$^{-2}$)\\
$Q_{\text{net}}$ & net heat flux (W m$^{-2}$)\\
$Q_L$ & latent heat flux (W m$^{-2}$)\\
$Q_S$ & sensible heat flux (W m$^{-2}$)
\end{tabular}
\begin{tabular}{p{0.5in}p{2.6in}}
$R$ & gas constant for dry air (J K$^{-1}$kg$^{-1}$)\\
$R_{\text{clear}}$ & incident short wave radiation under clear 
skies (W m$^{-2}$)\\
$R_{\text{diff}}$ & diffuse component of short wave radiation (W m$^{-2}$)\\
$R_{\text{dir}}$ & direct component of short wave radiation (W m$^{-2}$)\\
$R_L$ & long wave radiation (W m$^{-2}$)\\
$R_S$ & short wave radiation (W m$^{-2}$)\\
$S$ & salinity (p.s.u.$\equiv$parts per thousand)\\
$T_a$ & surface air temperature (\deg~C or K)\\
$T_s$ & sea surface temperature (\deg~C or K)
\end{tabular}
\begin{tabular}{p{0.5in}p{2.6in}}
$u$ & zonal wind (m s$^{-1}$)\\
$u_{*w}$ & oceanic friction velocity (m s$^{-1}$)\\
$v$ & meridional wind (m s$^{-1}$)\\
$W$ & wind speed, $W = \sqrt{u^2+v^2}$ (m s$^{-1}$)\\
$z$ & zenith angle (degrees)
\end{tabular}
\begin{tabular}{p{0.5in}p{2.6in}}
$\alpha$ & ocean surface albedo (unitless)\\
$\alpha'$ & thermal expansion coefficient of sea water (K$^{-1}$)\\
$\beta$ & solar noon altitude (degrees) \\
$\beta'$ & haline coefficient of sea water (p.s.u.$^{-1}$)\\
$\epsilon$ & emissivity of the ocean (0.97) (unitless)
\end{tabular}
\begin{tabular}{p{0.5in}p{2.6in}}
$\theta$ & potential temperature ($\theta \approx T + \gamma z$,
$\gamma = 0.01^\circ$K/m) (K)\\
$\rho$ & air density (kg m$^{-3}$)\\
$\rho_{0}$ & fresh water density as a function of temperature (kg m$^{-3}$)\\
$\rho_w$ & water density as a function of temperature and salinity (kg m$^{-3}$)\\
$\sigma$ & Stefan-Boltzmann constant (W m$^{-2}$K$^{-4}$)\\
$\tau$ & wind stress (N m$^{-2}$)\\
$\tau_a$ & atmospheric transmission coefficient (unitless)\\
$\chi$ & cloud cover coefficient (unitless)
\end{tabular}











The gradients $\partial Q/ \partial T_s$ are evaluated by means of
finite differences.  Monthly mean heat fluxes are first calculated, as
described below, with observed $T_s^{obs}$ and relevant atmospheric
parameters.  Then fluxes are calculated a second time with all
occurences of $T_s^{obs}$ replaced by $T_s^{obs} + 0.01$\deg~C.
Finally, raw (unanalyzed) monthly means of $\partial Q / \partial
T_s$ are estimated by
\be
\der{Q}{T_s} \approx {\Delta Q \over \Delta T_s }=  \frac{Q(T_s+0.01) 
                - Q(T_s)}{0.01}\\
\ee
where $Q$ stands for any of the heat flux components, such as net longwave
radiation or latent heat flux. In the remainder of this section we
summarize the parameterizations of longwave radiation, sensible and
latent heat fluxes, and then describe the computation of the gradient of
constrained net heat flux with respect to SST.



\subsection{Wind stress}

The zonal and meridional components of the wind stress are defined,
respectively, by
%
\begin{eqnarray}
        \tau_x &=& \rho C_D W u \\
        \tau_y &=& \rho C_D W v \, .
%%%\label{eq:tauy}
\end{eqnarray}
%
The air density, including the effect of moisture, is given by
%
\begin{equation}
        \rho = {p \over R T_a ( 1 + 0.61 q )} \, .
\end{equation}
%
The drag coefficient is parameterized as $C_D = f(Z/L) C_{DN}$, where
$C_{DN}$ is the neutral drag coefficient and $f(Z/L)$ is a stability
correction depending on the Monin-Obukhov length.
The neutral drag coefficient formulation is based on 
Large and Pond (1981) modified for low wind speeds as in Trenberth et
al.~(1990):
{\small
\begin{eqnarray*}
C_{DN} &=& \left \{ \begin{array}{l}
2.18 \times 10^{-3} \mbox{ for } W \leq 1 \mbox{m/s}\\
( 0.62 + 1.56/W ) \times 10^{-3} \mbox{ for } 1 < W < 3
\mbox{m/s}\\
1.14 \times 10^{-3} \mbox{ for } 3 \leq W < 10 \mbox{m/s} \\
(0.49 + 0.065 W ) \times 10^{-3} \mbox{ for } W \geq 10 \mbox{m/s.}
\end{array} \right .
\end{eqnarray*}
}
Details of the surface layer formulation are given in 
Appendix~\ref{sec:sfc}.
The stability dependent drag coefficient $C_D$ is a function of 
several surface marine variables:
\begin{equation}
C_D = C_D ( W, T_a, \Delta T, \Delta q ) 
\end{equation}
where 
\begin{eqnarray}
\Delta T & = & T_s - T_a \\
\Delta q & = & q_s - q \, .
\end{eqnarray}
Analysis of the functional form of $C_D$ indicates that for the
observed range of parameters, the linear dependence of $C_D$ on wind
speed is the most important; the thermodynamic quantities only enter
through the boundary layer stability correction.  






As seen from the expressions above, the computation of wind stress
requires simultaneous observations of the following quantities: $u$,
$v$, $p$, $T_a$, $T_s$ and $q$.  In practice it is difficult to obtain
complete ship reports, and cases in which one or more of the above
quantities is missing are very common (Cardone \etall \ 1990).  In
order to circumvent the problem, wind stress is computed for all ship
reports in which the wind data are available (neither missing nor
trimmed by the quality control procedure).  If the thermodynamic
quantities are available, then they are used to compute $C_D$.
Otherwise the missing thermodynamic quantities are {\em filled in} with
the analyzed monthly mean for that particular month.  The accuracy of
using monthly means in the calculation of this stability correction is
discussed by Esbensen and Reynolds (1981).

Also note that the formulation for wind stress neglects the effects of
the ocean's surface current.  Over much of the ocean, wind speed is
one or two orders of magnitude greater than the surface current.  The
surface current can be neglected in such circumstances.  In the
tropics, however, wind speeds are low and current speeds can be high.
Halpern (1988) estimated the uncertainty in zonal wind stress due to
the surface current is $\pm$17\% in the tropics.  Unfortunately,
COADS/CMR-5 does not include surface current information.  However,
wind stress calculated from visually estimated winds will include
current effects.  Wind stress calculated with measured winds will
contain error, but the degree of error is mitigated by a ship's
tendency to drift with the current (W. Large, personal communication).
The zonal wind stress values in this atlas series, therefore,
presumably contain only a small degree of uncertainty in the tropics.

\subsection{Oceanic friction velocity}
Although the wind stress is a measurement of the force of the wind
upon the ocean surface, the ocean's response (e.g. mixed layer depth) 
is related to the work done on the ocean, usually parameterized
in terms of the cube of the atmospheric friction velocity 
(Hellerman and Rosenstein 1983 and references therein).  An estimate
of the turbulent kinetic energy input into the ocean is given by
(Oberhuber 1988):
\begin{equation}
(u_{*w})^3 = (\tau / \rho_w)^{3/2}
\end{equation}
where $\tau$ is the magnitude of the wind stress and $\rho_w$ is the
density of sea water.



\subsection{Evaporation, sensible and latent heat fluxes}

The bulk formulas for evaporation and sensible and latent heat 
fluxes are given by
\begin{eqnarray}
  E & = & \frac{\rho}{\rho_0} C_E W \Delta q \\
Q_S & = & \rho c^{\text{air}}_{p} C_T W \Delta \theta \\
Q_L & = & \rho L_E C_E W \Delta q
\end{eqnarray}
where $\Delta q$ is unitless (grams per gram) and
\begin{eqnarray}
\Delta \theta & = & \theta_s - \theta_a \, .
\end{eqnarray}

The transfer coefficients $C_T$ and $C_E$ are estimated using the Large
and Pond (1982) formulation (see Appendix~\ref{sec:sfc}), which gives
%$C_T and C_E$ as a function of
\begin{eqnarray}
C_T & = & C_T ( W, T_a, \Delta T, \Delta q ) \\
C_E & = & C_E ( W, T_a, \Delta T, \Delta q ) \, .
\end{eqnarray}
For reference, the neutral transfer coefficients are given by
\begin{eqnarray}
C_{TN} & = & \left \{ \begin{array}{ll}
1.2  \times 10^{-3} & \quad \mbox{(stable)}\\
0.75 \times 10^{-3} & \quad \mbox{(unstable)}\\ 
\end{array} 
\right . \\
C_{EN} & = & 1.2 \times 10^{-3} \, .
\end{eqnarray}

Like the wind stress calculation, the heat fluxes and evaporation
require a complete ship report for their calculation.  The wind stress
procedure is modified slightly: sensible (latent) heat fluxes are
computed for all those reports in which $W$ and $\Delta \theta$
($\Delta q$) are available.  The remaining thermodynamic quantities
are {\em filled in} with the analyzed monthly mean value for that grid
point, if not available.  Evaporation is calculated in a manner
similar to latent heat flux.  Evaporation is converted from units of
m/s to mm/(3 hours) in order to match precipitation's units.











\subsection{Precipitation}


Accurate measurements of precipitation at sea are extremely difficult to take.
As a result, precipitation rate 
is not included in ship reports.  However, the type of weather the ship
encounters is recorded and can be used as a precipitation proxy.

Precipitation rate is estimated using the method developed by Tucker (1961).
The method uses the Present Weather (PW) information of
standard ship reports and relates it to precipitation rate according to a
regression formula.

The PW is reported at 3 hour intervals (usually less
frequently) with the results being coded
from 00 to 99.  Tucker considers that weather associated with codes 50 to 99
contribute significantly
to precipitation.  Based on data for 12 stations around the British Isles,
Tucker derived a regression formula which relates precipitation during the
3 hour sampling interval to the amount of light, moderate, or heavy
precipitation ($x$, $y$, and $z$ respectively).  Each PW code is then expressed
as a linear combination of $x$, $y$, and $z$ as shown in 
Table~\ref{tab:tucker}.  Tucker's estimates for these
coefficients are $x = 1.85$~mm, $y = 5.66$~mm, and $z = 8.13$~mm per 3
hour period.

\begin{table*}[tp]
\caption[Tucker's (1961) precipitation rates]{Precipitation rate in
terms of $x$, $y$, and $z$ for Present
Weather codes 50 through 99 (from Tucker 1961): $x = 1.85$~mm/(3 hours), $y
= 5.66$~mm/(3 hours), and $z = 8.13$~mm/(3 hours).}
\label{tab:tucker}
\begin{center}
{\small
\begin{tabular}{c|cccccccccc} 
\hline
PW & 0 & 1 & 2 & 3  & 4 & 5 & 6 & 7 & 8 & 9 \\ \hline
50 & $0$ & $x/2$ & $x/2$ & $x$ & $y$ & $2y$ &
$x/2$ & $y/2$ & $x/2$ & $y/2$ \\
60 & $x/2$ & $x$ & $y/2$ & $y$ & $z/2$ & $z$ &
$x$ & $(y+z)/2$ & $x$ & $(y+z)/2$ \\
70 & $x/2$ & $x$ & $y/2$ & $y$ & $z/2$ & $z$ &
$0$ & $0$ & $0$ & $0$ \\
80 & $x/2$ & $y/2$ & $z/2$ & $x/2$ & $(y+z)/4$ & $x/2$
& $(y+z)/4$ & $x/2$ & $(y+z)/2$ & $x/2$ \\
90 & $(y+z)/2$ & $x$ & $(y+z)/2$ & $x$ &
$(y+z)/2$ & $(x+y)/2$ & $(x+y)/2$ & $z$  & $0$
& $z$ \\ \hline
\end{tabular}
}
\end{center}
\end{table*}

Because the PW does not have an adequate range to accommodate the tropics,
Dorman and Bourke (1978) derived an additional correction which takes into
consideration the local air temperature:
\begin{equation}
P_{\text{corrected}} = P_{\text{Tucker}} ( a + bT_a + cT_a^2 ) \, .
\end{equation}
Dorman and Bourke (1978) give correction coefficients $a$, $b$, and $c$
for each month of the year.  The coefficients are shown in 
Table~\ref{tab:dandb}.  The corrected values for $P$ are used to
calculate monthly mean precipitation rate.

\begin{table}[p]
\caption[Correction coefficients for precipitation]{Monthly air
temperature correction coefficients (from Dorman and
Bourke 1978). Temperature should be given in Celsius.}
\label{tab:dandb}
\begin{center}
\begin{tabular}{c|ccc} \hline
    & $a$   & $b$     & $c$ \\ \hline
Jan & 0.973 & 0.0469  & 0.00382 \\
Feb & 0.941 & 0.0412  & 0.00207 \\
Mar & 0.804 & 0.0404  & 0.000129 \\
Apr & 0.720 & 0.0603  & 0.000042 \\
May & 0.489 & 0.0678  & 0.000012 \\
Jun & 0.726 & -0.1030 & 0.008885 \\
Jul & 1.734 & -0.2362 & 0.011943 \\
Aug & 1.115 & -0.1217 & 0.008146 \\
Sep & 0.548 & 0.0060  & 0.005140 \\
Oct & 0.671 & 0.0421  & 0.002934 \\
Nov & 0.896 & 0.0701  & 0.001350 \\
Dec & 0.985 & 0.0662  & 0.001148 \\ \hline
\end{tabular}
\end{center}
\end{table}

 The precipitation fields obtained with the formula above showed an
unrealistic minimum in Spring when compared to estimates from NMC and
NASA/Goddard (Schubert \etall~1993) reanalyses, as well as
Arkin and Meisner's (1987) GOES Precipitation Index. This abrupt
decrease of precipitation in spring is not present in the
uncorrected $P_{\text{Tucker}}$, but is introduced, rather, by
the correction factor $( a + bT_a + cT_a^2 )$.  In order to remove
this spurious seasonal cycle in precipitation, we have used the annual
mean of Dorman and Bourke's (1978) correction factor in our
precipitation calculations: the monthly mean correction was calculated
from the 12 monthly climatologies of air temperature and averaged to
form the annual mean correction.  This modification has little effect
on the annual mean precipitation and fresh water fluxes into the
ocean.  The precipitation fields computed with Dorman and Bourke's
(1978) original approach will be made available upon request.




\subsection{Net short wave and net long wave radiation}
\label{sec:radiation}

The incoming solar radiation at the top of the atmosphere 
is computed from the formulas given in
{\em Smithsonian Meteorological Tables} (List 1958), 
with an attenuation by clouds as in Reed (1977).  
The formula adopted here is the same as described in
Rosati and Miyakoda (1988):
\begin{equation}
R_S = R_{\text{clear}}\( 1 - 0.62c + 0.0019\beta \)\(1-\alpha\) \, .
\end{equation}
The parameter $R_{\text{clear}}$, the incident radiation under clear
skies, is composed of direct and diffuse components of short wave
radiation:
\begin{equation}
R_{\text{clear}} = R_{\text{dir}} + R_{\text{diff}} \, .
\end{equation}
The direct component of short wave radiation is
\begin{equation}
R_{\text{dir}} = Q_0 \tau_a^{\sec z}
\end{equation}
where the atmospheric transmission coefficient $\tau_a = 0.7$, $z$ is
the zenith angle of the sun, and $Q_0$ is the incident radiation at the
top of the atmosphere.  The diffuse component of net short wave
radiation is
\begin{equation}
R_{\text{diff}} = [(1-A_a) Q_0 - R_{\text{dir}}]/2
\end{equation}
where  $A_a = 0.09$ is the absorption due to water vapor and ozone.
The solar noon altitude in degrees ($\beta$), $Q_0$, and  $z$ are computed
from present day astronomy (see Appendix~\ref{sec:astronomy}).





The ocean surface albedo $\alpha$ is taken from Payne (1972).  In
order to compute monthly means of $R_S$, results from the formula are
averaged for each day of the month, using analyzed monthly means of
cloudiness for $c$.

The net long wave radiation is based on an empirical formula 
which includes the effect of air-sea temperature difference
(e.g., Rosati and Miyakoda 1988)
\begin{eqnarray}
R_L & = & \epsilon \sigma T_s^4 \( 0.39 - 0.05 \sqrt{e} \) 
\( 1 - \chi c^2 \)  \nonumber \\
& & + 4 \epsilon \sigma T_s^3 \( T_s - T_a \) \, .
\end{eqnarray}
The dimensionless cloud coefficient $\chi$ is allowed to vary with
latitude in order to account for different cloud types (Budyko 1974,
Oberhuber 1988). This bulk parameterization is based on a formula
originally given by Brunt (1932), later modified to include the term
proportional to $T_s-T_a$ which attempts to include the effects of the
temperature difference between the surface layer and the lower layer
of air (Budyko 1974). Although several authors have adopted the
proportionality term $T_s^3$ as above (e.g., Simpson and Paulson 1979,
Rosati and Miyakoda 1988), others (Bunker 1976,
Hsiung 1986, Oberhuber 1988, Isemer \etall \ 1989) have used
$T_a^3$ instead.







\subsection{Buoyancy flux}

The buoyancy flux out of the ocean is computed by the formula (e.g.,
Schmitt \etall \ 1989)
\begin{equation}
\label{eq:buoy}
B = g \rho_w \( \alpha' F_T + \beta' F_S \)
\end{equation}
where $\rho_w$ is the water density at the surface, and $\alpha'$ and $\beta'$
are the thermal expansion and haline coefficients:
\begin{eqnarray}
\alpha' & = & - \frac{1}{\rho_w} \frac{\partial \rho_w}{\partial T_s}\\
\beta' & = & \frac{1}{\rho_w} \frac{\partial\rho_w}{\partial S} \, .
\end{eqnarray}
In eq.~(\ref{eq:buoy}) $F_T = -Q_{\text{net}} / \rho_w c_p^w$ is the
normalized heat flux, with $Q_{\text{net}}$ being the net heat
flux into the
ocean:
\begin{equation}
Q_{\text{net}} = R_S - Q_L - Q_S - R_L \, .
\end{equation}
The flux of salt due to loss of fresh water at the surface is given by:
\begin{equation}
F_S = S \frac{E - P}{1 - \frac{S}{1000}} \, .
\end{equation}
The components of net heat flux ($Q_{\text{net}}$) and 
the evaporation and precipitation rate estimates
are computed from COADS individual observations as described above and adjusted
using the constraints discussed in section~\ref{sec:tuning}.  
Sea surface salinity, $S$, however, is not part of standard 
ship synoptic weather
reports.  As 
salinity enters the above equation primarily as a coefficient, and as the
interannual variability of salinity is only a few percent of its
climatological value, we use the Levitus \etall \ (1994) monthly
climatological surface salinity values in the above formula.






\subsection{Surface atmospheric fluxes}
The surface zonal and meridional transports of atmospheric heat and moisture are estimated
along the surface by $uT_a$, $vT_a$, $uq$, and $vq$.  The zonal and
meridional wind speed used in these terms, $u$ and $v$, are corrected
as discussed previously and adjusted to a reference height of 10~m.
In the calculation of $ua$ and $va$,
the wind components are multiplied by the air temperature measured in
Kelvins.  In the calculation of zonal and meridional moisture flux,
each wind component is multiplied by the specific humidity, measured
in grams per gram (yielding units of m/s). Notice that ($uq$,$vq$)
is not the vertical flux of moisture and therefore is not sufficient
to quantitatively close the atmospheric moisture budget and provide a
check on E-P. However, at
the tropics the surface moisture divergence can be used to
qualitatively assess the patterns of E-P.




%.......................end param, begin analysis..........................

\section{Computation of month\-ly sta\-tis\-tics and ob\-jec\-tive
an\-al\-ysis}
\label{sec:analysis}

The raw monthly fields are computed from the individual observations 
in the following manner:
\begin{enumerate}

\item The world oceans are divided into boxes with constant grid spacing
in latitude and longitude.  The grid we consider here is 1-degree
latitude by 1-degree longitude (the same as Levitus [1982]).

\item All available (quality controlled) observations are averaged in
each box for each month during the 45 year period, and the standard
deviation and number of observations recorded.  Bias corrections, if
applicable, are made to each individual observation before averaging.



\end{enumerate}

The raw monthly mean fields are then objectively analyzed to filter out
spatial noise and interpolate to gridpoints where data are missing.
The objective analysis scheme used is essentially the same scheme described by 
Levitus (1982).
This is an iterative
difference-correction scheme (Cressman 1959) with a weight function developed
by Barnes (1964).  The procedure can be summarized as follows:
\begin{enumerate}
\item Determine a first guess $F$ (see below).
\item Compute the difference between the raw observed data ($O$) and the
first guess ($F$), 
$$Q_{ij} = O_{ij} - F_{ij},$$ 
at grid point ($i,j$).
\item Compute the smoothed analysis increments
\begin{equation}
C_{ij} = \frac{ \sum_{s=1}^n W_s Q_{i_s,j_s }}{ \sum_{s=1}^n W_s }
\end{equation}
where $W_s$ is the Barnes weight function:
$W_s = \exp (-4 r^2 R^{-2})$ for $r \leq {\cal R}$ where $r$ is the distance between
the $s$th gridpoint $(i_s,j_s)$ and the analysis 
gridpoint $(i,j)$. The sum
on the RHS is over the region of influence, i.e., those points that are at
a distance less than ${\cal R}$, the radius of influence.
\item Update the first guess
\begin{equation}
F_{ij} := F_{ij} + C_{ij} \, .
\end{equation}
\item Apply a 5--point nonlinear median filter to $F_{ij}$ (Beaton and
Tukey 1974; Rabiner \etall \ 1975) followed by two passes of a 5--point
linear filter (Shapiro 1970).  It was found that this combination effectively
filters out noise with scales of the mesh-size.  The two filters are
applied as follows:
\begin{enumerate}
\item  Non-linear.  The smoothed value at the grid point ($i,j$) is simply 
the {\em median}
value of the nine grid points in the 3 by 3 box centered at the grid point 
($i,j$).  The filter is not applied to grid points located over or adjacent to
land.  The
median filter is used to remove noise from the data while preserving 
sharp gradients (Reynolds 1988; Rabiner \etall \ 1975).
\item  Linear.   The smoothed value $S_{ij}$ at grid point ($i,j$) of
a grid $G$ is
\begin{eqnarray*}
S_{ij} &=& G_{ij} + \frac{\alpha}{4} ( G_{i-1,j} + G_{i+1,j} \\
           &+& G_{i,j-1} + G_{i,j+1} - 4 G_{ij} )
\end{eqnarray*}
where $\alpha$ is a smoothing parameter.  Two passes of
the Shapiro filter are performed with $\alpha = 0.5$ for the
first pass and $\alpha = -0.5$ for the second pass. The second pass is
intended to restore the amplitude of the large scales which were
slightly damped in the first pass (Shapiro 1970).
The filter is not applied to the grid point if it is located 
over land or if any of the four adjacent grid points (north, south,
east, and west) are located over land.
\end{enumerate}

\item Repeat steps 2--5 with a different radius of influence $R$.

\end{enumerate}

The radius of influence is decreased with each pass in order to
analyze smaller scale features with each successive iteration (Cressman 1959).
In practice, the smallest wavelengths are noisy.
Therefore, the smallest radius of influence needs to be at least seven to
eight times the average separation distance (Levitus 1982).  The smallest
radius of influence we use, 771~km, is over seven times the average
separation distance of a 1- by 1-degree grid.

For climatologies and anomalies, 4 passes of the analysis scheme are
performed with radii of influence equal to 1541~km, 1211~km, 881~km,
and 771~km, as in Levitus (1982).  These radii correspond to 14\deg,
11\deg, 8\deg, and 7\deg \ in latitude and longitude at the Equator.
At 60\deg \ latitude North or South, the radii correspond to 28\deg,
22\deg, 16\deg, and 14\deg \ longitude.  Below 40\deg S only the first
two passes of the analysis are used in an effort to smooth the noisy
data in these latitudes.  The standard deviation and standard error
fields are also noisy.  In order to smooth them sufficiently, only two
passes of the analysis are applied to those fields, using the two
largest radii.

\begin{table}[htp]
\caption[Objective analysis response function]{Response function for
objective analysis with and without
linear Shapiro filter. }
\label{tab:response}
\begin{center}
\begin{tabular}{cccc}\hline
wavelength & no filter & \multicolumn{2}{c}{with filter} \\
(km) & 4 passes & 4 passes & 2 passes \\
\hline
3300    & 1.00  & 1.01 & 0.90 \\
2640    & 0.99  & 1.00 & 0.77 \\
2200    & 0.97  & 0.98 & 0.65 \\
1980    & 0.95  & 0.95 & 0.56 \\
1650    & 0.87  & 0.88 & 0.36 \\
1320    & 0.70  & 0.69 & 0.14 \\
1100    & 0.49  & 0.49 & 0.07 \\
 990    & 0.37  & 0.36 & 0.04 \\
 880    & 0.23  & 0.22 & 0.01 \\
 660    & 0.05  & 0.05 & 0.01 \\
 550    & 0.02  & 0.02 & 0.01 \\
\hline
\end{tabular}
\end{center}
\end{table}

The response function for the objective analysis using four passes
with radii of 1541, 1211, 881, and 771~km, but without any linear or
nonlinear filter, is given in the second column of
Table~\ref{tab:response} (from Levitus 1982).  As expected, the short
wavelengths are damped severely while the intermediate and longer
wavelengths receive moderate and little damping, respectively.
Table~\ref{tab:response} also shows the response function of the
analysis
including the linear filter, for both four passes and two passes of
the analysis.  Notice that the damping is much greater for all but the
smallest wavelengths with two passes of the analysis compared to that
with four passes.  For extremely long wavelengths (not shown), the
damping from two passes of the analysis is nearly identical to the
damping from four passes.

Finally, the first guess for the analysis depends on the kind of data
being analyzed:

\begin{description}

\item[Annual Mean Climatology:] \mbox{}\\
Individual raw monthly means are averaged to
produce the raw monthly mean climatologies.  These monthly
climatologies are averaged to produce the raw annual climatology.  The
first guess for the annual climatology analysis is the zonal average
for the individual ocean basins, following Levitus (1982).

\item[Monthly Mean Climatologies:] \mbox{}\\
The first guess for the analysis 
of a raw monthly
climatology is the analyzed annual mean climatology.


\item[Monthly Mean Anomalies:] \mbox{}\\
From the observed 
raw monthly mean fields, the
monthly mean analyzed climatology is subtracted to produce observed
{\em raw} anomalies.  A zero field is used as first guess in the
analysis scheme.


\item[Monthly Standard Deviation/Error:]\mbox{}\\
 The first guess 
for the analysis of
the raw monthly standard deviation or standard error is the zonal average for
the individual ocean basins.

\end{description}

%...................end analysis, begin fine tuning.......................


\section{Fine tuning of heat and fresh water fluxes}
\label{sec:tuning}

One of the applications of surface marine fluxes 
is the study of the heat and fresh water balances of the
world oceans. Similar calculations based on surface marine data have
been performed by many authors (Budyko 1956, Baumgartner and Reichel
1975, Esbensen and Kushnir 1981, Hastenrath 1982, Hsiung 1985,
Oberhuber 1988, Isemer \etall\ 1989, among others).  As an example,
consider the vertically integrated heat budget equation for the oceans
\begin{equation}
\der{H}{t} + \nabla \cdot \cH = Q_{net}
\label{eq:heat_balance}
\end{equation}
where
\begin{eqnarray}
      H & = & \mbox{oceanic heat content}\\
    \cH & = & \mbox{vertically integrated oceanic heat transport} 
              \nonumber \\
        & = & (\cH_x,\cH_y) \\
Q_{net} & = & \mbox{net heat flux at the surface} \nonumber \\
        & = & R_{S} - \( R_{L} + Q_{L} + Q_{S} \) \, .
\label{eq:qnet}
\end{eqnarray}
Integrating (\ref{eq:heat_balance}) for a sufficiently long period of
time, the storage term ${\partial H / \partial t}$ can be neglected,
resulting in the balance equation
\begin{equation}
\nabla \cdot \overline{ \cH } = \bQ
\label{eq:heat_bal}
\end{equation}
which relates the surface net heat flux to the divergence of the
mean vertically integrated oceanic transport. If this equation is integrated
over the globe, the left hand side (LHS) vanishes, as the heat
exchange with the
continents is negligibly small. This imposes a consistency condition
on the net heat fluxes:
\begin{equation}
\int\!\int_{Globe} \bQ\, \, dx\, dy = 0 \, .
\label{eq:qnet_consist}
\end{equation}
As can be seen from (\ref{eq:qnet}), $Q_{net}$ is computed as a
residual from large, uncertain terms and the condition 
(\ref{eq:qnet_consist}) is not
guaranteed to be met.  Figure~\ref{fig:unnhf} shows the mean 
annual net heat flux over the
global ocean (in W/m$^2$).  Clearly, the amount of outgoing (negative)
heat flux is not sufficient to balance the amount of incoming
(positive) heat flux. The imbalance is about 10.5~PW
(10.5$\times 10^{15}$ W) which averages to 30.2~W/m$^2$ over the entire
ocean.  Likewise, there are imbalances between our
estimates of evaporation and precipitation that cannot be accounted
for by the Baumgartner and Reichel (1975) estimates of river runoff
(not shown).  If our heat
fluxes were used ``as is'' to force global oceanic models, an
unrealistically large warming trend would result in global mean heat content.
The goal of this section is to describe an additional set of
corrections aimed at producing physically consistent (in the sense of
approximately satisfying eq.~(\ref{eq:qnet_consist}) or independent
oceanic measurements) surface heat and fresh water fluxes over the
global oceans.

\begin{figure*}[tp]
\centerline{
\epsfxsize=6.5in
\epsfbox[60 260 565 565]{ps/unnhf.ps} }
\caption[Unconstrained net heat flux]{Unconstrained annual mean 
net heat flux over the global ocean (contour interval: 20.\ W/m$^2$).
Shaded (negative) values denote outgoing heat flux.}
\label{fig:unnhf}
\end{figure*}

There are two main sources of errors in estimates of surface marine
fluxes from historical data. First, there are observational errors
associated with instrument bias (section~\ref{sec:biases}) and sampling
problems associated with the uneven, and in some areas inadequate,
data coverage of the world oceans (section~\ref{sec:fwb}). Second,
even in the presence of perfect surface marine data, one needs to rely
on bulk parameterizations --- simplified representations of complex
air-sea interaction processes.  A typical example is the short wave
radiation which depends on the optical properties of the
three-dimensional atmosphere.  Its parameterization, however, is in
terms of monthly mean fractional cloud cover with constant
coefficients for transmission and water vapor absorption
(section~\ref{sec:radiation}).  In addition to these simplified
expressions, the tuning of bulk parameterizations is usually performed
in specific geographic locations.  Tuning derived in one location may
not be representative of other parts of the oceans (e.g., Large and
Pond (1981, 1982) where transfer coefficients have been experimentally
derived on a deep water tower in the North Atlantic and OWS Papa in
the North Pacific). The individual
components that make up the net heat flux depicted in
Fig.~\ref{fig:unnhf} are affected by all of these uncertainties. Since
$Q_{net}$ is a small residual from heat gain (incoming solar
radiation) and heat loss (primarily due to evaporation) terms, its
relative error is much larger than the relative error for each of the
individual components.

In section~\ref{sec:biases} we have documented our attempts to
reduce some of the observational biases in COADS. Here, we perform a
simple linear inverse calculation to derive small corrections for some
of the bulk formula parameters, thereby producing a more physically
consistent net heat flux.  The technique is standard in geophysics
and the development here is similar to Isemer \etall~(1989). 
A more detailed exposition can be found in Menke (1984). 

%....................................................................
\subsection{Linear Inverse Calculation}
\label{sec:inverse_theory}

Without loss of generality, let us consider the fine tuning of heat 
fluxes. Assuming no heat exchange with the continents,
(\ref{eq:heat_bal}) can be integrated to produce an estimate of the
vertically and zonally integrated meridional heat transport
\be
\cHy(y) = \cHy(y_N) + \int_y^{y_N} dy \int Q_{net} \, dx
\label{eq:mht}
\ee
where cartesian coordinates have been adopted for notational 
convenience.
In (\ref{eq:mht}), $y_N$ is a northern latitude where $\cHy(y_N)$ is
specified as a boundary condition. In addition to latitude, the
meridional heat transport $\cHy$ also depends on the particular 
choice of $m$ parameters $\bp = (p_1,...,p_m)$ 
entering the bulk formulas. 
We explicitly denote this dependence by
\be
\cHy \equiv \cHy(y,\bp) \, .
\ee
Let us denote by $\bp^*$ the current choice of parameters in the bulk
formulas. The goal is to find small adjustments $\delta \bp$ so that
$\cHy(\bp^*+\delta \bp)$ agrees in some sense with $n$ oceanographic
measurements $\cHd(y_j)$, $j=1,...,n$. For the cases considered here,
$m>n$, leading to an {\em underdetermined} problem. We make the
following assumptions:
\begin{enumerate}

\item The bulk formula parameter errors are normally distributed and
uncorrelated, with an error covariance matrix denoted by $\bE =
\diag(e_1^2,...,e^2_m)$.

\item The measurement errors are normally distributed and
uncorrelated, with an error covariance matrix denoted by $\bR = \diag
(r_1^2,...,r^2_n)$.

\item Bulk formula parameter errors and measurement errors 
are uncorrelated.

\end{enumerate}

\noindent For small adjustments $\dbp$ the meridional 
heat transport can be linearized about $\bp^*$ at the
measurement locations:
\be
\cHy(y_j, \bp^* + \dbp) \approx \cHy(y_j,\bp^*) + \sum_{i=1}^m
A_{ji} \delta p_i, \quad j = 1,...,n
\label{eq:linear_mht}
\ee
where $A_{ji}$ are the elements of the {\em sensitivity matrix}
$\bA\in\Re^{n\times m}$,
\be
A_{ji} = \left . \der{\cHy}{p^*_i} \right
|_{y=y_j,\bp=\bp^*} \, .
\ee
A solution of this underdetermined problem is
found by minimizing the functional
\be
J(\bp) =  (\bp-\bp^*)^T \bE^{-1} (\bp-\bp^*) + \bd^T \bR^{-1} \bd
\label{eq:func1}
\ee
where $(\ )^T$ denotes transpose, and
$\bd\in \Re^n$ contains the imbalances between 
the measurements and the meridional heat transport with 
the adjusted parameters $\bp=\bp^*+\dbp$, viz.
\be
d_j= \cHd(y_j) - \cHy(y_j,\bp), \qquad j=1,...,n \, .
\label{eq:nl_imbalance}
\ee
In a least square sense, the first term in the RHS of (\ref{eq:func1})
penalizes large changes in $\bp$ from the reference value $\bp^*$,
while the second term penalizes large imbalances between measured and
computed meridional heat transport. Therefore, the measurements $\cHd$
enter (\ref{eq:nl_imbalance}) 
as a {\em weak constraint}. Both terms of the functional are
weighted by the inverse of the error covariance matrices,
which in principle need not be diagonal as assumed here.
Under the assumption of normality
stated above,
the functional (\ref{eq:func1}) follows from a maximum
likelihood principle (Menke 1984).  

Using (\ref{eq:linear_mht}), a
linearized version of (\ref{eq:func1}) can be found
\be
J(\dbp) = \dbp^T \bE^{-1}\dbp 
        + \( \bA\,\dbp - \bd^*\)^T \bR^{-1} \(\bA\,\dbp -\bd^*\)
\label{eq:func}
\ee
where $d_j^* = \cHd(y_j) - \cHy(y_j,\bp^*)$, $j=1,...,n$, denotes 
the imbalance between the measurements and the
meridional heat transport computed with the current set of parameters
$\bp^*$.
Setting $\nabla_{\dbp} J=0$ one finds that the desired minimum
satisfies
\be
\bE^{-1} \, \dbp + \bA^T \bR^{-1} \(\bA\,\dbp -\bd^*\) = 0
\ee
or equivalently,
\be
\dbp = \( \bE^{-1} + \bA^T\bR^{-1}\bA\)^{-1} \bA^T \bR^{-1} \bd^* \, .
\ee
Using the following matrix identity (e.g., Jazwinski~1970, p. 261)
\be
\( \bE^{-1} + \bA^T\bR^{-1}\bA\)^{-1} \bA^T \bR^{-1} \equiv
\bE \bA^T \( \bA \bE \bA^T + \bR \)^{-1}
\ee
one arrives at the final result
\be
\fbox{\ $\dbp = \bE \bA^T \( \bA \bE \bA^T + \bR \)^{-1} \bd^*$\ } \, .
\label{eq:multiple}
\ee
(Notice that this equation differs slightly from eq. (13{'}{'}) in
Isemer \etall~(1989) where the solution is shown as $\dbp = \bE \bA^T
\( \bA \bE \bA^T + \bR^{-1} \)^{-1} \bd^* $. This typographic error
has been acknowledged by H.-J. Isemer [personal communication].  )

\noindent In the particular case of a single measurement ($m=1$), 
eq.~(\ref{eq:multiple}) reduces to
\be
\delta p_i = {e_i^2 A_i \over \sigma_*^2 + r^2} \( \cHd(y) -
\cHy(y,\bp^*) \) \label{eq:single}
\ee
where $\sigma_*^2 \equiv \sum_{i=1}^m e_i^2 A^2_i$ (the index $j$ 
has been omitted).

A plausibility condition to be checked {\em a posteriori} is whether
the adjustments $\delta p_i$ are small enough compared to the 
assumed errors $e_i$. Following Isemer \etall~(1989), 
we accept a solution if
\be
|\delta p_i| < e_i \label{eq:error_cond} \, .
\ee
As discussed by Isemer \etall~(1989), the standard $\chi^2$-test, used
to assess the {\em goodness-of-fit} of the parameter estimates, is
problematic given that one has very little confidence on the error
variances $e_i^2$.


%..............................................................
\subsection{Fine tuning of heat fluxes}
\label{sec:hf_tuning}

As an illustration of the technique, we apply the single constraint
results of the previous section to fine tune the heat fluxes,
independently of the fresh water fluxes. The consistent tuning of heat
and fresh water fluxes will be discussed in
section~\ref{sec:multiple_tuning}.

Non-dimensional parameters $p_{Tr}$, $p_{c}$, $p_e$, $p_\chi$,
$p_L$, and, $p_S$ are introduced in the bulk formulas
\begin{eqnarray}
R_{S} &=& p_{Tr} R_{\mbox{clear}}\nonumber \\
& & \times\, \( 1 - p_c 0.62c + 0.0019\beta \)\(1-\alpha\)
\label{eq:sw_tune}\\
R_{L} &=& \epsilon \sigma T_s^4 p_e \( 0.39 - 0.05 \sqrt{e} \) 
\( 1 - p_\chi \chi c^2 \) \nonumber \\
& & +\, 4 \epsilon \sigma T_s^3 \( T_s - T_a \)
\label{eq:lw_tune}\\
Q_{L} & = & p_L \rho L_E C_E W ( q_s - q )
\label{eq:lat_tune}\\
Q_{S} & = & p_S \rho c_p C_T W ( \theta_s - \theta ) 
\label{eq:sens_tune}\, .
\end{eqnarray}
In the short wave parameterization (\ref{eq:sw_tune}), the tuning
parameter $p_{Tr}$ is roughly associated with the transmission
coefficient and water vapor absorption coefficient
(section~\ref{sec:radiation}), and $p_c$ is related to the cloud cover
coefficient. In the long wave radiation formula (\ref{eq:lw_tune}),
$p_e$ is associated with the parameterized water vapor effect, and
$p_\chi$ with the tuning parameter for the cloud cover correction. In
the latent and sensible heat flux parameterizations, we have specified
a single tuning parameter for each formula ($p_L$ and $p_S$),
representing primarily the uncertainties in the transfer
coefficients. To be consistent with the maximum likelihood principle
used to derive (\ref{eq:multiple}), one only needs to assume that 
the tuning
parameter errors are normally distributed.  We have made the
additional assumption that the parameter errors are also uncorrelated,
leading to a diagonal matrix $\bE$.  Note, however, that
uncertainties in the sensible and latent heat fluxes can be associated
with errors in wind speed, and need not be
uncorrelated.  At this time, however, we neglect this correlation.

Currently, all non-dimensional tuning parameters are set to 1
($p^*_i=1 \, \forall \, i$) and we seek small corrections $\delta p_i <
1$. In order to apply the results of the previous section we need
to specify error estimates $e_i$.  As can be seen from
(\ref{eq:multiple}), the correction $\dbp$ is proportional to the
parameter error covariance matrix $\bE$.  It has been our experience
that the results are extremely dependent on the particular choice of
$\bE$. Unfortunately, it is very difficult to obtain reliable
estimates for the error variances of $\bp$. (Note that $e_i$
correspond to the random part of the errors in $\bp$ and should not
include bias.) Our approach, therefore, is to provide the necessary
fields to allow users of UWM/COADS to perform their own fine tuning of
the surface marine fluxes (see section~\ref{sec:custom}).
For the sake of illustration, we present results with the error
estimates 
\bea 
e_{Tr} = e_{c} = e_e = e_\chi &=& 10\% \label{eq:hf_errors1}\\ 
e_L = e_S &=& 20\%  \, . \label{hf_errors2}
\eea 
This choice reflects the large scatter associated with the
turbulence measurements used to obtain the base value for the transfer
coefficients $C_E$ and $C_T$. Table~\ref{tab:chf} presents the result
of single constraint calculations. As northern boundary conditions we
specify a northward transport of 0.1~PW at 65\deg~N in the North Atlantic,
and 0~PW at 65\deg~N in the North Pacific (Aagaard and Greismann 1975).  As
single-constraints in the southern boundary  we specify: 
a) no transport at the southern-most latitude
not covered by climatological ice; b) 1.22~PW at 25\deg~N according to Hall
and Bryden (1982); and c) 0.6~PW at the equator in the Atlantic (Wunsch
1984). The last column in Table~\ref{tab:chf} 
gives the value of the constrained transport at
a reference latitude. Overall, the value of the adjusted tuning
parameter is fairly insensitive to the particular constraint imposed, 
and the constrained net surface heat flux (not shown)
has a much higher degree of
balance than the unconstrained product in Fig.~\ref{fig:unnhf}.  The
main effect on the individual heat flux components is to decrease 
the solar radiation and increase the heat loss due to
evaporation. These results are qualitatively similar to the adjustments
Oberhuber (1988) applied to his COADS based heat flux 
estimates to achieve a global heat balance. 

\begin{table*}[tp]
\caption[Parameters from the single-constraint adjustment of 
heat fluxes.]{Parameters from the single-constraint tuning of
heat fluxes. The meridional heat transport at 65\deg~N has been
specified as 0.1~PW in the North Atlantic and 0~PW in the North
Pacific (Aagaard and Greismann 1975). See text for details.}
\label{tab:chf}
\begin{center}
\begin{tabular}{l|rrrrrr|l}\hline
\mcol{1}{c}{Imposed} & \mcol{6}{c}{Tuning Parameters} & \mcol{1}{c}{Resulting} \\
\mcol{1}{c}{Constraint} & $p_{Tr}$ & $p_c$ & $p_e$ & $p_\chi$ & $p_L$
& $p_S$ & \mcol{1}{c}{Transport}\\ \hline
0.0 PW \@ 65\deg S Global & 0.93 & 1.04 & 1.02 & 0.99 & 1.15 & 1.02 &
0.95 PW \@ 25\deg N Atlantic \\
0.0$\pm$0.1 PW \@ 65\deg S Global & 0.93 & 1.04 & 1.02 & 0.99 & 1.15 &
1.01 & 0.95 PW \@ 25\deg N Atlantic \\
1.0 PW \@ 25\deg N Atlantic & 0.93 & 1.04 & 1.02 & 0.99 & 1.16 & 1.03 &
0.43 PW \@ 65\deg S Global \\
1.22$\pm$0.3 PW \@ 25\deg N Atlantic & 0.93 & 1.04 & 1.02 & 0.99 &
1.17 & 1.04 & 0.81 PW \@ 65\deg S Global \\
0.6 PW \@ 0\deg Atlantic & 0.93 & 1.04 & 1.02 & 0.99 & 1.16 & 1.03 &
-0.75 PW \@ 65\deg S Global\\ \hline
\end{tabular}
\end{center}
\end{table*}


%..............................................................
\subsection{Fine tuning of fresh water fluxes}
\label{sec:fw_tuning}

The steady state meridional fresh water transport equation can be
written as
\be
\nabla \cdot \cF = P - E
\ee
where the bar $\overline{(\ )}$ denoting time mean has been omitted.
Integrating this equation from the north we obtain the zonally
integrated meridional fresh water transport
\be
\cFy(y) = \cFy(y_n) + \int_y^{y_n} R(y) \, dy \,
        + \int_y^{y_n} dy \int \(P-E\) \, dx 
\label{eq:mfw} 
\ee
where $\cFy(y_n)$ denotes the northward fresh water transport at
latitude $y=y_n$, and $R(y)$ is the river runoff into the oceans as a
function of latitude. As before, we introduce non-dimensional tuning
parameters for each fresh water transport source term, viz.
\bea
E &=& p_E E^*\\
P &=& p_P P^* \\
R &=& p_R R^*
\eea
where $E^*$, $P^*$, $R^*$ denote the evaporation, precipitation and
runoff computed with the current bulk formula parameters. As northern
boundary conditions we use $-0.106$~Sv at 70\deg~N in the North Atlantic and
0~Sv at 70\deg~N in the North Pacific (Baumgartner and Reichel 1975,
Aagaard and Greismann 1975). Annual mean values of runoff are taken 
from Baumgartner and Reichel (1975) except for the 5\deg\ box adjacent
to the Mediterranean which is modified as follows.
Baumgartner and Reichel's (1975) runoff into the eastern margin of the 
Atlantic appears too small to include all the fresh water transport
into the Mediterranean (rivers and the Black Sea), but too large to
take into account the total water transport into the Mediterranean
(including flow from the Atlantic).  Therefore, portions of the water
balance were recalculated from various sources.  Net transport from
the Black Sea into the Mediterranean is about 200~km$^3$/y and from
the Atlantic into the Mediterranean is approximately 1700~km$^3$/y (Lacombe
and Richez 1981).  River runoff into the east coast of the Atlantic
between 35 and 40\deg~N is around 22~km$^3$/y (UNESCO 1969, van der
Leeden 1975).  River runoff into the Mediterranean is taken to be
about 139.4~km$^3$/y (UNESCO 1969, van der Leeden 1975, Lacombe and
Richez 1981).  When calculating global fresh water transport, then, the
east coast Atlantic runoff value between 35 and 40\deg~N is the sum of
Mediterranean and Atlantic river runoff plus the transport from the
Black Sea: 361.4 km$^3$/y.  When calculating transport for the
Atlantic only, the Mediterranean is masked out.  The east coast runoff
into the Atlantic in the region, then, is the sum of the Atlantic river
runoff minus the transport from the Atlantic into the Mediterranean:
$-1678$~km$^3$/y.

The parameter error estimates for the fresh water fluxes are taken as follows
\bea
e_E &=& 20       \label{eq:fw_errors1}\% \\
e_P = e_R &=& 50 \label{eq:fw_errors2}\% \, .
\eea
The 20\% error estimate for evaporation is consistent with the value used
for latent heat flux in the previous section. The larger value for
error in the precipitation parameterization reflects the
great discrepancy among several estimates of oceanic precipitation.
Table~\ref{tab:cfw} shows the results of single-constraint
calculations imposing 0.06~Sv at 65\deg~S (Peixoto and Oort 1992),
$-0.03$~Sv at 25\deg~N (Hall and Bryden 1982), and a few others.
Each of the constraints causes an increase
in evaporation 
%%%%(consistent with the increase in latent heat flux in
%%%%the single-constraint solutions for heat flux) 
and a decrease in
precipitation and runoff.  However, the unconstrained fresh water
fluxes appear to be nearly in balance, as the corrections are quite small.

\begin{table*}[tp]
\caption[Parameters from the single-constraint adjustment of 
fresh water fluxes.]{Parameters from the single-constraint tuning of
fresh water fluxes. The meridional fresh water transport at 70\deg~N has been
specified as $-0.1$~Sv in the North Atlantic and 0~Sv in the North
Pacific (Aagaard and Greismann 1975). See text for details.}
\label{tab:cfw}
\begin{center}
\begin{tabular}{l|rrr|l}\hline
\mcol{1}{c}{Imposed} & \mcol{3}{c}{Tuning Parameters} & \mcol{1}{c}{Resulting} \\
\mcol{1}{c}{Constraint} & $p_E$ & $p_P$ & $p_R$ & \mcol{1}{c}{Transport}\\
\hline
0.06 Sv \@ 65\deg S Global & 1.00 & 0.98 & 1.00
& -0.12 Sv \@ 25\deg N Atlantic \\
0.5 Sv \@ 65\deg S Global & 1.01 & 0.95 & 0.99 
& -0.09 Sv \@ 25\deg N Atlantic \\
0.8 Sv \@ 65\deg S Global & 1.01 & 0.92 & 0.99
& -0.07 Sv \@ 25\deg N Atlantic \\
1. Sv \@ 65\deg S Global & 1.02 & 0.91 & 0.99
& -0.06 Sv \@ 25\deg N Atlantic \\
-0.03 Sv \@ 25\deg N Atlantic & 1.02 & 0.88 & 0.98
& 1.43 Sv \@ 65\deg S Global \\ \hline
\end{tabular}
\end{center}
\end{table*}



%..............................................................
\subsection{Consistent heat/fresh water flux tuning}
\label{sec:multiple_tuning}


The single-constraint calculations of the last sections do not take
into consideration the fact that evaporation and latent heat flux are
in essence the same physical process. The results of the
single-constraint heat flux tuning listed in Table~\ref{tab:chf}
suggest an increase of 15\% in latent heat flux, while the
single-constraint tuning of fresh water fluxes increases evaporation
by only a few percent.  This inconsistency can be removed if heat and
fresh water fluxes are tuned simultaneously.

The problem to be solved involves at least two constraints, one for
the meridional heat transport and the other for the meridional fresh
water transport.  Consistent with the single-constraint calculations,
we introduce the same non-dimensional tuning parameters of sections
\ref{sec:hf_tuning}--\ref{sec:fw_tuning}. However,
the parameters $p_L$ and $p_E$ for latent heat flux and evaporation
are now taken to be the same and denoted $p_{L,E}$.


\begin{table*}[tp]
\caption[Parameters from the simultaneous tuning of heat and 
fresh water fluxes.]{Parameters from the simultaneous tuning 
of heat and fresh water fluxes. Imposed constraints on the
meridional heat transport (H) and meridional fresh
water transport (F) listed in the first column, with 
resulting transports at 25\deg~N in the
Atlantic or 65\deg~S Global appearing in the last column. 
See text for details.}
\label{tab:multi}
\begin{center}
\begin{tabular}{l|rrrrrrrr|rr}\hline
\mcol{1}{c}{Imposed} & \mcol{8}{c}{Tuning Parameters} & \mcol{2}{c}{Resulting Transport}\\
\mcol{1}{c}{Constraints} & $p_{Tr}$ & $p_c$ & $p_e$ & $p_\chi$ & $p_{L,E}$ & $p_S$ &
$p_P$ & $p_R$ & 25\deg~N & 65\deg~S \\ \hline
(H) 0. PW \@ 65\deg S Global & 0.92 & 1.04 & 1.02 & 0.99 & 1.13 & 1.02
& 1.12 & 1.01 & 0.95 PW & \\
(F) 0.06 Sv \@ 65\deg S Global & & & & & & & & & -0.12 Sv & \\ \hline
(H) 0. PW \@ 65\deg S Global & 0.92 & 1.04 & 1.02 & 0.99 & 1.14 & 1.01
& 1.10 & 1.01 & 0.95 PW & \\
(F) 0.27 Sv \@ 65\deg S Global & & & & & & & & & -0.10 Sv & \\ \hline
(H) 0. PW \@ 65\deg S Global & 0.93 & 1.04 & 1.02 & 0.99 & 1.14 & 1.01
& 1.04 & 1.01 & 0.95 PW & \\
(F) -0.03 Sv \@ 25\deg N Atlantic & & & & & & & & & & 1.09 Sv\\ \hline
(H) 0. PW \@ 65\deg S Global & 0.92 & 1.04 & 1.02 & 0.99 & 1.14 & 1.01
& 1.09 & 1.01 & 0.95 PW & \\
(F) 0.5 Sv \@ 65\deg S Global & & & & & & & & & -0.09 Sv & \\ \hline
(H) 0. PW \@ 65\deg S Global & 0.93 & 1.04 & 1.02 & 0.99 & 1.14 & 1.01
& 1.05 & 1.00 & 0.95 PW & \\
(F) 1. Sv \@ 65\deg S Global & & & & & & & & & -0.06 Sv & \\ \hline
(H) 0. PW \@ 65\deg S Global & 0.93 & 1.04 & 1.02 & 0.99 & 1.15 & 1.01
& 1.01 & 1.00 & 0.95 PW & \\
(F) 1.5 Sv \@ 65\deg S Global & & & & & & & & & -0.02 Sv & \\
\hline
\end{tabular}
\end{center}
\end{table*}

Table~\ref{tab:multi} shows the results of several dual constraint
calculations using the error estimates
(\ref{eq:hf_errors1})--(\ref{hf_errors2}),
(\ref{eq:fw_errors1})--(\ref{eq:fw_errors2}), and northern boundary
conditions as in the single-constraint calculations of sections
\ref{sec:hf_tuning}--\ref{sec:fw_tuning}.  The first three fresh water
constraints applied at the southern boundary are taken from 
various sources: 0.06~Sv at 70\deg~S in
the Antarctic (Peixoto and Oort 1992), 0.27~Sv at 60\deg~S in the
Antarctic (Stommel 1980), and $-0.03$~Sv at 25\deg~N in the Atlantic
(Hall and Bryden 1982).  The other fresh water constraints are chosen
so that the Atlantic fresh water transport is between its
unconstrained value ($-0.14$~Sv) and 0.~Sv at 25\deg~N.
The Antarctic constraints are are assumed to be valid at 65\deg~S, the
southernmost climatologically ice-free latitude. The adjusted heat
flux parameters, overall, are consistent with the single-constraint
calculations presented in Table~\ref{tab:chf}, suggesting a decrease
in insolation and increase in evaporation.
In order to account for the increase in evaporation required by the
meridional heat transport measurements, the precipitation parameter
$p_P$ is now much larger than in the single-constraint calculations.


%..............................................................
\subsection{Constrained fluxes in UWM/ COADS}


%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure*}[tp]
\centerline{
\epsfxsize=6.5in
\epsfbox[60 260 565 565]{ps/connhf.ps} }
\caption[Constrained net heat flux]{Constrained annual mean net heat
flux over the global ocean (contour interval: 20 W/m$^2$). Heat flux 
is constrained so that the global meridional heat transport at the
southern boundary is zero and the fresh water transport at the southern
boundary is 0.06~Sv.}
\label{fig:connhf}
\end{figure*}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The individual heat flux components, evaporation and precipitation
provided in UWM/COADS are not tuned in any way. It is left to
the user to choose a particular set of tuning parameters most suitable
to the application at hand; section~\ref{sec:custom} discusses the
necessary steps to produce fine tuned fluxes. However, the net heat
flux, buoyancy flux, and evaporation minus precipitation
fields included in the data set\footnote{The
file names in Table~\ref{tab:vars} are {\tt netheat.nc, buoyancy.nc,} and
{\tt eminusp.nc}.} have been
constrained using the global balance requirement given in the
first row of Table~\ref{tab:multi}. Figure~\ref{fig:connhf} depicts
the annual mean {\em constrained} \ net heat flux included in UWM/COADS
which should be compared with the {\em unconstrained} \ net heat flux in 
Fig.~\ref{fig:unnhf}. As required by the requirement of zero transport
at 65\deg~S, the
constrained net heat flux now satisfies the consistency
condition (\ref{eq:qnet_consist}) when the ocean region between
65\deg~N and 65\deg~S is considered.  As we have neglected to tune
those regions poleward of 65\deg, an imbalance of $-0.05$~PW remains in
the constrained net heat flux when we consider the entire global ocean.

The corresponding constrained zonally integrated meridional 
heat transport for each ocean is shown in Fig.~\ref{fig:meridhf}, along
with several oceanographic measurements in the Atlantic.
In agreement with previous studies, our estimate produces a northward
transport throughout the Atlantic and a southward transport in the Indian
ocean.  Our estimate for the southward transport in the South Pacific is
somewhat smaller than previous estimates by Hsiung (1985) and
Hastenrath (1982). In the Atlantic our estimate is within the error
bars for Wunsch's (1984) determination at the equator and Hall and
Bryden's (1982) value at 25\deg~N. Our estimated Atlantic heat 
transport at 32\deg~N is
about half the value obtained by Rago and Rossby (1987) who admit their
estimate is rather large. In fact, imposing the Rago and Rossby (1987)
value as a single-constraint the solution of the inverse calculation
violates the consistency condition (\ref{eq:error_cond}). Similar
difficulties were reported by Isemer \etall~(1989).
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure}[htp]
\vspace{0.075in}
\centerline{
\epsfxsize=3.0in
\epsfbox[45 160 530 540]{ps/meridhf.ps} }
\caption[Constrained meridional heat transport]{Meridional heat
transport (1 PW = 10$^{15}$W)
calculated from constrained net heat flux. Heat flux is
constrained so that the global meridional heat transport at the
southern boundary is zero and the fresh water transport at the southern
boundary is 0.06~Sv. Three oceanographic ``measurements'' for
Atlantic heat transport are shown with error bars: (R) Rago and
Rossby [1987], (H) Hall and Bryden [1982], (W) Wunsch [1984].}
\label{fig:meridhf}
\end{figure}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The zonally integrated meridional fresh water transport is depicted in
Fig.~\ref{fig:meridfw} for each ocean. For the Atlantic, our estimate
is somewhat smaller than Schmitt \etall's~(1989) in the tropics, 
which is based on Bunker's (1976) estimate of evaporation.
At 25\deg~N our estimate gives a southward transport of $-0.12$~Sv which is
larger than Hall and Bryden's~(1982) value of $-0.03$~Sv, but
conceivably within their error bar.
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure}[htp]
\vspace{0.075in}
\centerline{
\epsfxsize=3.0in
\epsfbox[45 160 530 540]{ps/meridfw.ps} }
\caption[Constrained meridional fresh water transport]{Meridional
fresh water flux (in Sv)
calculated from constrained fresh water flux. Heat flux is
constrained as in the previous figure.
One oceanographic estimate for
Atlantic fresh water transport is shown: (H) Hall and Bryden [1982].}
\label{fig:meridfw}
\end{figure}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

While the results above suggest that our choice of tuning parameters
based on requirement of global balance (first row of
Table~\ref{tab:multi}) produces reasonable estimates of heat and fresh
water fluxes, it is important to keep in mind that this choice is very
likely non-optimal for specific applications. We strongly encourage
users to experiment with other choices of parameters.


%..............................................................
\subsection{Producing your own fine tuned fluxes}
\label{sec:custom}

The uncertainties in the parameter error covariance matrix $\bE$ and
the need to adjust the flux based on measurements for a particular
area will undoubtedly require users to produce their own fine
tuning of the heat and fresh water fluxes. To this end, we provide
users of UWM/COADS with {\em sensitivity fields} associated 
with each of the tuning parameters discussed in this section. 
For example, the net heat flux can be written as
\bea
\lefteqn{Q_{net}(p_{Tr}, p_c, p_e, p_\chi, p_L, p_S) = } \nonumber\\
& R_S(p_{Tr}, p_c) - R_L(p_e, p_\chi) - Q_L(p_L) - Q_S(p_S) \, .
\eea
The corresponding sensitivity fields are
\bea
\cA_{Tr} &=& \der{R_S}{p_{Tr}} = \der{Q_{net}}{p_{Tr}} = R_S^*\\
\cA_c &=& \der{R_S}{p_c} = \der{Q_{net}}{p_c} \nonumber \\
      &=& R_{\rm clear}(1-\alpha)(-0.62c)\\
\cA_e &=& \der{R_L}{p_e} = - \der{Q_{net}}{p_e}\nonumber \\
      &=&  - \epsilon \sigma T_s^4 p_e\(0.39-0.05
           \sqrt{e}\) \(1-\chi c^2\) \\
\cA_\chi &=& \der{R_L}{p_\chi} = - \der{Q_{net}}{p_\chi} \nonumber\\
         &=& \epsilon \sigma T_s^4 
              p_e\(0.39-0.05\sqrt{e}\) \(-\chi c^2\) \\
\cA_{L} &=& \der{Q_L}{p_{L,E}} = - \der{Q_{net}}{p_{L,E}} = Q_L^*\\
\cA_S &=& \der{Q_S}{p_S} = - \der{Q_{net}}{p_S} = Q_S^* \, .
\eea
The sensitivity fields $\cA_{Tr}$, $\cA_L$ and $\cA_S$ are equal to
$R_S^*$, $Q_L^*$ and $Q_S^*$ which are the full unconstrained fields 
already included in UWM/COADS. The other sensitivity fields are
computed either from individual observations with climatology and
anomalies analyzed the same way as the other UWM/COADS fields ($\cA_e$
and $\cA_\chi$), or derived from analyzed fields ($\cA_{c}$).

In order to produce constrained estimates of the individual heat flux
components, one can calculate
\bea
R_S &=& R_S^* + (p_{Tr} - 1 ) \cA_{Tr} + (p_c-1) \cA_c \nonumber \\
    &=& p_{Tr} R_S^* + (p_c-1) \cA_c \\
R_L &=& R_L^* + (p_e-1) \cA_e + (p_\chi-1) \cA_\chi \\
Q_L &=& p_{L,E} Q_L^* \\
Q_S &=& p_S Q_L^*
\eea
where $(\quad)^*$ denotes the unconstrained estimate of the heat flux
component as included in UWM/COADS. Likewise, constrained evaporation
and precipitation fields can be computed from
\bea
E &=& p_{L,E} E^* \\
P &=& p_P P^* \, .
\eea
The parameters in Tables \ref{tab:chf}--\ref{tab:multi} can be
used to produce several versions of the constrained heat and fresh
water fluxes. In addition, new values for the tuning parameters can be
obtained as follows. The sensitivity matrix $\bA$ can be computed by
integrating the sensitivity fields $\cA$ at a given latitude, e.g.,
\bea
A_{ji} &=& \int_{y_j}^{y_n} dy \int \der{Q_{net}}{p_\chi} \, dx\\ 
       &=& - \int_{y_j}^{y_n} dy \int \cA_\chi \, dx
\eea
(assuming $p_\chi$ is the $i$th parameter).  The new tuning parameters
can be obtained by solving (\ref{eq:multiple}), given estimates for
the parameter error covariance matrix $E$ and oceanographic
measurements $\cHd(y_j)$ with error covariance matrix $R$.







%..........end fine tuning, begin figures shown in this atlas...........

%................................. NOT 1 ...........................


%%........ no results ....


%.................................................................

%..............end figures shown in this atlas, begin fwb.........

%................................. 1 ....................


%%\input{sampling}

\section{Assessing sampling errors in the analyzed data products}
\label{sec:fwb}

In addition to instrument errors and uncertainty in the physical
parameterizations, surface marine data sets are affected by the
inhomogeneous, and in some areas inadequate, spatial and temporal
data coverage over the oceans. As an example, Fig.~\ref{fig:dnobs}
presents the density $\eta$ of wind observations for December 1949 and
December 1989. The density of observations $\eta$ is defined as the mean
number of observations per month per 1\deg $\times$ 1\deg \ box.  Ship
observations are concentrated along well traveled ship lanes, with the
maximum coverage at the coastal areas of the northern oceans.  In
winter, very few observations are available over the ice-covered
Arctic oceans. The data coverage for December/49 is characteristic of
the early decades in which large areas of the tropics and southern
oceans are completely void of data; even most of the North Pacific
boxes have fewer than 2 observations per month.
Although surface marine data coverage has improved in the last decades
(Fig.~\ref{fig:dnobs}b), coverage in parts of the tropics and southern
oceans is still sparse.

In addition to the limited extent of ship traffic, modern day merchant
ships adapt
their route depending on currents, wave, and weather conditions.
Favorable waves and winds can add several knots to the speed of a
large ship, conserving fuel and cutting transport time by hours or
days (Chesneau 1994).  If ships of the Volunteer Observing Fleet
regularly avoid stormy weather, the so-called {\em fair weather bias}
(FWB) probably exists in COADS.  The purpose of this section is to
document the effect of sampling errors and fair weather bias 
in our analyzed data products.

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure*}[tp]
\centerline{
\epsfxsize=6.5in
\epsfbox[85 190 422 612]{ps/dnobs.ps} }
\caption[Density of wind speed observations for a) December/49 and b)
December/89.]{Density of wind speed observations for a) December 1949 and
b) December 1989.  The density of observations $\eta$ is defined as the
mean number of observations per month per 1\deg $\times$ 1\deg \ box.
The size of each black square is related to the average value of $\eta$ in
each 5\deg~box (see scale on top of panels).}
\label{fig:dnobs}
\end{figure*}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

There have been a number of studies addressing the question of how
many observations are necessary to define reliable monthly statistics.
In a study comparing monthly means between Ocean Weather Station (OWS)
data and merchant ship data in the North Atlantic and Pacific, Ramage
(1986) computed correlations between OWS mean values and those found
from ship data taken in 2\deg\ boxes surrounding the Ocean Weather
Station.  Correlations were fairly high (83--97\%) for both SST and
air temperature when fewer than 10 ship observations per month were
considered.  Merchant ship wind speed, however, did not show high
correlations with OWS wind speed until more than 20 ship observations
per month were used. Luther and Harrison (1984), analyzing tropical
Pacific island data, suggest that at least 32 observations are
necessary to accurately represent month-to-month fluctuations in zonal
pseudo wind stress.  Fissel \etall~(1977), analyzing OWS P surface
reports, suggest that at least 15 observations per month are necessary
to obtain reliable estimates of monthly mean wind stress.  While these
results are relevant for determining sample criteria for the local
marine climate, they cannot be directly applied to assess the
reliability of objectively analyzed surface marine data sets, as we
explain next.

The analyzed fields in UWM/COADS are produced in two steps. First,
1-degree box means are formed.  These box means are then
objectively analyzed. This objective analysis is produced by
successively including data in the neighborhood of a grid point.  In
addition to the obvious effect of smoothing, this averaging of nearby
data serves to overcome some of the sampling problems, averaging
out random errors present in the means of each individual 1-degree
box.  The monthly averaging of data on 1-degree boxes is used
primarily as a data reduction step prior to the objective analysis. In
this sense, each 1-degree box mean acts as a {\em super-observation},
a concept frequently used in operational atmospheric data assimilation
(e.g., Lorenc~1986).  Therefore, the statistical properties of the
analyzed data on a 1-degree grid depends not only on the errors of the
1-degree boxes, but equally on the radius of influence and weights
used to produce the analysis.

Our goal is to assess the magnitude of sampling errors on our
objectively analyzed data products. By ``sampling errors'' we mean the
uncertainty in our monthly mean climatology and anomalies that are
caused by the sparse data coverage characteristic of COADS.  Our
approach consists of using analyzed ECMWF twice daily data as a
surrogate for the marine atmosphere.  We simulate COADS data coverage
by deleting observations in the ECMWF data set which have no
counterpart in COADS.  By comparing the objectively analyzed monthly
means based on this reduced, COADS-like data set with the monthly
means based on the full ECMWF data set, we assess the effects of
sampling on different parts of the world oceans. Please take note that we
do not compare our COADS based analysis to ECMWF's analysis.
Discrepancies found in such a comparison would be due to factors
such as different raw data, quality control and method of analysis.
Isolating the effects of sampling would not be possible. A
comparison of our surface marine data set with those derived by
other authors will be presented elsewhere.

We begin by describing our data source and method of analysis in
section~\ref{sec:fwb_method}, followed by a discussion of sampling
errors and fair weather bias in the 1980's. Sampling errors in
previous decades are examined in section~\ref{sec:fwb_decades}.
Results are summarized in section~\ref{sec:fwb_summary}.

%..................................................................
\subsection{Data source and method of analysis}
\label{sec:fwb_method}

The European Center for Medium-Range Weather Forecasting (ECMWF)
twice-daily analyses of 1000~hPa winds and surface air temperature
(SAT) for the period 1980-87 are used as a surrogate for surface
marine data. The original ECMWF analyses are interpolated from their
2.5\deg $\times$ 2.5\deg\ grid to the same 1\deg $\times$
1\deg\ UWM/COADS grid.  Each twice-daily interpolated value is
considered to be an individual observation.  Raw monthly means are computed by
sampling this ECMWF data in three different ways:

\begin{description}

\item[Full sampling:] all the available data are included to compute
our best estimate of the monthly means in each 1\deg\ box.

\item[Ship-based sampling:] only includes data for which at least one ship
observation was made in the 12 hour period within the boundaries of
the 1\deg~box. This sampling method is intended to closely simulate
COADS data coverage, and should reflect ship fair weather bias.

\item[Random sampling:] the total number of observations $p$ for each
month in each 1\deg\ box is first recorded based on the actual COADS
data availability. Subsequently, the same number $p$ of observations
are randomly drawn from each 1\deg\ box in that month. This sampling
method uses the same number of observations to compute monthly means
as does the ship-based sampling method above, but by construction it is
{\em unbiased}. By comparing results from ship-based and random sampling one
can obtain an estimate of the effects of the fair weather bias.

\end{description}

Let us denote by $W_E\in\Re^n$ the ``observations'' based on the
interpolated ECMWF analysis for wind speed, for example. The number of
grid-points is denoted by n.  The analyses based on ship-based and
random sampling are given by
\bea
W_\ship = \cB(\overline{W_E}^\ship)\\
W_\rand = \cB(\overline{W_E}^\rand)
\eea
where $\overline{(\ )}^\ship$ and $\overline{(\ )}^\rand$  denote the
time-average with the ship-based and the random sampling methods;
$\cB$ stands for the objective analysis with the Barnes'
weighting function described in section~\ref{sec:analysis}.
Because of the smoothing introduced by the successive correction
scheme, the estimates $W_\ship$/$W_\rand$ only resolve scales larger than
approximately 770~km. In order to estimate error at these scales we
define the {\em ground truth} as 
\be
W_t = \cB(\overline{W_E}) \label{eq:gt}
\ee
where $\overline{(\,)}$ denotes the time-average with full sampling.
Gridded error fields are now defined in terms of $W_t$,
\be
\eps_\ship^2 = \( W_\ship - W_t \)^2, \qquad 
\eps_\rand^2 = \( W_\rand - W_t \)^2
\ee
Notice that we are ignoring observational errors, both in the form of
instrument errors and errors of {\em representativeness} (Daley 1991).
The discussion below will be centered on spatially averaged
root-mean-square errors, e.g., $RMSE_\ship = \sqrt{\langle
\eps_\ship^2\rangle}$, where
\be
\< \eps_\ship^2 \> = { \int\int_{\rm ocean} \eps_\ship^2 \cos\phi 
\, d\lambda\,d\phi \over \int\int_{\rm ocean} \cos\phi \, d\lambda\,d\phi}
\ee
In order to quantify the effects of fair weather bias in the analyzed
fields, we define
\be
\< \eps_\fwb^2 \> \equiv \< \eps_\ship^2 \> - \< \eps_\rand^2 \> \, .
\label{eq:fwb}
\ee
The plausibility of this heuristic definition follows from the fact
that the random sampling, as defined above, is not affected by the
current weather conditions. Implicit in the definition (\ref{eq:fwb})
is the assumption that sampling errors and errors associated with the
fair weather bias are statistically independent. We note, however,
that certain regions of the oceans could be systematically
undersampled due to climatologically stormy conditions.  In addition,
by nature, the observations generated with the random sampling method
are less serially correlated than observations based on the ship-based
method (which are usually taken by the same ship with a 12 hour time
interval). In the absence of any fair weather bias, $\<\eps_\ship^2\>$
would be larger than $\<\eps_\rand^2\>$ because of the higher
correlation of the observations used to computed the box mean 
with the ship-based sampling method. Thus, $\<\eps_\fwb^2\>$
is expected to overestimate the error variance associated with
the re-routing of ships to avoid stormy weather.

The following sections present averages for several ocean basins
defined as follows. The North Atlantic and North Pacific are limited
by the equator and 60\deg~N.  The South Atlantic and South Pacific are
bounded by the equator and 40\deg~S.  The Indian ocean includes those
grid-points north of 40\deg~S and between 20\deg~E and 140\deg~E
including the Red Sea, Persian Gulf, and those regions south of the
equator in the Indonesian Archipelago.  The Southern Oceans are all
ocean grid points south of 40\deg~S.  In all cases, grid-points
climatologically covered by sea-ice have been excluded from the
error averaging process. In this section climatology and anomaly are defined
in the following way.
The climatology for each month is computed as 8 year averages for the
period 1980-87; monthly anomalies are analyzed departures from the 8
year climatology.  Note that the climatology in UWM/COADS has a larger
sample size since it is computed using 45 years of data.  Thus,
sampling errors reported here are likely overestimates for sampling
errors in UWM/COADS.

%..................................................................
\subsection{Sampling errors in the 1980's}
\label{sec:fwb_1980}

In order to illustrate the effects of the objective analysis on the
large scale fields, Fig.~\ref{fig:biascbx} depicts the zonally averaged
wind speed for full sampling (solid line), ship-based sampling
(dash-dot line) and random sampling (dashed line) methods, with and
without objective analysis, for the period 1980--87. The zonally
averaged wind speed estimated with the full sampling method is largely
insensitive to the objective analysis, except for some details in
January in the northern hemisphere: a double jet around 50\deg N is
apparent in the zonal means of objectively analyzed wind speed
(Fig.~\ref{fig:biascbx}b), but has no counterpart in the zonal means
of the raw field (Fig.~\ref{fig:biascbx}a). The zonal means of the
undersampled fields (dashed and dash-dot lines) are positively
impacted by the objective analysis over most of the globe, except at
the southern most latitudes in July where noise is still present.  The
noise level in the raw fields computed with ship-based and random
sampling methods is considerably  more severe on a regional basis than
suggested by the zonal averages in Fig.~\ref{fig:biascbx}.
The objectively analyzed fields, however, have a degree
of smoothness 
comparable to the fully sampled fields over most of the
globe\footnote{Consult Volumes 2 through 5 of this Atlas series for
contour plots of the UWM/COADS fields.}. In the remainder of this
section, we will concentrate on average characteristics of the
sampling errors as defined in section~\ref{sec:fwb_method}.

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure*}[tp]
\centerline{
\epsfxsize=6.5in
\epsfbox[20 10 555 570]{ps/biascbx.ps} }
\caption[Zonally averaged wind speeds estimated with full, ship-based, 
and random sampling methods]{Zonally averaged monthly mean wind speed
computed with full (solid line), ship-based (dash-dot line), and
random (dashed line) sampling of twice-daily ECMWF 1000~hPa winds: a)
zonal averages of raw field for January 1980--87, b) zonal averages of
analyzed field for January 1980--87, c) zonal averages of raw field 
for July 1980--87,
and d) zonal averages of analyzed field for July 1980--87. See text for
details.}
\label{fig:biascbx}
\end{figure*}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The globally averaged RMSEs for monthly mean anomalies and climatology
computed with the ship-based sampling method are shown in
Fig.~\ref{fig:biasglo} for both surface wind speed and surface air
temperature. In general, sampling errors tend to be larger in the
winter months in both northern and southern hemispheres (not shown).
The maximum in austral winter for the global mean, depicted in
Fig.~\ref{fig:biasglo}, reflects the larger errors in the southern oceans
in that season. RMSEs of climatologies are about 55\% (65\%)
those of the wind speed (air temperature) anomalies. Similar
calculations based on the random sampling method are shown in
Fig.~\ref{fig:sbiasglo}. The seasonal evolution of the climatology and
anomalies for the two sampling methods are remarkably close, with the
amplitude of the RMSEs based on random sampling method being about
85\% the amplitude of the RMSEs based on the ship-based sampling
method.  The globally averaged RMSEs associated with the
fair weather
bias (Fig.~\ref{fig:fwbglo}) have a somewhat irregular seasonal cycle, with
amplitudes about 60\% of the amplitude of the RMSEs based on the
random sampling method. 
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure*}[tp]
\centerline{ 
\epsfysize=8.5in 
\epsfbox[20 50 445 740]{ps/biasglo.ps} }
\caption[Globally averaged RMSE for monthly mean
climatology and anomalies computed with {\em ship-based} sampling
method for 1980-87]{Globally averaged root-mean-square errors for monthly
mean climatology and anomalies computed with the {\em ship-based} sampling
method for 1980-87: a) wind speed climatology (m/s), b) wind speed
anomalies (m/s), c) surface air temperature climatology (\deg C), and
d) surface air temperature anomalies (\deg C).}
\label{fig:biasglo}
\end{figure*}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure*}[tp]
\centerline{
\epsfysize=8.5in
\epsfbox[20 50 445 740]{ps/sbiasglo.ps} }
\caption{Same as in Fig.~\ref{fig:biasglo} but showing RMSE 
computed with the {\em random}
sampling method.}
\label{fig:sbiasglo}
\end{figure*}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure*}[tp]
\centerline{
\epsfysize=8.5in
\epsfbox[20 50 445 740]{ps/fwb.ps} }
\caption{Same as in Fig.~\ref{fig:biasglo} but showing fair weather
bias RMSE.} 
\label{fig:fwbglo}
\end{figure*}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The distribution of annual mean RMSEs for individual ocean basins in
1980-87 is shown in Tables~\ref{tab:tbias}--\ref{tab:fwb}.  In
general, RMSEs for the northern oceans are about 50\% (60\%) the
global mean RMSE for wind speed (air temperature). The RMSEs in the
tropics are slightly larger than in the northern oceans, and slightly
smaller than RMSEs in the Indian and South Atlantic oceans; larger
errors are found in the South Pacific and oceans south of 40\deg S.
Except for the southern oceans, the fair weather bias RMSEs
(Table~\ref{tab:fwb}) are relatively uniform across the oceans.  

%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean RMSE for wind speed and SAT computed with
ship-based sampling method, 1980--87]{Annual mean of root-mean-square
error for monthly climatology and anomalies of wind speed (m/s) and
surface air temperature (\deg~C) computed with {\em ship-based}
sampling method.  Period: 1980-87.}

\label{tab:tbias}
\begin{center}
\begin{tabular}{ccccc}\hline 
 & \multicolumn{2}{c}{Wind Speed} &
 \multicolumn{2}{c}{Air Temperature} \\ \cline{2-5}
Ocean   & Clim. & Anom. & Clim. & Anom. \\ \hline
N. Atl. & 0.22 & 0.40 & 0.22 & 0.29 \\
N. Pac. & 0.27 & 0.51 & 0.21 & 0.31 \\
Tropics & 0.29 & 0.56 & 0.22 & 0.33 \\
Indian  & 0.33 & 0.67 & 0.25 & 0.38 \\
S. Atl. & 0.36 & 0.73 & 0.27 & 0.48 \\
S. Pac. & 0.50 & 0.98 & 0.33 & 0.58 \\
S. Oc.  & 1.09 & 1.77 & 0.71 & 1.07 \\
Global  & 0.53 & 0.94 & 0.37 & 0.57 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________


%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean RMSE for wind speed and SAT computed with
random sampling method, 1980--87]{Annual mean of root-mean-square
error for monthly climatology and anomalies of wind speed (m/s) and
surface air temperature (\deg~C) computed with {\em random} sampling
method.  Period: 1980-87.}

\label{tab:rbias}
\begin{center}
\begin{tabular}{ccccc}\hline
& \multicolumn{2}{c}{Wind Speed} &
 \multicolumn{2}{c}{Air Temperature} \\ \cline{2-5}
Ocean      & Clim. & Anom. & Clim. & Anom. \\ \hline
N. Atl. & 0.18 & 0.34 & 0.19 & 0.25 \\
N. Pac. & 0.24 & 0.45 & 0.19 & 0.27 \\
Tropics & 0.26 & 0.48 & 0.20 & 0.28 \\
Indian  & 0.31 & 0.59 & 0.24 & 0.33 \\
S. Atl. & 0.30 & 0.59 & 0.22 & 0.37 \\
S. Pac. & 0.42 & 0.89 & 0.28 & 0.51 \\
S. Oc.  & 0.89 & 1.55 & 0.66 & 0.91 \\
Global  & 0.44 & 0.82 & 0.34 & 0.49 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________



%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean fair weather bias RMSE 
for wind speed and SAT, 1980--87]{Annual mean of fair weather bias
root-mean-square error (eq.~\ref{eq:fwb}) for monthly climatology and
anomalies of wind speed (m/s) and surface air temperature (\deg~C).
Period: 1980-87.}

\label{tab:fwb}
\begin{center}
\begin{tabular}{ccccc}\hline
 & \multicolumn{2}{c}{Wind Speed} &
 \multicolumn{2}{c}{Air Temperature} \\ \cline{2-5}
Ocean      & Clim. & Anom. & Clim. & Anom. \\ \hline
N. Atl. & 0.13 & 0.20 & 0.11 & 0.15 \\
N. Pac. & 0.13 & 0.24 & 0.08 & 0.14 \\
Tropics & 0.12 & 0.28 & 0.09 & 0.16 \\
Indian  & 0.11 & 0.31 & 0.08 & 0.18 \\
S. Atl. & 0.19 & 0.42 & 0.15 & 0.29 \\
S. Pac. & 0.27 & 0.46 & 0.17 & 0.28 \\
S. Oc.  & 0.64 & 0.94 & 0.29 & 0.60 \\
Global  & 0.26 & 0.45 & 0.16 & 0.29 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________


While the RMSEs measure the average point-wise errors in the
undersampled fields, the spatial correlation of fields measure the
agreement of the spatial patterns. Spatial correlations between the
climatological ground truth (eq.~\ref{eq:gt}) and climatologies based on
the ship-based and random sampling methods (not shown) are very high;
only in southern oceans are correlations less than 90\%.  Anomaly
spatial correlations between the ground truth and the analysis with
the ship-based sampling method are listed in Table~\ref{tab:corr8} for
wind speed, pseudo-wind stress and air temperature.  Anomaly
correlations for pseudo-wind stress are generally smaller than for
wind speed (the exception is in the tropics), indicating that sampling
errors have a larger effect on nonlinear quantities. Surface air
temperature, however, has anomaly correlations larger than wind
speed, a consequence of the more steady character of SAT in the open
oceans.  Notice that the ranking of the individual oceans according to
RMSEs or anomaly correlations are the same: undersampled analyses
are more accurate in the northern oceans, followed by tropical and Indian
oceans, with less reliable analyses in the southern oceans. Such
conclusions are consistent with the data density distribution depicted
in Fig.~\ref{fig:dnobs}.

%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean anomaly correlation between full sampling and
ship-based sampling analysis, 1980-87]{Annual mean anomaly correlation
between full sampling and ship-based sampling analysis of wind speed,
pseudo-wind stress, and air temperature (\%), 1980--87.}

\label{tab:corr8}
\begin{center}
\begin{tabular}{cccc}\hline
Ocean & Wind & P-stress & SAT \\ \hline
N. Atl. & 90     & 85       & 94 \\
N. Pac. & 85     & 83       & 93 \\
Tropics & 81     & 81       & 89 \\
Indian  & 76     & 69       & 86 \\
S. Atl. & 66     & 58       & 83 \\
S. Pac. & 61     & 54       & 76 \\
S. Oc.  & 35     & 29       & 55 \\
Global  & 66     & 57       & 82 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________


%..................................................................
\subsection{Sampling errors in previous decades}
\label{sec:fwb_decades}

The ship-based sampling method used to assess the reliability of the
analyses can only be applied with a surrogate data set valid during the
same time period. Currently, global operational analyses are not available
prior to the mid-1970's, although several reanalysis projects are
underway to produce multi-decade global data sets. The random
sampling method, however, only requires the number of observations in
each 1\deg~box, with data randomly sampled from any synoptic time
within the month. Therefore, the random sampling method is easily
extended to other decades: the 1980--87 ECMWF twice daily analysis is
sampled according to COADS data distribution in previous decades. As
discussed earlier, RMSEs based on the random sampling method share
many of the characteristics of RMSEs calculated with the ship-based
method, albeit at a smaller magnitude.  With this caveat, the random
sampling method is used next to assess the reliability of the analyzed
anomalies in the period 1950--87.

The annual mean RMSEs for anomalies of wind speed and air temperature
for several periods during 1950-87 are listed in
Tables~\ref{tab:drmse_w}--\ref{tab:drmse_sat} for each ocean.  The
annual mean RMSEs for wind speed anomalies are relatively uniform in
the periods during 1960-87 for most oceans, with a sharp increase in the
1950's.  The RMSEs for surface air temperature, however, show an
almost monotonic decrease in time throughout the period. In the
tropics and northern oceans the annual mean RMSEs are less
than 0.5~m/s (0.32\deg~C) for wind speed (air temperature) in the last
3 decades.
%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean RMSE for wind speed computed with
random sampling method, 50's, 60's, 70's and 80's]{Annual mean of
root-mean-square error for monthly anomalies of wind speed
(m/s) computed with {\em random} sampling method
in four different periods.}

\label{tab:drmse_w}
\begin{center}
\begin{tabular}{ccccc}\hline
      & \multicolumn{4}{c}{Period} \\ \cline{2-5}
Ocean & 1950--57 & 1960--67 & 1970--77 & 1980--87 \\ \hline
N. Atl. & 0.42   & 0.36     & 0.33     & 0.34 \\
N. Pac. & 0.74   & 0.49     & 0.41     & 0.45 \\
Tropics & 0.74   & 0.47     & 0.45     & 0.48 \\
Indian  & 0.85   & 0.71     & 0.60     & 0.60 \\
S. Atl. & 0.99   & 0.77     & 0.86     & 0.59 \\
S. Pac. & 1.17   & 0.79     & 0.86     & 0.88 \\
S. Oc.  & 1.97   & 1.69     & 1.86     & 1.54 \\
Global  & 1.12   & 0.88     & 0.92     & 0.82 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________



%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean RMSE for surface air temperature computed with
random sampling method, 50's, 60's, 70's and 80's]{Annual mean of
root-mean-square
error for monthly anomalies of surface air temperature (\deg~C)
computed with {\em random} sampling method in four different periods.}

\label{tab:drmse_sat}
\begin{center}
\begin{tabular}{ccccc}\hline
      & \multicolumn{4}{c}{Period} \\ \cline{2-5}
Ocean & 1950--57 & 1960--67 & 1970--77 & 1980--87 \\ \hline
N. Atl. & 0.32   & 0.29     & 0.26     & 0.19 \\
N. Pac. & 0.48   & 0.32     & 0.26     & 0.19 \\
Tropics & 0.47   & 0.30     & 0.26     & 0.20 \\
Indian  & 0.50   & 0.40     & 0.36     & 0.24 \\
S. Atl. & 0.63   & 0.51     & 0.54     & 0.22 \\
S. Pac. & 0.73   & 0.48     & 0.51     & 0.28 \\
S. Oc.  & 1.29   & 1.10     & 1.19     & 0.66 \\
Global  & 0.72   & 0.57     & 0.58     & 0.34 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________

The annual mean anomaly correlation of wind speed, pseudo-wind stress
and surface air temperature are presented in
Tables~\ref{tab:wcorr}--\ref{tab:acorr} for several periods during 1950-87. For
the tropics and northern oceans, anomaly correlations are greater than
90\% (85\%) for air temperature (wind speed) in the last 3 decades.
As noted earlier, anomaly correlations for pseudo-wind stress are less
than for wind-speed for most of the oceans, except in the tropics
where they comparable.

%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean anomaly correlation between full sampling and
random sampling analysis of wind speed, 50's, 60's, 70's and
80's]{Annual mean anomaly
correlation between full sampling and random sampling analysis of
wind speed (\%) in four different periods.}

\label{tab:wcorr}
\begin{center}
\begin{tabular}{ccccc}\hline
      & \multicolumn{4}{c}{Period} \\ \cline{2-5}
Ocean & 1950--57 & 1960--67 & 1970--77 & 1980--87 \\ \hline
N. Atl. & 90     & 92       & 93       & 93 \\
N. Pac. & 74     & 86       & 90       & 88 \\
Tropics & 70     & 85       & 87       & 85 \\
Indian  & 66     & 74       & 80       & 80 \\
S. Atl. & 53     & 65       & 61       & 75 \\
S. Pac. & 49     & 69       & 67       & 66 \\
S. Oc.  & 19     & 30       & 32       & 43 \\
Global  & 55     & 67       & 67       & 72 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________


%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean anomaly correlation between full sampling and
random sampling analysis of pseudo-wind stress, 50's, 60's, 70's and
80's]{Annual mean anomaly correlation between full sampling and
random sampling analysis of pseudo-wind stress (\%) in four different
periods.}


\label{tab:pcorr}
\begin{center}
\begin{tabular}{ccccc}\hline
      & \multicolumn{4}{c}{Period} \\ \cline{2-5}
Ocean & 1950--57 & 1960--67 & 1970--77 & 1980--87 \\ \hline
N. Atl. & 85     & 89       & 90       & 87 \\
N. Pac. & 67     & 81       & 86       & 85 \\
Tropics & 71     & 86       & 86       & 85 \\
Indian  & 58     & 68       & 73       & 72 \\
S. Atl. & 47     & 58       & 56       & 66 \\
S. Pac. & 44     & 65       & 62       & 60 \\
S. Oc.  & 12     & 26       & 26       & 33 \\
Global  & 45     & 59       & 58       & 61 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________


%_______________________________________________________________
\begin{table}[htp]

\caption[Annual mean anomaly correlation between full sampling and
random sampling analysis of SAT, 50's, 60's, 70's and 80's]{Annual mean anomaly
correlation between full sampling and random sampling analysis of
surface air temperature (\%) in four different periods.}

\label{tab:acorr}
\begin{center}
\begin{tabular}{ccccc}\hline
      & \multicolumn{4}{c}{Period} \\ \cline{2-5}
Ocean & 1950--57 & 1960--67 & 1970--77 & 1980--87 \\ \hline
N. Atl. & 93     & 94       & 95       & 95 \\
N. Pac. & 84     & 92       & 95       & 95 \\
Tropics & 80     & 91       & 92       & 92 \\
Indian  & 78     & 84       & 87       & 89 \\
S. Atl. & 72     & 80       & 78       & 89 \\
S. Pac. & 65     & 82       & 80       & 80 \\
S. Oc.  & 36     & 46       & 47       & 63 \\
Global  & 72     & 81       & 81       & 86 \\ \hline
\end{tabular}
\end{center}
\end{table}
%_______________________________________________________________


%..................................................................
\subsection{Summary}
\label{sec:fwb_summary}

We have presented an analysis of sampling errors in UWM/COADS by
simulating COADS data distribution in a surrogate data set
constructed from ECMWF 1000~hPa analysis. The results presented here
do not take into consideration instrument and representativeness errors
which are certainly present in surface marine reports. The average
values presented in the tables should be increased according to one's
best estimate of these errors.  Although our results do not require
the ECMWF analysis to be a {\em perfect} representation of the marine
atmosphere, it is implicitly assumed that the ECMWF analysis
realistically represents the variability of atmospheric parameters at
the ocean surface.  A comparison with similar calculations based on
analyses by other centers would be helpful to test the sensitivity
of our estimates.

Root-mean-square errors and anomaly correlations for each ocean basin
are summarized in Tables~\ref{tab:tbias}--\ref{tab:acorr}. As can be
anticipated from plots of the observation density (e.g.,
Fig.~\ref{fig:dnobs}, see also Young \etall~1993), both analyzed
climatology and anomalies are more reliable in the northern oceans,
followed by the tropical and Indian oceans.  The reliability of the
analyses in the southern oceans (south of 40\deg~S) are questionable,
except perhaps in austral summer, and in the 1980's with the
deployment of drifting buoys around 50\deg~S. The South Atlantic and South
Pacific oceans (between the equator and 40\deg~S) are marginally
reliable in the later decades. No results have been presented for the
Arctic ocean or any other region climatologically covered by ice.
COADS observations in ice-covered regions are practically non-existent.





%..................begin limitations.........................

\section{Limitations and shortcomings of the data sets}

A description of surface marine data sets could not be complete
without a discussion of the remaining problems and limitations for
which solutions may never be found.  Because ship reports are probably
the only comprehensive observational record available of the surface
marine climate, this data
source will undoubtedly continue to be used in studies of the
ocean-atmosphere system.  As large uncertainties are present, it is
imperative that researchers remember that an analysis of surface marine
data is an evolving process. Continual improvement will be necessary as
more data or metadata become available, physical parameterizations are
improved, and advances in data assimilation techniques become
available.  The corrections we have reported here are, at best, a step in
the right direction, but much remains to be done. In the remainder
of this section, we discuss some of the remaining problems. This list is by
no means exhaustive.

The first, and most uncontrollable, errors exist in the ship reports
themselves.  Marine and atmospheric measurement techniques and the
recording of these observations are not perfect.  Some errors are
introduced through poor instrumentation.  Surface air temperature can
be biased due to heating of a ship's superstructure during the day and
inadequate shelter ventilation (Isemer and Hasse 1987; Ramage 1984;
Kent \etall\ 1993a,b).  Sea surface temperature observations taken
via ship intake will be biased compared to those taken by
insulated bucket or hull sensors.

Many of the biases are impossible to correct due to the lack of
instrumentation information as discussed in section 3.  A proper
homogenization of the measured wind speeds requires the knowledge of
the precise anemometer height information which is not included in
COADS/CMR-5 at the present time; an average anemometer height of 20~m
has been assumed in our calculations. In addition, the flag WI in
COADS/CMR-5, which allows the discrimination between measured and
estimated winds, is not reliable (Slutz \etall \ 1985,
Cardone \etall \ 1990). Our wind speed bias correction procedure takes
the WI flag at face value and consequently is affected by this
uncertainty. Any systematic bias in the anemometer winds remains to be
evaluated. 


Even when an observation is considered accurate and unbiased, the
recording stage may result in errors (Slutz \etall \ 1985).  Some
observations are taken in different units (such as Fahrenheit vs.\
Celsius) without documentation.  Coding practices change
but are not implemented by all observers on the same date.  Ship
positions may be erroneous.  The transfer of written records to
digital form can also introduce error.  
Some recording errors
were repaired by the compilers of COADS, but some miscoded errors
undoubtedly remain.
The tendency for ships to avoid stormy weather also
introduces a fair weather bias into the observations when considered
as a whole, although this bias is less problematic in the
tropics.


After we deal with the correctable biases and calculate raw fields,
error can be introduced by the analysis scheme as well.
One problem with the successive correction method used in our analysis
is the introduction of unrealistic features (Levitus
1982).  Objective
analysis of the sort used here fills in the gaps by
interpolating/extrapolating smoothed data from remote regions, but
cannot compensate entirely for poor sampling.  
This effect is particularly troublesome in the tropics and
southern oceans where observations are clumped along ship tracks with
data void areas in between. As a result, bull's eye type features
often remain in analyzed fields, particularly in anomaly fields.

The analysis of anomaly values rather
than the observed data can result in spurious extrema. For example,
the analysis has problems handling positive definite quantities such
as fractional cloud cover which only take values between 0 and 1. The
analysis procedure can produce full field values (climatology plus
anomalies) less than 0 in broad clear areas or values greater than 1
in broad overcast regions.  The climatology fields in the data set
have been corrected so that positive definite quantities (cloudiness,
relative and specific humidity, vapor pressure, precipitation, etc.)
have a minimum value of zero.
Maximum limits have not been applied to the climatology, however, nor
have the full field values been corrected to their valid ranges.  The
only additional correction made to the anomaly fields was to force the
45-year mean monthly anomaly to equal zero at each grid point.

It should always be kept in mind that although the analyzed fields are
given on a \one\ grid, only features with wavelength greater than
770~km (1300~km or greater for regions below 40\deg S and for
standard deviation fields) are retained. The reader is referred to
Levitus (1982) or Daley (1991) for additional discussions of the
limitations of the objective analysis technique. A higher resolution
climatological analysis has been performed on a half-degree by
half-degree grid where features with wavelength greater than 386 km
are retained. These results will be presented elsewhere.

In contrast to our analysis method, modern
data assimilation techniques are assisted by some sort of dynamic
constraint: a model is used to provide a first guess for the analysis
or to ensure a proper balance of the analyzed fields (Daley 1991).  In
this first version of our analysis, we concentrated on bias
corrections and calculations from individual observations, using a
successive correction method to grid the data.  Current four
dimensional atmospheric reanalysis efforts (Schubert \etall \ 1993;
Kalnay and Jenne 1991; Bengtsson and Shukla 1988) will provide several
estimates of surface marine fields which would prove useful to
validate and assess the limitations of our approach. 
We are also making available the raw, unanalyzed fields
to allow researchers to develop their own objective analyses/data
assimilation system from the monthly mean data.

%.................................................................
\section{Summary and plans for future work}

We have described the results of a collaborative project between the
Department of Geosciences of the University of Wisconsin-Milwaukee and
the National Oceanographic Data Center to produce high resolution
analyses of surface marine fields for climate variability studies.
Our work is based on individual surface marine reports prepared by the
COADS project (Slutz \etall \ 1985). We have corrected wind speed and
cloudiness biases in the original COADS reports and produced monthly
means and other statistics on 1\deg\ boxes over the global oceans.
Although we have attempted to create objectively analyzed fields that
can be used as is, we have documented several
shortcomings and limitations of the data sets which we hope will be
taken into consideration by the careful researcher.  Analyzed fields of
this sort are estimates of the {\em true} surface marine climate, and we
hope to improve these estimates by inclusion of additional
data/metadata and overall improvements in our analysis system.

An immediate improvement concerns the use of
COADS Release 1A (COADS/1A) which was not available at the time of this
calculation. For the 1980's, our analysis is based on the so-called
{\em interim} product.  COADS/1A includes several delayed ship and
buoy sources in the 1980's, and other sources not included in the
interim product.
COADS/1A contains more elaborate duplicate elimination, some corrections
to the data, and more quality control flags. Furthermore,
COADS/1A adopts a more complete report format including ship ID call
sign, buoy number and identification of platform type whenever
feasible (S. Woodruff, personal communication). All these extra data
and metadata should improve our analysis significantly.  In
addition, the dew point and air temperature corrections proposed by
Kent \etall \ (1993a,b) will be implemented, as metadata permit.

Ultimately, the use of these data to address scientific issues in the
dynamics of the ocean-atmosphere climate system will establish the
strengths and weaknesses of the data sets and hopefully provide clues
for further improvements. For this reason, and to ensure the widest
possible distribution, the objective analyses as well as the raw
monthly means on which they are based are being made available
internationally, without restriction, on magnetic media as
well as CD-ROM.

%....................APPENDICES........................................

%.......................... begin sfc layer..........................

%\newpage
\clearpage
\appendix

\section{Surface layer formulation} 
\label{sec:sfc}

This section presents the details of the marine surface layer
formulation.  The presentation somewhat follows Large and Pond (1981,
1982), with additional steps in the derivations and other details
relevant to our implementation.

Using Reynolds' flux formulation, wind stress and sensible and latent heat
fluxes can be expressed as
\begin{eqnarray}
\tau_x & = & - \rho \langle w u \rangle \\
\tau_y & = & - \rho \langle w v \rangle \\
Q_S & = & - \rho c_p \langle w T \rangle \\
Q_L & = & - \rho L_E \langle w q \rangle
\end{eqnarray}
where $\langle \ \rangle$ is the ensemble average operator, 
$w$ is the vertical velocity, 
$c_p$ is the specific heat of air at
constant temperature, $\rho$ the air density, $T$ the air temperature,
$L_E$ the latent heat of evaporation, and $q$ the specific humidity. 
The marine surface layer is characterized by constant fluxes of heat
and momentum (within measurement errors), i.e. $\langle w u \rangle$, 
$\langle w v \rangle$,
$\langle w T \rangle$, and $\langle w q \rangle$ are approximately
constant throughout the depth of the marine surface layer.  This
property of the fluxes suggest the following definition of
characteristic scales for velocity, temperature, humidity, and length:
\begin{eqnarray}
u_* & = & ( \tau_x / \rho )^{1/2} = | \langle w u \rangle |^{1/2} \\
T_* & = & - \langle w T \rangle / u_* \\
q_* & = & - \langle w q \rangle / u_* \\
L & = & - ( u_*^3 T_0 )/( \kappa g \langle w T_v \rangle )
\end{eqnarray}
where $u_*$ is the friction velocity and $L$ the Monin-Obukhov length,
$T_v$ the virtual temperature with $T_0$ being its local average,
$\kappa$ von K\'{a}rm\'{a}n's
constant, and $g$ the acceleration due to gravity.  Similarity theory
predicts that the mean gradients of momentum, potential temperature, and
humidity are functions of the stability parameter $Z/L$:
\begin{eqnarray}
\frac{\kappa Z}{u_*} 
\frac{\partial \langle u \rangle}{\partial z} & = & \phi_m (Z/L) \\
\frac{Z}{T_*} \frac{\partial \langle \theta \rangle}{\partial z} & =
& \phi_T (Z/L) \\
\frac{Z}{q_*} \frac{\partial \langle q \rangle}{\partial z} & =
& \phi_q (Z/L)
\end{eqnarray}
where $Z$ is the height of the wind, temperature and humidity
measurements, with
\begin{equation}
\phi_m = \phi_T = \phi_q =  1 + 7 Z/L 
\end{equation}
for a {\em stable} surface layer defined $Z/L>0$, $\Delta T<0$, and with
\begin{eqnarray}
\phi_m & = & (1 - 16 Z/L)^{-1/4} \\
\phi_T = \phi_q & = & (1 - 16 Z/L)^{-1/2} 
\end{eqnarray}
for an {\em unstable} surface layer defined $Z/L < 0$, $\Delta T>0$
(Dyer 1974, Yaglom 1977).
If the mean gradient equations are integrated, equations for
wind, potential temperature, and moisture at a height $Z$ are
obtained (Paulson 1970, Large and Pond 1982):
\begin{eqnarray}
u(Z) \equiv &\langle u \rangle  =  
     \frac{u_*}{\kappa} [ \ln \frac{Z - Z_0}{Z_0}  
      - \psi_m( \frac{Z}{L}) ] \label{eq:uatz} \\
\theta(Z) \equiv &\langle \theta \rangle
 =  T_s + T_* [ \ln \frac{Z - Z_T}{Z_T} 
- \psi_T(\frac{Z}{L}) ] \label{eq:tofz} \\
q(Z) \equiv &\langle q \rangle
 =  q_s + q_* [ \ln \frac{Z - Z_q}{Z_q} - \psi_q(\frac{Z}{L}) ]
\end{eqnarray}
where
\begin{equation}
\psi(Z/L) = \int_0^{Z/L} \frac{ 1 - \phi(\xi)}{\xi} \, d\xi \, .
\end{equation}
For notational convenience we have aligned the x-axis with the
wind direction so that $\langle v\rangle =0$ and 
$u(Z)$ corresponds to the wind speed. The wind direction is assumed
constant throughout the depth of the marine surface layer.
The constants $Z_0$, $Z_T$, and $Z_q$ are the surface roughness
lengths for momentum, temperature, and humidity.  Over the ocean
$Z_0$, $Z_T$ and $Z_q$ are much smaller than Z, leading to the
approximation $(Z - Z_0)/Z_0
\approx Z/Z_0$, and similarly for $Z_T$ and $Z_q$.
The factors $\psi$
are given by (Paulson 1970)
\begin{equation}
\psi_m(Z/L) = \psi_T(Z/L) = \psi_q(Z/L) = -7 Z/L 
\end{equation}
for stable conditions, and
\begin{eqnarray}
\psi_m(Z/L) & = & 2 \ln[(1 + X)/2] + \ln [(1 + X^2)/2] \nonumber \\
& & - 2 \tan^{-1}X + \pi/2 \\
\psi_T(Z/L) &=& \psi_q(Z/L) =  2 \ln [(1 + X^2)/2]
\end{eqnarray}
for unstable conditions, with $X = (1 - 16 Z/L)^{1/4}$.

The {\em bulk} formulations for the surface fluxes are
\begin{eqnarray}
-\langle w u \rangle & = & C_D u(Z)^2 \\
\langle w T \rangle & = & C_T u(Z) \Delta \theta \\
\langle w q \rangle & = & C_E u(Z) \Delta q
\end{eqnarray}
where $u(Z)$ is the large scale wind speed at height $Z$ above sea
level, $\Delta \theta = \Delta T - \gamma Z$, $\Delta T = T_s - T(Z)$,
the dry adiabatic lapse rate is $\gamma = 0.01$~K/m, and $\Delta q =
0.98q_s - q(Z)$. (Note that in order to avoid confusion with the
vertical velocity, in this section we use $u$ to denote wind speed
rather than the notation $W$ used throughout this volume).
The transfer coefficients for momentum, heat, and moisture flux in the
above equations are the drag coefficient $C_D$, the Stanton Number
$C_T$, and the Dalton number $C_E$.  These coefficients are derived
next.

\subsection{Drag coefficient}
Recall the definitions for friction velocity:
\begin{equation}
u_*^2 \equiv \langle wu \rangle = C_D u^2 \, .
\end{equation}
Solving for $C_D$ we obtain
\begin{equation}
C_D = {\frac{u_*}{u^2}}^2 \, .
\end{equation}
Substituting (\ref{eq:uatz}) for $u(Z)$ we find
\begin{equation}
\sqrt{C_D} = \frac{\kappa}{\ln(Z/Z_0) - \psi(Z/L)} \, .
\end{equation}
The neutral drag coefficient at $Z = 10$~m is computed by setting $Z/L
= 0$ ($\psi_m = 0$) in the above equation:
\begin{equation}
\sqrt{C_{DN}} = \frac{\kappa}{\ln (10/Z_0)} \, . \label{eq:CDN}
\end{equation}
An equation relating $C_D$ to $C_{DN}$ can be derived:
\begin{eqnarray}
\sqrt{ \frac{C_D}{C_{DN}} }& = & {\ln(10/Z_0)\over
           \ln(Z/Z_0) - \psi_m(Z/L)} \nonumber\\
& = & {1\over1 + (\ln(Z/10) - \psi_m(Z/L))/\ln(10/Z_0)} \, . 
\nonumber \\
& &
\end{eqnarray}
However, from the definition of $C_{DN}$ (eq.~\ref{eq:CDN}) 
we know that $\ln(10/Z) = \kappa / \sqrt{C_{DN}}$, so that
\begin{equation}
\sqrt{\frac{C_D}{C_{DN}}} = {1\over1 + (C_{DN}/\kappa)
(\ln(Z/10) - \psi_m(Z/L) ) } \, .
\end{equation}

\subsection{Stanton number}
In a manner similar to that used for the drag coefficient, the Stanton
number is derived.
\begin{equation}
\langle w T \rangle = C_T u \Delta \theta = -\kappa u_* T_* \\
C_T = \frac{-\kappa u_* T_*}{u \Delta \theta} \, .
\end{equation}
Recall that
\begin{eqnarray}
\theta & = & T + \gamma Z \\
\gamma & = & 0.01 \mbox{ K/m} \\
\Delta \theta & = & T_s - \theta \nonumber\\
& = & T_s - T - \gamma Z \nonumber\\
& = & \Delta T - \gamma Z \, .
\end{eqnarray}
Substituting, using eq.~(\ref{eq:tofz})
\begin{eqnarray}
\Delta \theta & = & -T_* [\ln(Z/Z_T) - \psi_T(Z/L)] \\
u & = & \frac{u_*}{\kappa} [ \ln(Z/Z_0) - \psi_m]
\end{eqnarray}
so that
\begin{eqnarray}
C_T & = & \langle wT \rangle / ( u \delta \theta) \nonumber \\
& = & \frac{\kappa^2}{[\ln(Z/Z_0) -
\psi_m] [\ln(Z/Z_T) - \psi_T]} \, .
\end{eqnarray}
The neutral Stanton number at 10~m is given by
\begin{equation}
C_{TN} = \frac{\kappa^2}{\ln(10/Z_0) \ln(10/Z_T)} \, .
\end{equation}
Next, we estimate the ratio
\begin{equation}
\frac{C_T}{C_{TN}} = \frac{\ln(Z/Z_0) \ln(Z/Z_T)}{[\ln(Z/Z_0) -
\psi_m] [\ln(Z/Z_T) - \psi_T]} \, .
\end{equation}
Exactly as in the previous case, we can show
\begin{eqnarray}
\frac{\ln(Z/Z_0)}{\ln(Z/Z_0) - \psi_m}
 & = & \frac{1}{1 + (\sqrt{C_{DN}}/\kappa) (\ln(Z/10) - \psi_m) } \nonumber \\
 & = & \sqrt{C_D / C_{DN}} \, .
\end{eqnarray}
And analogously,
\begin{equation}
\frac{\ln(Z/Z_T)}{\ln(Z/Z_T) - \psi_T}
 = \frac{1}{1 + (\ln(Z/10) - \psi_T)/\ln(10/Z_T))} \, .
\end{equation}
But now
\begin{eqnarray}
\ln(10/Z_T) & = & \frac{\kappa^2}{\ln(10/Z_0) C_{TN}} \nonumber \\
& = & \kappa \frac{\sqrt{C_{DN}}}{C_{TN}}
\end{eqnarray}
so that
\begin{equation}
\frac{\ln(Z/Z_T)}{\ln(Z/Z_T) - \psi_T}
= \frac{1}{1 + \frac{C_{TN}}{\kappa \sqrt{C_{DN}}} 
(\ln(Z/10) - \psi_T)}
\end{equation}
and the ratio becomes
\begin{equation}
\frac{C_T}{C_{TN}} = \frac{\sqrt{C_D/C_{DN}}}
{1 + (C_{TN}/(\kappa \sqrt{C_{DN}}) (\ln(Z/10) - \psi_T) } \, .
\end{equation}

\subsection{Dalton number}
The derivation of the Dalton number is identical to that of the Stanton
number, but substituting $q$ terms for $T$ terms.
\begin{eqnarray}
C_{EN} & = & \frac{\kappa^2}{\ln(10/Z_0) \ln(Z/Z_q) } \\
\frac{C_E}{C_{EN}} & = & \frac{\sqrt{C_D/C_{DN}}}
{1 + (C_{EN}/(\kappa \sqrt{C_{DN}))(\ln(Z/10) - \psi_q)}} \, .
\nonumber \\
& &
\end{eqnarray}

\subsection{Height conversion}

Next we describe the procedure used to convert quantities from the
observation level to a standard 10~m reference height. This conversion
is necessary since the empirical transfer coefficients have been
experimentally determined for this level.
Recall the formula for wind at height $Z$
\begin{eqnarray}
\label{eq:hcuz}
u(Z) & = & \frac{u_*}{\kappa} [\ln(Z/Z_0) - \psi_m(Z/L)] \\
\label{eq:hcu10}
u(10) & = & \frac{u_*}{\kappa} [\ln(10/Z_0) - \psi_m(10/L)] \, .
\end{eqnarray}
Subtracting eq.~(\ref{eq:hcuz}) from eq.~(\ref{eq:hcu10}) we obtain
\begin{eqnarray}
u(Z) & = & u(10) + \frac{u_*}{\kappa} [\ln(Z/Z_0) - \ln(10/Z) \nonumber \\
& & - \psi_m(Z/L) + \psi_m(10/L)] \\
\frac{u(Z)}{u(10)} & = & 1 + \frac{u_*}{\kappa u(10)} [\ln(Z/10) \nonumber \\
& & - \psi_m(Z/L) + \psi_m(10/L)] \, .
\end{eqnarray}
Now, recall that
\begin{equation}
\frac{u_*}{u(10)}= \sqrt{C_D(10)}
\end{equation}
which gives the conversion equation for wind:
\begin{eqnarray}
\frac{u(Z)}{u(10)} & = & 1 + \frac{\sqrt{C_D(10)}}{\kappa} [\ln(Z/10) - \psi_m(Z/L) \nonumber \\
& & + \psi_m(10/L)] \, .
\end{eqnarray}

The conversion equation for temperature is derived similarly:
\begin{eqnarray}
\Delta \theta(Z) & = & -T_* [\ln(Z/Z_T) - \psi_T(Z/L)] \\
\Delta \theta(10) & = & -T_* [\ln(10/Z_T) - \psi_T(10/L)] \, .
\end{eqnarray}
Subtracting, yields
\begin{eqnarray}
\Delta \theta(Z) & = & \Delta \theta(10) + 
T_* [\ln(Z/10) - \psi_T(Z/L) \nonumber \\
& & + \psi_T(10/L)] \\
\frac{\Delta \theta(Z)}{\Delta \theta(10)} & = & 1 - 
\frac{T_*}{\Delta \theta(10)} [\ln(Z/10) - \psi_T(Z/L) \nonumber \\
& & + \psi_T(10/L)] \, .
\end{eqnarray}
Recall that
\begin{eqnarray}
C_T & = & - \frac{u_* T_*}{u \Delta \theta} \nonumber \\
& = & - \sqrt{C_D} (\frac{T_*}{\Delta \theta}) \\
\frac{T_*}{\Delta \theta} & = & - \frac{C_T}{\sqrt{C_D}}
\end{eqnarray}
so that the conversion for temperature becomes
\begin{eqnarray}
\frac{\Delta \theta(Z)}{\Delta \theta(10)} & = & 1 + 
\frac{C_T(10)}{\sqrt{C_D(10)}} [\ln(Z/10) - \psi_T(Z/L) \nonumber \\
& & + \psi_T(10/L)] \, .
\end{eqnarray}
By analogy, the conversion for moisture is
\begin{eqnarray}
\frac{\Delta q(Z)}{\Delta q(10)} & = & 1 + 
\frac{C_E(10)}{\sqrt{C_D(10)}} [\ln(Z/10) - \psi_q(Z/L) \nonumber \\
& & + \psi_q(10/L)] \, .
\end{eqnarray}

\subsection{Iteration of stability coefficients}
The height reduction and the calculation of the transfer coefficients
requires knowledge of the 
stability parameter $Z/L$.  However, the Monin-Obukhov length, $L$,
requires friction velocity, $u_*$, which is in turn, a function of
the transfer coefficient $C_D$.  So in order to calculate the
stability and the transfer coefficients, an iterative method is used.
We define a stability parameter $\sigma$ to be the iterative form of
$Z/L$.  This stability parameter $\sigma$ is a function of the transfer
coefficients, $C_D$ and $C_T$, and a term $S$ which can be directly
evaluated from observations:
\begin{equation}
\sigma = \frac{C_T(\sigma)}{C_D^{3/2}(\sigma)} 
S(u, T_a, \Delta T, \Delta q ) \, .
\label{eq:sigma_iter}
\end{equation}
The parameter $S$ above is related to the bulk Richardson number,
\be
S \equiv \kappa Ri = -\kappa {g Z \Delta \theta\over u^2(Z) T_0} \( 1 +
T_o^2 {\Delta q\over \Delta \theta} 1.72 \times 10^{-6}\)
\ee
In the above expression $T_0$ is the virtual temperature in Kelvins
which can be approximated by $T_0 \approx T_{air}$ with an error less
than 2\%.
As the first guess for $\sigma$ in (\ref{eq:sigma_iter}), the neutral 
transfer coefficients are used:
\begin{equation}
\sigma^0 = \frac{C_{TN}}{C_{DN}} S
\end{equation}
where the neutral transfer coefficients used are the experimentally determined
values for $C_{DN}$ (Trenberth et al. 1989), $C_{TN}$, and $C_{EN}$ 
(S. Pond, personal communication, rounded up from Large and Pond
1982):
\begin{eqnarray}
C_{DN} &=& \left \{ \begin{array}{l}
2.18 \times 10^{-3} \mbox{ for } u \leq 1 \mbox{m/s}\\
( 0.62 + 1.56/u ) \times 10^{-3} \mbox{ for } 1<u < 3
\mbox{m/s}\\
1.14 \times 10^{-3} \mbox{ for } 3 \leq u < 10 \mbox{m/s} \\
(0.49 + 0.065 u ) \times 10^{-3} \mbox{ for } u \geq 10 \mbox{m/s}
\end{array} \right . \\
C_{TN} & = & \left \{ \begin{array}{ll}
1.2  \times 10^{-3} & \mbox{ for } S < 0 \\
0.75 \times 10^{-3} & \mbox{ for } S \geq 0
\end{array} 
\right . \\
C_{EN} & = & 1.2 \times 10^{-3} \, .
\end{eqnarray}
From this point, $\sigma$ and the transfer coefficients can be
calculated in an iterative manner:
\begin{equation}
\sigma^{n+1} = \frac{C_T(\sigma^n)}{C_D^{3/2}(\sigma^n)} S
\end{equation}
where
\begin{eqnarray}
C_D(\sigma^n) & = & C_{DN}(u) f(\sigma^n) \\
C_T(\sigma^n) & = & C_{TN}(\Delta T) g(\sigma^n)\\
C_E(\sigma^n) & = & C_{EN}(\Delta q) h(\sigma^n)\\
f(\sigma^n) & = & \frac{1}{(1 - 
\frac{\sqrt{C_{DN}}\psi_m(\sigma^n)}{\kappa})^2} \\
g(\sigma^n) & = & \frac{f(\sigma^n)}{1 - 
\frac{C_{TN}}{\kappa \sqrt{C_{DN}}} \psi_T(\sigma^n)} \\
h(\sigma^n) & = & \frac{f(\sigma^n)}{1 - 
\frac{C_{EN}}{\kappa \sqrt{C_{DN}}} \psi_q(\sigma^n)} \, .
\end{eqnarray}
$\psi_m$, $\psi_T$ and $\psi_q$ are as defined earlier, and the neutral
transfer coefficients are the values listed above.

The stability parameter and the transfer coefficients are iterated
until $\sigma$ converges within the desired tolerance (although $C_E$
does not need to be calculated until the very end).  Convergence is
usually accomplished in only a few iterations.  Upon convergence, the
transfer coefficients are recalculated with this final estimate of
$Z/L$ for use in the momentum or heat flux calculations.

The transfer coefficients need only one iteration
if the wind observation is at 10~m.  However, as most winds are assumed
to be taken at 20~m, winds must be reduced to the 10~m level.  This
process involves a second level of iteration in addition to the
transfer coefficient iteration.  The first step is to calculate the
transfer coefficients and $Z/L$ using the method given above.  The
wind speed is adjusted using the drag coefficient and $Z/L$.  
$C_D$ and $Z/L$ are recalculated with this adjusted wind.  Then wind speed
and the surface layer terms are calculated alternately until $Z/L$
converges to some desired tolerance.  The value of the wind speed at
that point is the 10~m wind speed.



%.......................end sfc layer..................


\clearpage
\section{Astronomy}
\label{sec:astronomy}

Astronomical formulas are used in the calculation of two quantities:
short wave radiation and fractional cloudiness.  Short wave radiation
involves only the position of the sun, while the determination of
bright sky observations for cloudiness involves the positions of the
sun and moon.

Unless otherwise stated, the right ascension and declination of the
sun and moon are calculated at noon GMT (Greenwich Mean Time) of the
exact day of the observation.  Altitude is computed at the actual time
of day for each observation.  The equations for incident radiation at
the top of the atmosphere are adapted from the {\em Smithsonian
Meteorological Tables} (List 1958).  All other astronomical equations
are taken from the {\em Astronomical Almanac} (U.~S.\ Government
Printing Office 1990).  As the documentation for the astronomy
equations was not fully detailed in these references, it was necessary
to consult several sources before implementation.  To assist those who
might wish to use these formulas in similar calculations, a detailed
explanation of the equations is included below.

\subsection{Incident radiation}
The equation used to determine the total amount of solar radiation reaching
a unit horizontal area at the top of the atmosphere is
\begin{equation}
\label{eq:Q0}
Q_0 = \int J_0 \cos z\, dt
\end{equation}
where $z$ is the sun's zenith angle:
\begin{equation}
\cos z = \sin \phi \sin \delta + \cos \phi \cos \delta \cos h
\end{equation}
and $\phi$ is the latitude, $\delta$ is the sun's declination, and
$h$ is the sun's hour angle.  Eq.~(\ref{eq:Q0}) is integrated
from sunrise to sunset (see section~\ref{sec:sunrise}) for each day of
a hypothetical year, approximating $\delta$ with its Greenwich noon
time value.  This approximation introduces very little error, as the
astronomy of the sun changes only a small amount over the course of
one day and is nearly identical from year to year (particularly in
such a small range of years as we consider).  The sun's
declination for the year 1970 (365 days) is used.  $Q_0$ is then
summed for each
day to obtain the latitudinal total for each month.  The total $Q_0$
for the entire year is a slight underestimate as a true solar year is
approximately 365.25 days.

The value used for the solar constant is 
$J_0 = 1370$~W/m$^2$, as in Oberhuber (1988).
This value is higher than that in List (1958),
but is thought to give a better estimation of radiation in the ultraviolet
region (see Houghton 1985, pp 70--73 for a brief discussion).

\subsection{Sunrise and sunset}
\label{sec:sunrise}

In the calculation of incident solar radiation mentioned previously, 
the equation is integrated from sunrise to sunset.  The equation
\begin{equation}
\sin a = \sin \delta \sin \phi + \cos \delta \cos h \cos \phi
\end{equation}
is used to find the hour angles at which the sun's altitude is zero.  
When the sun's altitude is zero, the equation becomes
\begin{equation}
\cos h = -\frac{ \sin \phi \sin \delta}{\cos \phi \cos \delta} \, .
\end{equation}
If the right hand side (RHS)
of the equation is greater than or equal to 1, the sun does not rise and
the incoming radiation for that day is zero.  If the RHS of the equation
is less than or equal to $-1$, the sun does not set and the 
incoming solar radiation is integrated over a full 24 hour period.

\subsection{Sun equations}
To obtain the right ascension ($\alpha_s$) and declination ($\delta_s$) of
the sun, the following equations are used.  The apparent coordinates
of the sun 
are accurate to within 0.01\deg \ between 1950 and 2050.  Values are
calculated for noon of the chosen day.

Find $n$, the number of days from Julian Day 2000 (Jan.\ 1, 2000)
and calculate the mean longitude $L$
and anomaly $g$ of the sun in degrees:
\begin{eqnarray}
n & = & JD - 2451545 \\
L & = & 280.460 + 0.9856474 n \\
g & = & 357.528 + 0.9856003 n \, .
\end{eqnarray}
The astronomical Julian date ($JD$) is the interval in mean solar days 
elapsed since Greenwich mean noon ($12^h$ Universal Time) January 1,
4713 BC\@.  For
example, on January 1, 1900 at noon GMT, $JD = 241502.0$ and $JD =
241502.5$ on the following midnight.  When calculating $JD$, leap days
{\em must} be included.

Add 360\deg \ to $L$ and $g$ until each lies in the range [0,360).  Then
find the longitude $\lambda$ and obliquity $\varepsilon$ of the ecliptic in
degrees (the ecliptic is the apparent annual path of the sun on the
earth-centered celestial sphere):
\begin{eqnarray}
\lambda & = & L + 1.915\, \sin g + 0.020\, \sin 2g \\
\varepsilon & = & 23.439 - 0.0000004 n \, .
\end{eqnarray}
Find the declination $\delta_s$ and right ascension $\alpha_s$ of the sun in
degrees:
\begin{eqnarray}
\delta_s & = & \sin^{-1} ( \sin \varepsilon \sin \lambda ) \\
\alpha_s & = & \tan^{-1} ( \cos \varepsilon \tan \lambda ) \, .
\end{eqnarray}
Add 360\deg \ to $\alpha_s$ if it is less than zero, then
put $\alpha_s$ in the same quadrant as $\lambda$:
\begin{description}
\item[] if \ $180^\circ < \lambda < 270^\circ$ \ then \ 
$\alpha_s = \alpha_s + 180^\circ$
\item[] if \ $90^\circ < \lambda < 180^\circ$ \ then \ 
$\alpha_s = \alpha_s - 180^\circ$ \, .
\end{description}

\subsection{Moon equations}
To obtain the right ascension ($\alpha_m$) and declination ($\delta_m$) of
the moon the following equations are used.  $\alpha_m$ is accurate to about
0.3\deg \ and $\delta_m$ to about 0.2\deg.  Values are calculated for noon
on the day of the observation.

Find the time in Julian centuries from the epoch 2000 Jan $1^d 12^h$
Universal Time:
\begin{equation}
T = ( JD - 2451545.0 ) / 36525. \label{eq:T}
\end{equation}
Find the longitude of the moon's ecliptic in degrees:
\begin{eqnarray}
\lambda & = & 218.32 + 481267.833 T \nonumber \\
&& +\, 6.29\, \sin(134.9 + 477198.85\, T) \nonumber \\
&& -\, 1.27\, \sin(259.2 - 413335.38\, T) \nonumber \\
&& +\, 0.66\, \sin(235.7 + 890534.23\, T) \nonumber \\
&& +\, 0.21\, \sin(269.9 + 954397.70\, T) \nonumber \\
&& -\, 0.19\, \sin(357.5 +  35999.05\, T) \nonumber \\
&& -\, 0.11\, \sin(186.6 + 966404.05\, T) \, .
\end{eqnarray}
Find the latitude of the moon's ecliptic in degrees:
\begin{eqnarray}
\beta & = & 5.13\, \sin(93.3 + 483202.03 T) \nonumber \\
&& +\, 0.28\, \sin(228.2 + 960400.87 T) \nonumber \\
&& -\, 0.28\, \sin(318.3 + 6003.18 T) \nonumber \\
&& -\, 0.17\, \sin(217.6 - 407332.20 T) \, .
\end{eqnarray}
Form the geocentric direction cosines:
\begin{eqnarray}
\ell & = & \cos \beta \cos \lambda \\
m & = & 0.9175 \cos \beta \sin \lambda - 0.3978\, \sin \beta \\
n & = & 0.3978 \cos \beta \sin \lambda + 0.9175\, \sin \beta \, .
\end{eqnarray}
Find declination $\delta_m$ and right ascension $\alpha_m$ of the
moon in degrees:
\begin{eqnarray}
\delta_m & = & \sin^{-1} n \\
\alpha_m & = & \tan^{-1} (m/\ell) \, .
\end{eqnarray}
Put $\alpha_m$ into the correct quadrant (determined from the sign of
$\ell$) and make sure $\alpha_m$ is positive:
\begin{description}
\item[]if  \ $\ell < 0$ \ then \ $\alpha_m = \alpha_m + 180^\circ$
\item[] if \ $\alpha_m < 0$ \ then \ $\alpha_m = \alpha_m + 360^\circ$
\, .
\end{description}

\subsection{Phase of the moon}

The phase of the moon is determined by the angle between the sun and
moon as viewed from Earth.  If the angle between the two is zero,
observers on the earth see a new moon.  The value of the phase for a
new moon is 0.  If the sun and moon are 180\deg \ apart, earth
observers see a full moon.  The value of the phase for a full moon is
1.  An approximation for this angle $\alpha_{ms}$ is found by
subtracting the right ascension of the sun from the right ascension of
the moon and centering this angle in the range [-180\deg,180\deg].
The phase value is then
\begin{equation}
P = |\frac{\alpha_{ms}}{180^\circ}|
\end{equation}
where $\alpha_{ms}$ is measured in degrees.  The exact angle is found
by comparing the apparent celestial longitudes of the sun and moon.
As the angle of the moon's orbit about the earth is inclined from the
ecliptic by only 5.1\deg, using the right ascension for both objects
introduces very little error.

\subsection{Altitude}

Using the right ascension and declination of an object, the altitude
of the object above the horizon can be determined at a particular
latitude and longitude on the earth for any time of day.  Mean time is
used instead of apparent time in the following equations.  This
reduces the accuracy by a few minutes of altitude.

Using $T$ calculated from (\ref{eq:T}), find Greenwich Mean Siderial Time
(GMST) at noon for the day in seconds:
\begin{eqnarray}
GMST_s & = & 24110.54841 + 8640184.812886\, T \nonumber \\
&& +\, 0.093104\, T^2 - 6.2\times10^{-6}\, T^3 \, . \nonumber \\
& &
\end{eqnarray}
Convert this value to hours, take the 1 day modulus, and add the time of the
observation (in siderial hours) to get the Greenwich Mean Siderial
Time $GMST_h$
\begin{equation}
GMST_h = \text{mod}( \frac{GMST_s}{3600}, 24 ) + 1.0027379093\, H \, .
\end{equation}
Find the Local Mean Siderial Time $LMST$ in degrees and center it in the
range [0,360).  Then find the hour angle $h$ in degrees and center it in 
the range [-180,180].  $\lambda$ is the longitude of the observation in degrees
east of Greenwich.
\begin{eqnarray}
LMST & = & \text{mod}(GMST_h \times \frac{360}{24} + \lambda, 360)\, \\
h & = & \text{mod}(LMST - \alpha, 360)
\end{eqnarray}
\begin{description}
\item[] if $h > 180^\circ$ then $h = h - 360^\circ$
\item[] if $h < -180^\circ$ then $h = h + 360^\circ$.
\end{description}
Find the altitude $a$ of the object using 
\begin{equation}
\sin a = \sin \delta \sin \phi + \cos \delta \cos h \cos \phi
\end{equation}
where $\phi$ is the latitude of the observation.
If the zenith angle $z$ is desired instead of altitude, 
it is simply $z = 90^\circ
 - a$ where $z$ and $a$ are both in degrees.


%......................end astron ...................................



%%\input{netcdf}
\cleardoublepage
\section{FORTRAN access software for UWM/COADS NetCDF files}
\label{sec:fortran}

This section presents FORTRAN access software to read raw and analyzed
UWM/COADS NetCDF files. This software is included with the data
and current versions can be obtained from the authors. Instructions for
installation and test of the software will be provided with the data.

Tables~\ref{tab:uwmcdf.f}--\ref{tab:uwmcdf.h} list {\tt UWREAD}, a
routine to read analyzed UWM/COADS NetCDF files. On input the user
only needs to specify the desired month and year along with the name
of the file (see Table~\ref{tab:vars} for a list of file names). On
output, the array {\tt X(360,180)} contains the desired gridded data.
Climatological data is obtained by specifying {\tt year = 0}.  Notice
that the UWM/COADS analyses are available only over the oceans, a
special land-value (by default $-10^{10}$) is used to indicate those
grid-points over land. Once a file is opened by {\tt UWREAD} it
remains opened for subsequent reading. All file pointers and other
necessary parameters needed to access the data are handled internally
and are transparent to the user.  By default, {\tt UWREAD} can open a
maximum of 10 files. This number can be increased by changing
parameter {\tt NMAX} in the include file {\tt uwmcdf.h}
(Table~\ref{tab:uwmcdf.h}). In order to close all NetCDF files opened
by {\tt UWREAD} the user needs to call {\tt UWCFIL}. Consult
Table~\ref{tab:uwmcdf.f} for a complete list of I/O parameters. 

Raw (unanalyzed) UWM/COADS NetCDF files are read with routine {\tt
RDRAW} (Tables~\ref{tab:ncraw.f}--\ref{tab:ncraw.h}). This routine
returns the monthly mean, standard deviation or number of observation
raw grid for a given month and year. The raw grids have the same
dimensions of the analyzed grids returned by {\tt UWREAD}, but each
grid point now can have a land-value (by default equal to $-10^{10}$),
a missing-value (by default equal to $+10^{10}$) or a valid value
(e.g., the monthly mean SST at the grid point). The file {\tt
land\_mask.nc} is shipped with the data and is assumed present in the
local directory. This file is used by {\tt RDRAW} to
assign the special value to the land grid-points.  Note that this
routine assumes the UWM/COADS file name convention described in
Table~\ref{tab:raw}. For a complete list of I/O parameters consult
Table~\ref{tab:ncraw.f}.

The subroutines above rely on the NetCDF FORTRAN Library which is
described in Appendix~\ref{sec:netcdf} (see also Rew \etall~1993).
For a description of the structure of the UWM/COADS NetCDF files see
Appendix~\ref{sec:file_struct}.


\begin{table*}

\caption{File uwmcdf.f: FORTRAN subroutines to read UWM/COADS 
NetCDF analyzed files. }
\label{tab:uwmcdf.f}

\begin{verbatim}

**********************************************************************
* uwmcdf.f - last change: 2/4/93 (ccy/ams)                           * 
*                                                                    * 
*     Access routines to the NetCDF UWM/COADS data sets.             *
*                                                                    * 
**********************************************************************


      subroutine UWREAD (ier, x, idim, jdim, label, mon, year, filen)

      integer       idim, jdim, mon, year, ier
      real          x(idim,jdim)
      character*80  label, filen

*
*     This routine reads grids from the analyzed UWM/COADS NetCDF files.
*
*     On input:
*        idim, jdim  - dimensions of output array (usually 360x180)
*        mon         - desired month (jan=1, feb=2, etc.)
*        year        - desired year.  If 'year' is between 1945
*                      and 1989, the corresponding anomalies are
*                      returned.  The climatology for month
*                      'mon' is returned if year = 0.
*        filen       - full file name (including path) for the
*                      input NetCDF file. End file name with '$'.
*                      Example:  filen = '/data/cdf/sst.cdf$'
*                   
*
*     On output:
*        x     array containing the grid over the globe.  Land
*              points receive the special value -1.0E+10.
*      label   informational label about the data just read.
*              This can used for the title of a plot.
*        ier   error code:
*              0  -   no error
*             <0  -   NetCDF error code (-errcod)
*              1  -   not enough work space.
*              2  -   too many files open
*              3  -   incompatible dimensions        
*
*

\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}

*     NOTE:  For the 1 degree x 1 degree data products (360x180
*            arrays) the zonal and meridional grids are as follows:
*      
*     longitude(i) = 0.5 + (i-1),  for i = 1,...,360
*     latitude(j) = -89.5 + (j-1), for j = 1,...,180
*

*     Land value
*     ----------
      real ALAND
      parameter ( ALAND = -1.0E+10 )

      include 'netcdf.inc'
      include 'uwmcdf.h'

      integer      errcod, idlat, idlon
      character    pname*10, chyr*4, shorti*80
      character*3  chmon(12)

      logical      strcmp

      integer      cst(2), clen(2), ast(3), alen(3)
      save         cst, clen, ast, alen

      data chmon / 'jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul',
     .             'aug', 'sep', 'oct', 'nov', 'dec' /
      data cst / 1, 1 /, clen / npmax, 1 /
      data ast / 1, 1, 1 /, alen / npmax, 1, 1 /


*     Initialize error parameter
*     --------------------------
      ier = 0
      errcod = 0 

      lf = index(filen,'$') - 1
      if ( lf .le. 0 ) lf = 80

      iyear = year
      if ( year .ne. 0 .and. year .lt. 1900 ) iyear = 1900+year

*     Do if this is the first call
*     ----------------------------
      if ( icount .eq. 0 ) then
         icount = icount + 1
         nfile = icount
         files(icount) = filen
         call NCPOPT ( NCVERBOS )

*        open netcdf file
*        ----------------
         idfile(icount) = NCOPN ( filen(1:lf), NCNOWRIT, errcod )
         if ( errcod .ne. 0 ) go to 999

\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}

*        determine if resolution is compatible
*        -------------------------------------
         idnpt = NCDID ( idfile(icount), 'npoint', errcod )
         if ( errcod .ne. 0 ) go to 999
         call NCDINQ ( idfile(icount), idnpt, pname, npoint, errcod )
         if ( errcod .ne. 0 ) go to 999
         if ( npoint .gt. npmax ) then
            ier = 1
            return
         end if
         alen(1) = npoint
         clen(1) = npoint

*        get id numbers for lat and lon
*        ------------------------------
         idlat = NCVID ( idfile(icount), 'lat', errcod )
         if ( errcod .ne. 0 ) go to 999
         idlon = NCVID ( idfile(icount), 'lon', errcod )
         if ( errcod .ne. 0 ) go to 999

*        read in lat and lon data
*        ------------------------
         call NCVGT ( idfile(icount), idlat, 1, npoint, lat, errcod )
         if ( errcod .ne. 0 ) go to 999
         call NCVGT ( idfile(icount), idlon, 1, npoint, lon, errcod )
         if ( errcod .ne. 0 ) go to 999

*        Get climatology attributes
*        --------------------------
         idclm(icount) = NCVID ( idfile(icount), 'clm', errcod )
         if ( errcod .ne. 0 ) go to 999
         call NCAGT ( idfile(icount), idclm(icount), 'add_offset',
     .                offclm(icount), errcod )
         if ( errcod .ne. 0 ) go to 999
         call NCAGT ( idfile(icount), idclm(icount), 'scale_factor',
     .                sclclm(icount), errcod )
         if ( errcod .ne. 0 ) go to 999


*        get anomaly attributes
*        ----------------------
         idanm(icount) = NCVID ( idfile(icount), 'anom', errcod )
         if ( errcod .eq. 0 ) then
          call NCAGT ( idfile(icount), idanm(icount), 'add_offset',
     .                 offanm(icount), errcod )
          if ( errcod .ne. 0 ) go to 999
          call NCAGT ( idfile(icount), idanm(icount), 'scale_factor',
     .                 sclanm(icount), errcod )
          if ( errcod .ne. 0 ) go to 999
         end if
    
         isopen = 1


\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}


*     Otherwise check to see if it is a new file
*     ------------------------------------------
      else

         isopen = 0
         do 10 i = 1, icount
            if ( STRCMP ( filen, files(i), '$' ) ) then
               nfile = i
               isopen = 1
            end if
 10      continue

      end if


*     Do only if a new file
*     ---------------------
      if ( isopen .ne. 1 ) then
         icount = icount + 1
         if ( icount .gt. nmax ) then
            ier = 2
            return
         end if
         files(icount) = filen
         nfile = icount

*        open netcdf file
*        ----------------
         idfile(nfile) = NCOPN ( filen(1:lf), NCNOWRIT, errcod )
         if ( errcod .ne. 0 ) go to 999


*        determine if resolution is compatible
*        -------------------------------------
         idnpt = NCDID ( idfile(nfile), 'npoint', errcod )
         if ( errcod .ne. 0 ) go to 999
         call NCDINQ ( idfile(nfile), idnpt, pname, npts, errcod )
         if ( errcod .ne. 0 ) go to 999
         if ( npts .ne. npoint ) then
            ier = 3
            return
         end if
         

\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}


*        Get climatology attributes
*        --------------------------
         idclm(nfile) = NCVID ( idfile(nfile), 'clm', errcod )
         if ( errcod .ne. 0 ) go to 999
         call NCAGT ( idfile(nfile), idclm(nfile), 'add_offset',
     .                offclm(nfile), errcod )
         if ( errcod .ne. 0 ) go to 999
         call NCAGT ( idfile(nfile), idclm(nfile), 'scale_factor',
     .                sclclm(nfile), errcod )
         if ( errcod .ne. 0 ) go to 999

*        Get anomaly attributes
*        ----------------------
         idanm(nfile) = ncvid( idfile(nfile), 'anom', errcod )
         if ( errcod .eq. 0 ) then
          call NCAGT ( idfile(nfile), idanm(nfile), 'add_offset',
     .                 offanm(nfile), errcod )
          if ( errcod .ne. 0 ) go to 999
          call NCAGT ( idfile(nfile), idanm(nfile), 'scale_factor',
     .                 sclanm(nfile), errcod )
          if ( errcod .ne. 0 ) go to 999
        end if

      end if


*     Do every time:  acquire the global attribute 'source'
*     ----------------------------------------------------
      call NCAGTC ( idfile(nfile), 
     .              NCGLOBAL, 'source', uwmver, 80, errcod )
      if ( errcod .ne. 0 ) go to 999
      call NCAGTC ( idfile(nfile), NCGLOBAL, 
     .              'title', shorti, 80, errcod )
      if ( errcod .ne. 0 ) go to 999



*     fill in land values in x array
*     ------------------------------
      if ( iaccum .eq. 0 ) then
         do 100 j = 1, jdim
            do 100 i = 1, idim
 100           x(i,j) = ALAND
      end if


\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}


*     Get climatology or anomaly data
*     -------------------------------
      if ( iyear .eq. 0 ) then
         cst(2) = mon
         call NCVGT ( idfile(nfile), idclm(nfile), cst, clen, var,
     .                errcod )
         if ( errcod .ne. 0 ) go to 999
         vscal = sclclm(nfile)
         voffst = offclm(nfile)
      else
         ast(2) = mon
         ast(3) = iyear-1944
         call NCVGT ( idfile(nfile), idanm(nfile), ast, alen, var,
     .                errcod )
         vscal = sclanm(nfile)
         voffst = offanm(nfile)
      end if

*     uncondense field
*     ----------------
      if ( iaccum .eq. 1 ) then
         do 200 k = 1, npoint
            i = lon(k)
            j = lat(k)
            xvar = var(k)
            x(i,j) =  x(i,j) + xvar * vscal + voffst
 200     continue
      else
         do 300 k = 1, npoint
            i = lon(k)
            j = lat(k)
            xvar = var(k)
            x(i,j) =  xvar * vscal + voffst
 300     continue
      end if


*     create an informative label
*     ---------------------------
      lf = index( shorti, '$' ) - 1

      if ( iyear .eq. 0 ) then
         label = '/' // shorti(1:lf) // ' climatology for '
     .              // chmon(mon) // '$'

      else
         write( chyr, '(i4)' ) iyear
         label = '/' // shorti(1:lf) // ' anomaly for ' // chmon(mon)
     .              // ' ' // chyr // '$'
      end if


\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}

*     Normal end
*     ----------
      ier = 0

      return


*     Abnormal end: error on return from NetCDF
*     -----------------------------------------
 999  continue
      if ( errcod .eq. -1 ) then
         ier = -999
      else
         ier = - errcod
      end if

      return

      end


*...................................................................

      logical function STRCMP ( str1, str2, del )

      character*(*) str1, str2
      character*1   del

*
*     Returns TRUE if strings are the same.
*

      STRCMP = .false.

      l1 = index ( str1, del ) - 1
      l2 = index ( str2, del ) - 1

      if ( l1 .le. 0 .or. l2 .le. 0 .or. l1 .ne. l2 ) return

      STRCMP = .true.
      do 10 i = 1, l1
         if ( str1(i:i) .ne. str2(i:i) ) STRCMP = .false.
 10   continue

      return
      end

\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}
*...................................................................

      subroutine UWCFIL ( ier )
    
*
*     Close all NetCDF files in use.
*
      include 'uwmcdf.h'
      integer errcod
     
      do 10 i = 1, icount
         call NCCLOS ( idfile(i), errcod )
         if ( errcod .ne. 0 ) go to 999
 10   continue

*     Reset counter
*     ------------
      icount = 0

*     Normal end
*     ----------
      return

*     Abnormal end
*     ------------
 999  continue
      if ( errcod .eq. -1 ) then
         ier = -999
      else
         ier = - errcod
      end if
      

      return
      end

*...................................................................

      Block Data UWMCDF

      include 'uwmcdf.h'

      data icount / 0 /
      data iaccum / 0 /

      end


\end{verbatim}


\end{table*}



\begin{table*}

\caption{File uwmcdf.h: include file for uwmcdf.f.}
\label{tab:uwmcdf.h}

\begin{verbatim}

************************************************************
* uwmcdf.h - last change: 6/23/92 (ams)                    *
*                                                          *
*     Include file for NetCDF UWM/COADS I/O programs.      *
*                                                          * 
************************************************************

*     Arrays to hold lat/lon and packed grid
*     --------------------------------------
      parameter ( npmax = 42164 )
      integer    npoint
      integer*2  lat(npmax), lon(npmax), var(npmax)

*     Info. about files previously open
*     ---------------------------------
      parameter ( nmax = 10 )
      integer  icount, idfile(nmax), idclm(nmax), idanm(nmax)

      real   offclm(nmax), sclclm(nmax)
      real   offanm(nmax), sclanm(nmax)

      character*80 uwmver, files(nmax)

      common / uwcdf1 / npoint, lat, lon, var
      common / uwcdf2 / icount, idfile, idclm, idanm
      common / uwcdf3 / offclm, sclclm, offanm, sclanm
      common / uwcdf4 / uwmver, files
      common / uwcdf5 / iaccum

\end{verbatim}

\end{table*}


\begin{table*}

\caption{File nc\_raw.f: FORTRAN subroutines to read raw UWM/COADS 
NetCDF files. }
\label{tab:ncraw.f}

\begin{verbatim}

******************************************************************
* nc_raw.f - last change: 8/12/94 (ams)                          *
*                                                                *
*     This file contains routines to read raw monthly mean files *
* from the UWM/COADS data set. The only routine of interest      *
* to UWM/COADS users is RDRAW which is documented below.         *
*                                                                *
******************************************************************

      subroutine RDRAW ( ier, a, idimd, jdimd, label, units, 
     .                   name, choice, mon, iyr, data_dir )

      real a(idimd,jdimd)
      character*(*) choice, name, data_dir
      integer mon, iyr
      character*80 label, units

*
*        This routine reads UWM/COADS raw monthly mean files and
*     returns in array 'a' the monthly mean, standard deviation or
*     number of observations according to the value of parameter choice
*     (see below). For each grid point you can have a Land Value
*     (usually ALAND = -1.E10), a Missing Value (usually AMISS = +1.E10)
*     or a valid value (say the monthly mean sst at that grid point).
*     The UWM/COADS files are assumed present in the 'data_dir' directory.
*     The file 'land_mask.nc' is assumed to be in the local directory.
*     Also assumed is the UWM/COADS file naming convention:
*     sst_45.nc, ..., sst_89.nc.
*
*     On input:
*     --------
*
*     idimd,jdimd   Dimensions of the input array. They must be
*                    idimd = 360, jdimd = 180
*     name          Quantity name (see FILE.LST). Example:
*                    name = 'sst', name = 'slp', etc.
*     choice        Which of the 3 available statistics is desired
*                     choice = 'mean' monthly mean returned in 'a'
*                     choice = 'std'  std deviation returned in 'a'
*                     choice = 'nobs' number of obs. returned in 'a'
*     iyr           Year (2 digits). Example: iyr = 67 for 1967.
*                   For climatology use iyr = 0.
*     mon           Month. Example: January=1, February=2, etc
*     data_dir      Directory where data are located,
*                   e.g., '/cdrom/'. Note: This must end with '/'
*                   on UNIX or with '\' on MS-DOS.
*
\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}

*     On output:
*     ---------
*
*     ier             If sucessful, ier = 0, otherwise an error
*                      occured.
*     a(idimd,jdimd)  Gridded output. The zonal/meridional grids are
*                     defined as follows:
*
*                     longitude(i) = 0.5 + (i-1),  i = 1,...,360
*                     latitude(j) = -89.5 + (j-1), j = 1,...,180
*
*                     (longitude in degrees east, and latitude in degrees,
*                      negative in the southern hemisphere. This is the
*                      same horizontal grid of Levitus' climatology).
*
*     label           An informative title
*     units           What it says (returned only for choice='mean')
*
*     
*     Bugs:
*     ----
*             Not really efficient. The file is opened, the monthly
*     data is retrieved and then the file is closed. The fix is
*     easy for someone with NetCDF experience, but the current
*     routine is fast enough for most applications.
*
*
*     Send questions to  uwmcoads@niteroi.gsfc.nasa.gov


      include 'nc_raw.h'
      include 'netcdf.inc'
      integer*2 year

      real amask(idim,jdim)
      character*80 filen
      character*2 yy
      integer boxnumid, varid, recrid, icoord(2), ifirst

      save ifirst, amask
      data ifirst / 1 /


*     Consistency check
*     -----------------
      if ( idimd .ne. idim .or. jdimd .ne. jdim ) then
         print *, 'RDRAW: incompatible dimensions. You must have'
         print *, '       idimd=360, jdimd=180 '
         ier = 1
         return
      end if

\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}

*     Fill target array with missing value
*     ------------------------------------
      if ( choice .eq. 'nobs' .or. choice .eq. 'NOBS' ) then
         do 101 j = 1, jdim
            do 101 i = 1, idim
               a(i,j) = 0.
 101     continue
      else
         do 100 j = 1, jdim
            do 100 i = 1, idim
               a(i,j) = AMISS
 100     continue
      end if
 

*     Read land mask the first time in
*     --------------------------------
      if ( ifirst .eq. 1 ) then
           call RDARR ( ier, amask, idim, jdim, label,
     .                  'land_mask.nc' )
           if ( ier .ne. 0 ) then
              print *, 'RDRAW: cannot read file: land_mask.nc'
              ier = 1
              return
           end if
           ifirst = 0
      end if


*     Mask out land
*     -------------
      call SETLAND ( a, idim*jdim, amask, ALAND )


*     Set netcdf error handling to not fatal
*     --------------------------------------
      call NCPOPT ( NCVERBOS )


*     Form file name according to UWM/COADS convention
*     ------------------------------------------------
      if ( iyr .eq. 0 ) then
         filen = data_dir // name // '_clm.nc '
      else
         write(yy,'(i2)') iyr
         filen = data_dir // name // '_' // yy // '.nc '
      end if


\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}


*     Open the file
*     -------------
      ncid = NCOPN ( filen, NCNOWRIT, ier)
      if ( ier .ne. 0 ) return

*     Check the year
*     --------------
      iyearid = NCVID (ncid, 'year', ier)
      if ( ier .ne. 0 ) return
      call NCVGT1 (ncid, iyearid, 1, year, ier)
      if ( ier .ne. 0 ) return
      ncyear = year
      if ( 1900+iyr .ne. ncyear) then
         print *, 'RDRAW: year in NetCDF file does not match: ',
     .            iyr, ncyear
         ier = 3
         return
      end if

*     Get the title
*     -------------
      call NCAGTC (ncid, NCGLOBAL, 'title', label, 80, ier)
      if ( ier .ne. 0 ) return

*     Get variable id's
*     -----------------
      boxnumid = NCVID (ncid, 'boxnum', ier)
      if ( ier .ne. 0 ) return
      recrid = NCVID (ncid, 'recrange', ier)
      if ( ier .ne. 0 ) return
      if (choice .eq. 'mean' .or. choice .eq. 'MEAN' ) then
         varid = NCVID (ncid, 'mean', ier)
         if ( ier .ne. 0 ) return
         call NCAGTC (ncid, varid, 'units', units, 80, ier)      
         if ( ier .ne. 0 ) return
      else if (choice .eq. 'std' .or. choice .eq. 'STD' ) then
         varid = NCVID (ncid, 'stdev', ier)
         if ( ier .ne. 0 ) return
      else
         varid = NCVID (ncid, 'nobs', ier)
         if ( ier .ne. 0 ) return
      end if

\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}
*     Get record range for the month
*     ------------------------------
      if (mon .eq. 0) then
         month = 1
      else
         month = mon
      end if
      icoord(1) = 1
      icoord(2) = month
      call NCVGT1 (ncid, recrid, icoord, nrec1, ier)
      if ( ier .ne. 0 ) return
      icoord(1) = 2
      call NCVGT1 (ncid, recrid, icoord, nrec2, ier)
      if ( ier .ne. 0 ) return

*     Get add offset for box number
*     -----------------------------
      call NCAGT(ncid, boxnumid, 'add_offset', ioffset, ier)
      if ( ier .ne. 0 ) return

*     Get the variable and boxnumber, put into grid
*     ---------------------------------------------
      do 10 n = nrec1, nrec2
         call NCVGT1 (ncid, boxnumid, n, nbox, ier)
         if ( ier .ne. 0 ) return
         nbox = nbox + ioffset
         call NCVGT1 (ncid, varid, n, value, ier)
         if ( ier .ne. 0 ) return
         j = int( (nbox-1)/idim ) + 1
         i = mod(nbox,idim)
         if ( i .eq. 0 ) i = idim
         a(i,j) = value
 10   continue

*     Close file
*     ----------
      call NCCLOS (ncid, ier)

      return
      end

*....................................................................

      subroutine RDARR ( ierr, array, idim, jdim, label, filen )

      include 'netcdf.inc'
      integer   idcdf, ierr
      integer   istart(2), icnt(2)
      real      array(idim,jdim)
      character label*80, filen*(*)

      data istart / 1, 1 /

\end{verbatim}
\end{table*}

\begin{table*}
\begin{verbatim}

      icnt(1) = idim
      icnt(2) = jdim

*     Set error handling to not fatal
*     -------------------------------
      call NCPOPT ( NCVERBOS )

*     Open a netcdf file
*     ------------------
      idcdf = NCOPN ( filen, NCNOWRIT, ierr )
      if ( ierr .ne. 0 ) return

*     Get the label
*     -------------
      call NCAGTC ( idcdf, NCGLOBAL, 'title', label, 80, ierr )
      if ( ierr .ne. 0 ) return

*     Get the variable id and values
*     ------------------------------
      idvar = NCVID ( idcdf, 'variable', ierr )
      if ( ierr .ne. 0 ) return
      call NCVGT ( idcdf, idvar, istart, icnt, array, ierr )
      if ( ierr .ne. 0 ) return

*     Close cdf file
*     --------------
      call NCCLOS ( idcdf, ierr )
      if ( ierr .ne. 0 ) return

      return
      end

*....................................................................

      subroutine SETLAND ( a, n, amask, aland )
 
      real  aland, a(n), amask(n)
 
*        This routine sets the array 'a' in such a way that all
*     occurences of  'amask(i) = ALAND'  will correspond to
*     'a(i) = ALAND', i.e., the land values are properly marked.
 
      do 10 i = 1, n
         if ( amask(i) .eq. ALAND ) then
              a(i) = ALAND
         end if
 10   continue
 
      return
      end



\end{verbatim}

\end{table*}


\begin{table*}

\caption{File nc\_raw.h: include file for nc\_raw.f.}
\label{tab:ncraw.h}

\begin{verbatim}
******************************************************************
* nc_raw.h - last change: 8/12/94 (ams)                          *
*                                                                *
*      Include file for nc_raw.f.                                *
*                                                                *
******************************************************************

*      Dimensions
*      ----------
       parameter ( npoint = 42164, idim = 360, jdim = 180 )

*      Special values: ALAND - land value, AMISS - missing value
*      (Do not change ALAND without making same change in file
*       land_mask.nc)
*      ---------------------------------------------------------
       parameter ( ALAND = -1.0E+10, AMISS = +1.0E+10 )

*__________________________________________________________________________________________

\end{verbatim}

\end{table*}



%....................................................................
\cleardoublepage
\section{The structure of UWM/ COADS NetCDF files}
\label{sec:file_struct}

For the sake of completeness, this appendix describes the structure of
the raw and analyzed UWM/COADS NetCDF files. It is expected that most
users will rely on the provided FORTRAN subroutines
(Appendix~\ref{sec:fortran}) to access the data without the need of
knowing the details of the file structure. Such information is
important for those users desiring to access the data using the NetCDF
C Language interface or from application programs such as IDL.  It is
assumed that the reader has familiarity with basic NetCDF concepts.
For an introduction to NetCDF consult Rew \etall~(1993). 

\subsection*{Analyzed UWM/COADS NetCDF files}

Table~\ref{tab:ano_cdl} lists the header information in the file {\tt
buoyancy.nc}, the UWM/COADS NetCDF anomaly file with the analyzed
buoyancy flux data.\footnote{This header information can be produced
with NetCDF's ncdump utility, e.g., {\tt ncdump -h buoyancy.nc}.}.
This file contains 12 months of climatology (variable {\tt clm}) and
540 months of anomalies (variable {\tt anom}) from January '45 to
December '89. In order to conserve space, the data has been stored
with NetCDF {\em short} data type (16 bits). In addition, only the
42,164 oceanic grid-points are stored in the file. In order to obtain
a 360 (longitude) by 180 (latitude) array the following steps are
necessary:
\begin{enumerate}

\item Read in the latitude and longitude of each oceanic grid-point,
variables {\tt lat} and {\tt lon}, respectively. Do not transform the
longitude and latitude to degrees with the {\tt add\_offset} provided.

\item Read in the climatology or anomaly data for a given month/year. 
This will be a vector of type {\tt short} and length 42,164; denote it
by {\tt var}. Also read in the corresponding {\tt scale\_factor} and
{\tt add\_offset} for the variable.

\item Next, initialize the gridded 360 by 180 array ({\tt grid}) 
with a special land value of your choice, and assign the scaled 
{\em float} values by
\begin{verbatim}     
grid(lon(k),lat(k)) 
   = scale_factor * var(k) + add_offset
\end{verbatim}
for {\tt k = 1,..., 42164}. 
\end{enumerate}
Notice that the coordinates of the oceanic grid-points are the same 
for all files in UWM/COADS.

%___________________________________________________________________
\begin{table*}

\caption[Header of analyzed UWM/COADS NetCDF anomaly file]{Header of
analyzed UWM/COADS NetCDF anomaly file for buoyancy fluxes.}
\label{tab:ano_cdl}

\begin{verbatim}

netcdf buoyancy {
dimensions:
        mon = 12 ;
        npoint = 42164 ;
        nyrs = UNLIMITED ; // (45 currently)

variables:
        short mon(mon) ;
                mon:long_name = "month" ;
        short year(nyrs) ;
        short lat(npoint) ;
                lat:long_name = "latitude of nth point" ;
                lat:units = "degrees_north" ;
                lat:add_offset = -90.5f ;
                lat:valid_range = 1s, 180s ;
        short lon(npoint) ;
                lon:long_name = "longitude of nth point" ;
                lon:units = "degrees_east" ;
                lon:add_offset = -0.5f ;
                lon:valid_range = 1s, 360s ;
        short clm(mon, npoint) ;
                clm:long_name = "1945-89 climatology for each month" ;
                clm:units = "kilogram meter-1 second-3" ;
                clm:scale_factor = 1e-07.f ;
                clm:add_offset = 0.f ;
                clm:valid_range = -1900s, 3237s ;
        short anom(nyrs, mon, npoint) ;
                anom:long_name = "anomalies from monthly climatology" ;
                anom:units = "kilogram meter-1 second-3" ;
                anom:scale_factor = 1e-07.f ;
                anom:add_offset = 0.f ;
                anom:valid_range = -2414s, 3024s ;

// global attributes:
                :source = "University of Wisconsin-Milwaukee Version
7.06 0f 3/15/95" ;
                :title = "buoyancy flux (constrained)$" ;
}

\end{verbatim}

\end{table*}
%___________________________________________________________________


\subsection*{Raw UWM/COADS NetCDF files}

The header information for a typical raw \linebreak
UWM/COADS NetCDF file is
listed in Table~\ref{tab:raw_cdl}. The monthly mean ({\tt mean}),
standard deviation ({\tt stdev}), and number observations ({\tt nobs})
for a full year are stored in a single file, as long (32 bits), one-dimensional
vectors of variable length. Associated with each element of these
vectors are 1\deg\ by 1\deg\ box numbers (variable {\tt
boxnum}\footnote{There is a typographic error in the long name 
of variable {\tt boxnum} in the
current version of the raw UWM/COADS NetCDF files. It mistakenly
identifies this variable as {\em 1/2 by 1/2 degree box number},
instead of {\em 1 by 1 degree box number} as shown in 
Table~\ref{tab:raw_cdl}.}) 
which can be used to obtain
the latitude/longitude of each box, or equivalently the corresponding 
indices
{\tt (i,j)} in our standard 360 by 180 array. The 1\deg\ boxes are
numbered sequentially starting from the southern most grid-point
(89.5\deg~S, 0.5\deg~E), then followed by (89.5\deg~S, 1.5\deg~E),
(89.5\deg~S, 2.5\deg~E), ..., (89.5\deg~N, 259.5\deg~E). The
corresponding FORTRAN code to translate the box number {\tt nbox} to
(longitude,latitude) indices (i,j) is
\begin{verbatim}
         j = int( (nbox-1)/idim ) + 1
         i = mod(nbox,idim)
         if ( i .eq. 0 ) i = idim
\end{verbatim}
In order to select data for a particular month one needs to read the
record range information, variable {\tt recrange}. For each month,
this array contains the number of the first and last record for a
particular month. Unlike the analyzed files, the monthly mean data and
statistics are stored with NetCDF's {\tt float} data type.

%___________________________________________________________________
\begin{table*}

\caption[Header of raw UWM/COADS NetCDF file]{Header of raw UWM/COADS
NetCDF file with monthly mean, standard deviation and number of
observation for sea surface temperature, 1945.}
\label{tab:raw_cdl}

\begin{verbatim}

netcdf sst_45 {
dimensions:
        mon = 12 ;
        range = 2 ;
        record = UNLIMITED ; // (46472 currently)

variables:
        byte month(record) ;
                month:long_name = "month" ;
        long boxnum(record) ;
                boxnum:long_name = "1 by 1 degree box number" ;
                boxnum:add_offset = 0 ;
        short year ;
                year:long_name = "year" ;
        float mean(record) ;
                mean:long_name = "mean" ;
                mean:units = "Celsius                                                                         " ;
        float stdev(record) ;
                stdev:long_name = "standard deviation" ;
        float nobs(record) ;
                nobs:long_name = "number of observations" ;
        long recrange(mon, range) ;
                recrange:long_name = "record range for each month" ;

// global attributes:
        :title = "/t1, unanalyzed 1 by 1 degree data for 1945 (Version UWM-1.06 02/11/93)$        " ;
}

\end{verbatim}

\end{table*}
%___________________________________________________________________

%....................................................................
\cleardoublepage
\section{Description of NetCDF FORTRAN Library}
\label{sec:netcdf}

This Appendix describes Unidata Network Common Data Format (NetCDF)
FORTRAN library. For a complete description of NetCDF including the C
Language Library and a tutorial, please refer to the {\em NetCDF User's
Guide}, published by the Unidata Program Center, University
Corporation for Atmospheric Research, located in Boulder, Colorado
(Rew \etall~1993). In addition, both a mailing list and a digest are
available for discussion of the NetCDF interface and announcements
about NetCDF bugs, fixes, and enhancements.  To subscribe, send a
request to one of the following:
\begin{description}
\item[Mailing list:]  netcdfgroup-request@unidata.ucar.edu
\item[Digest:] netcdfdigest-request@unidata.ucar.edu
\end{description}
The NetCDF library is freely available from Unidata's anonymous ftp site
({\em unidata.ucar.edu}). 

This section is adapted from the Unix manual page for the NetCDF FORTRAN
Library.


%...................................................................
\subsection{Function descriptions}

   These routines implement the Unidata NetCDF data-access interface
for the FORTRAN programming language.  Only those arguments which are
unique to the function being described are documented in this section.
See the section~\ref{sec:nc_common} for descriptions of the
other arguments.

\begin{description}

\item[INTEGER FUNCTION NCCRE]{\em (PATHNAME, CMODE, RCODE)}

   Creates a new NetCDF file, returning a NetCDF ID that can
subsequently be used to refer to the NetCDF file.  The new NetCDF file
is placed in define mode.  The mode parameter, CMODE, should be either
NCCLOB or NCNOCLOB.  NCCLOB means that even if the file already
exists, you want to create a new file with the same name, erasing the
old file's contents.  NCNOCLOB means you want to create a new NetCDF
file only if the given file name does not refer to a file that already
exists.

\item[INTEGER FUNCTION NCOPN]{\em (PATHNAME, RWMODE, RCODE)}

   Opens an existing NetCDF file for access.  The mode parameter,
RWMODE, should be either NCWRITE, to open the file for writing, or
NCNOWRIT, to open the file read-only.  {\em Writing} means any kind of
change to the file, including appending or changing data, adding or
renaming dimensions, variables, or attributes, or deleting attributes.

\item[SUBROUTINE NCCREDF]{\em (NCID, RCODE)}

   Puts an open NetCDF file into define mode, so dimensions,
variables, and attributes can be added or renamed and attributes can
be deleted.

\item[SUBROUTINE NCENDF]{\em (NCID, RCODE)}

Takes an open NetCDF file out of define mode.  The changes made to the
NetCDF file while it was in define mode are checked and committed to
disk if no problems occurred.  The NetCDF file is then placed in data
mode, so variable data can be read or written.

\item[SUBROUTINE NCCLOS]{\em (NCID, RCODE)}

   Closes an open NetCDF file.  If the file is in define mode,
NCENDF() will be called before closing.  (In this case, if
NCENDF() returns an error, NCABOR() will automatically be called
to restore the file to the consistent state before define mode was
last entered.)  After an open NetCDF file is closed, its NetCDF ID
will be reassigned to the next NetCDF file that is opened or created.

\item[SUBROUTINE NCINQ]{\em (NCID, NDIMS, NVARS, NATTS, RECDIM, RCODE)}

   Returns information about an open NetCDF file.  Upon successful
return, NVARS will contain the number of variables defined for this
NetCDF file, RECDIM will contain the ID of the unlimited dimension, if
there is one for this NetCDF file (if no unlimited size dimension has
been defined, -1 is returned for the value of RECDIM).

\item[SUBROUTINE NCSNC]{\em (NCID, RCODE)}

   Updates a writable NetCDF file.  The NetCDF file must be in data
mode.  A NetCDF file in define mode is synchronized to disk only when
NCENDF() is called.  It can be expensive in computer resources to
always synchronize to disk after every write of variable data or
change of an attribute value.  There are two reasons you might want to
synchronize after writes: 1) to minimize data loss in case of abnormal
termination; and 2) to make data available to other processes for
reading immediately after it is written.  Data is automatically
synchronized to disk when a NetCDF file is closed, or whenever you
leave define mode.

\item[SUBROUTINE NCABOR]{\em (NCID, RCODE)}

   Closes or deletes a NetCDF file.  If the NetCDF file isn't in
define mode, then the file is closed.  If the file is being created
and is still in define mode, the file is deleted.  If define mode was
entered by a call to NCCREDF(), the NetCDF file is restored to its
state before definition mode was entered and the file is closed.  The
main reason for calling NCABOR() is to restore the NetCDF to a known
consistent state in case anything goes wrong during the definition of
new dimensions, variables, or attributes.  This function is called
automatically if NCCLOS() is called from define mode and the call to
leave define mode before closing fails.

\item[SUBROUTINE NCDDEF]{\em (NCID, NAME, SIZE, RCODE)}

   Adds a new dimension to an open NetCDF file, which must be in
define mode.

\item[INTEGER FUNCTION NCDID]{\em (NCID, NAME, RCODE)}

Returns the ID of a NetCDF dimension, given the name of the dimension.

\item[SUBROUTINE NCDINQ]{\em (NCID, DIMID, NAME, SIZE, RCODE)}

Returns the name and size of a dimension, given its ID.

\item[SUBROUTINE NCDREN]{\em (NCID, DIMID, NAME, RCODE)}

Renames an existing dimension in an open NetCDF file.  If the new name
is longer than the old name, the NetCDF must be in define mode.  You
cannot rename a dimension to have the same name as another dimension.

\item[INTEGER FUNCTION NCVDEF]{\em (NCID, NAME, DATATYPE, NDIMS, VDIMS, RCODE)}

Adds a new variable to an open NetCDF file in define mode.  It returns
a variable ID.

\item[INTEGER FUNCTION NCVID]{\em (NCID, NAME, RCODE)}

Returns the ID of a NetCDF variable, given its name.

\item[SUBROUTINE NCVINQ]{\em (NCID, VARID, NAME, DATATYPE, 
NDIMS, VDIMS, NATTS, RCODE)}

Returns information about a NetCDF variable, given its ID.

\item[SUBROUTINE NCVPT1]{\em (NCID, VARID, INDICES, VALUE, RCODE)}

Puts a single, numeric data value into a numeric variable of an open NetCDF 
file that is in data mode.

\item[SUBROUTINE NCVP1C]{\em (NCID, VARID, INDICES, CHVAL, RCODE)}

Puts a single, character value into a character variable of an open NetCDF 
file that is in data mode.

\item[SUBROUTINE NCVGT1]{\em (NCID, VARID, INDICES, VALUE, RCODE)}

Gets a single, numeric data value from a numeric variable of an open NetCDF 
file that is in data mode.

\item[SUBROUTINE NCVG1C]{\em (NCID, VARID, INDICES, CHVAL, RCODE)}

Gets a single, character value from a character variable of an open NetCDF 
file that is in data mode.

\item[SUBROUTINE NCVPT]{\em (NCID, VARID, START, COUNT, VALUE, RCODE)}

Writes a hyperslab of numeric values into a numeric NetCDF variable of an open
NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVPTC]{\em (NCID, VARID, START, COUNT, STRING, 
LENSTR, RCODE)}

Writes a hyperslab of character values into a character NetCDF variable of 
an open NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVGT]{\em (NCID, VARID, START, COUNT, VALUE, RCODE)}

Reads a hyperslab of numeric values from a numeric NetCDF variable of an open
NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVGTC]{\em (NCID, VARID, START, COUNT, 
STRING, LENSTR, RCODE)}

Reads a hyperslab of character values from a character NetCDF variable of 
an open NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVPTG]{\em (NCID, VARID, START, COUNT, STRIDE, 
IMAP, VALUE, RCODE)}

Writes a generalized hyperslab of numeric values into a numeric NetCDF 
variable of an open NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVPGC]{\em (NCID, VARID, START, COUNT, STRIDE, IMAP,
STRING, RCODE)} 

Writes a generalized hyperslab of character values into a character NetCDF 
variable of an open NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVGTG]{\em (NCID, VARID, START, COUNT, 
STRIDE, IMAP, VALUE, RCODE)}

   Reads a generalized hyperslab of numeric values from a numeric
NetCDF variable of an open NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVGGC]{\em (NCID, VARID, START, COUNT, STRIDE, IMAP,
STRING, RCODE)} 

Reads a generalized hyperslab of character values from a character NetCDF 
variable of an open NetCDF file, which must be in data mode.

\item[SUBROUTINE NCVREN]{\em (NCID, VARID, NAME, RCODE)}

   Changes the name of a NetCDF variable in an open NetCDF.  If the
new name is longer than the old name, the NetCDF must be in define
mode.  You cannot rename a variable to have the name of any existing
variable.

\item[SUBROUTINE NCAPT]{\em (NCID, VARID, NAME, DATATYPE, ATTLEN,
VALUE, RCODE)} 

   Adds or changes a numeric variable attribute or global numeric
attribute of an open NetCDF file.  If this attribute is new, or if the
space required to store the attribute is greater than before, the
NetCDF file must be in define mode.

\item[SUBROUTINE NCAPTC]{\em (NCID, VARID, NAME, DATATYPE, 
LENSTR, STRING, RCODE)}

   Adds or changes a character variable attribute or global character
attribute of an open NetCDF file.  If this attribute is new, or if the
space required to store the attribute is greater than before, the
NetCDF file must be in define mode.

\item[SUBROUTINE NCAINQ]{\em (NCID, VARID, NAME, DATATYPE, 
ATTLEN, RCODE)}

   Returns information about a NetCDF attribute, given its variable ID
and name.  The information returned is the type and length of the
attribute.

\item[SUBROUTINE NCAGT]{\em (NCID, VARID, NAME, VALUE, RCODE)}

   Gets the value(s) of a numeric NetCDF attribute, given its variable
ID and name.

\item[SUBROUTINE NCAGTC]{\em (NCID, VARID, NAME, STRING, LENSTR, RCODE)}

   Gets the value of a character NetCDF attribute, given its variable
ID and name.

\item[SUBROUTINE NCACPY]{\em (INNCID, INVARID, NAME, OUTNCID,
OUTVARID, RCODE)} 

   Copies an attribute from one open NetCDF file to another.  It can
also be used to copy an attribute from one variable to another within
the same NetCDF.  INNCID is the NetCDF ID of an input NetCDF file from
which the attribute will be copied, returned from a previous,
successful call to NCOPN() or NCCRE().  INVARID is the ID of the
variable in the input NetCDF file from which the attribute will be
copied, or NCGLOBAL for a global attribute.  NAME is the name of the
attribute in the input NetCDF file to be copied.  OUTNCID is the
NetCDF ID of the output NetCDF file to which the attribute will be
copied, returned from a previous call to NCOPN() or NCCRE().  It is
permissible for the input and output NetCDF IDs to be the same.  The
output NetCDF file should be in define mode if the attribute to be
copied does not already exist for the target variable, or if it would
cause an existing target attribute to grow.  OUTVARID is the ID of the
variable in the output NetCDF file to which the attribute will be
copied, or NCGLOBAL to copy to a global attribute.

\item[SUBROUTINE NCANAM]{\em (NCID, VARID, ATTNUM, NAME, RCODE)}

   Gets the name of an attribute, given its variable ID and number as
an attribute of that variable.  This function is useful in generic
applications that need to get the names of all the attributes
associated with a variable, since attributes are accessed by name
rather than number in all other attribute functions.  The number of an
attribute is more volatile than the name, since it can change when
other attributes of the same variable are deleted.  This is why an
attribute number is not called an attribute ID.  global attribute.
ATTNUM is the number of the attribute.  The attributes for each
variable are numbered from 1 (the first attribute) to NATTS, where
NATTS is the number of attributes for the variable, as returned from a
call to NCVINQ().

\item[SUBROUTINE NCAREN]{\em (NCID, VARID, NAME, NEWNAME, RCODE)}

   Changes the name of an attribute.  If the new name is longer than
the original name, the NetCDF must be in define mode.  You cannot
rename an attribute to have the same name as another attribute of the
same variable.  NAME is the original attribute name.  NEWNAME is the
new name to be assigned to the specified attribute.  If the new name
is longer than the old name, the NetCDF file must be in define mode.

\item[SUBROUTINE NCADEL]{\em (NCID, VARID, NAME, RCODE)}

   Deletes a NetCDF attribute from an open NetCDF file.  The NetCDF
file must be in define mode.

\item[INTEGER FUNCTION NCTLEN]{\em (DATATYPE, RCODE)}

   Returns the number of bytes in a NetCDF data type.

\item[SUBROUTINE NCPOPT]{\em (NCOPTS)}

   Sets the error-options for the NetCDF library.
                  
\item[SUBROUTINE NCGOPT]{\em (NCOPTS)}

Returns the current error-options of the NetCDF library.

\end{description}

%..............................................................
\subsection{Common argument descriptions}
\label{sec:nc_common}

\begin{description}

\item[INTEGER ATTLEN] is the number of values associated with an
attribute.  If the attribute is of type NCCHAR, then this is the
character variable length.

\item[INTEGER NCID] is the NetCDF ID returned from a previous,
successful call to ncopn() or nccre().

\item[CHARACTER*1 CHVAL] is the character value to be written into or
read from and must be of type NCCHAR.  *Warning*: neither the compiler
nor the NetCDF software can detect if the wrong type of data is used.

\item[INTEGER COUNTS(NDIMS)] specifies the number of data values to be
accessed in terms of the lengths of the sides of the hyperslab.  Thus,
to access a single value, for example, specify counts as (1, 1, ...,
1).  The size of the vector shall be at least the rank of the
associated NetCDF variable and its elements shall correspond, in
order, to the variable's dimensions.  Consequently, if the variable is
a record variable, then the last element of counts is the number of
records to access.

\item[INTEGER DATATYPE] specifies the data type of a NetCDF variable
and is one of the predefined parameters NCBYTE, NCCHAR, NCSHORT,
NCLONG, NCFLOAT, or NCDOUBLE.

\item[INTEGER DIMID] is the ID of a NetCDF dimension.  NetCDF
dimension ID's are allocated sequentially from the positive integers
beginning with 1.

\item[INTEGER IMAP(NDIMS)] is the index mapping vector that specifies
how data values associated with a NetCDF variable are arranged in
memory.  The offset, in bytes, from the memory location pointed to by
the VALUE or STRING argument to a particular datum is given by the
inner (dot) product of the index mapping vector with the coordinates
of the datum specified as offsets from the hyperslab corner.  For
example, on a machine where the size of a `REAL' is four bytes, the
index mapping vector for the array `REAL U(5,3)' is `INTEGER IMAP(2)
/4, 20/'.  Note that the index mapping vector can be used to access
memory-resident data values in a manner that differs radically from
the nominal structure of the associated NetCDF variable.  For example,
the following definitions
\begin{verbatim}
      REAL VEL(2,NY,NX)
      INTEGER IMAP(2)
      IMAP(2) = 2*4
      IMAP(1) = IMAP(2)*NY
\end{verbatim}
can be used to access the memory-resident values of the NetCDF
variable, `U(NX,NY)' (in FORTRAN array notation) even though the
dimensions are transposed and the data is contained in a 3-D array
rather than a 2-D array.  The index mapping vector may contain
negative values if the VALUE or STRING argument is appropriately set.
A scalar `0' as the index mapping vector argument obtains the default
behavior in which the memory-resident values are assumed to have the
same structure as the associated NetCDF variable.

\item[INTEGER INDICES(NDIMS)] specifies the indicial coordinates of
the single NetCDF data value to be accessed.  The indices are relative
to 1; thus, for example, the first data value of a two-dimensional
variable is (1,1).  The size of the vector shall be at least the rank
of the associated NetCDF variable and its elements shall correspond,
in order, to the variable's dimensions.  Consequently, if the variable
is a record variable, then the last index is the record number.

\item[INTEGER LENSTR] specifies the total size, in characters, of the
STRING argument.

\item[CHARACTER*(*) NAME] is the name of a dimension, variable, or
attribute.  It shall begin with an alphabetic character, followed by
zero or more alphanumeric characters including the underscore (`\_').
Case is significant.  As an output argument, it shall be capacious
enough to hold the requested string (the maximum supported length is
given by the predefined parameter MAXNCNAME).  Attribute names that
begin with an underscore (`\_') are reserved for use by the NetCDF
interface.

\item[INTEGER NATTS] is the number of global attributes in a NetCDF
dataset for the NCINQ() subroutine or the number of attributes
associated with a NetCDF variable for the NCVINQ() subroutine.

\item[INTEGER NCOPTS] specifies the handling of errors by the NetCDF
library.  It is zero or the sum of one or more of the error parameters
defined in the FORTRAN include file.  Valid values are `NCVERBOS', to
enable error-messaging, and `NCFATAL', to cause a program abort when
an error occurs.  The default condition is equivalent to
`NCVERBOS+NCFATAL'.

\item[INTEGER NDIMS] is either the total number of dimensions in a
NetCDF dataset or the rank (i.e. the number of dimensions) of a NetCDF
variable.  The value shall not be negative or greater than the
parameter `MAXVDIMS'.

\item[CHARACTER*(*) PATHNAME] is the pathname of a NetCDF file.  It
may be absolute or relative.

\item[INTEGER RCODE] is the returned error code; it is set to 0 if and
only if no error occurred.

\item[INTEGER SIZE] is the size of a NetCDF dimension.  As an input
argument, it shall be a positive integer or the parameter `NCUNLIM'.
At most one such unlimited size dimension, called the record
dimension, shall be defined in a NetCDF dataset.  As an output
argument, it shall be a positive integer.

\item[INTEGER START(NDIMS)] specifies the starting point for accessing
a NetCDF variable's data values in terms of the indicial coordinates
of the corner of the hyperslab.  The indices are relative to 1; thus,
the first data value of a variable is (1, 1, ..., 1).  The size of the
vector shall be at least the rank of the associated NetCDF variable
and its elements shall correspond, in order, to the variable's
dimensions.  Consequently, if the variable is a record variable, then
the last index is the starting record number for accessing the NetCDF
variable's data values.

\item[INTEGER STRIDE(NDIMS)] specifies, for each dimension, the
interval between the accessed values of a NetCDF variable.  The size
of the vector shall be at least the rank of the associated NetCDF
variable and its elements shall correspond, in order, to the
variable's dimensions.  A value of 1 accesses adjacent values of the
NetCDF variable in the corresponding dimension; a value of 2 accesses
every other value of the NetCDF variable in the corresponding
dimension; and so on.  Attempting to access a data value that lies
outside the defined data space of a variable is an error.  A scalar
`0' as the stride argument obtains the default behavior in which
adjacent values are accessed along each dimension.

\item[CHARACTER*(*) STRING] is the block of character values to be
accessed for a NetCDF variable or attribute.

\item[INTEGER, REAL, or DOUBLE VALUE] is the start of the
memory-resident data values to be accessed.  The data should be of the
appropriate type for the NetCDF variable.  *Warning*: neither the
compiler nor the NetCDF software can detect if the wrong type of data
is used.

\item[INTEGER VARID] is the ID of a NetCDF variable or (for the
attribute-access functions) the parameter NCGLOBAL, which is used to
reference global attributes.  NetCDF variable ID's are allocated
sequentially from the positive integers beginning with 1.

\item[INTEGER VDIMS(NDIMS)] is a vector of dimension ID's and defines
the shape of a NetCDF variable.  The size of the vector shall be
greater than or equal to the rank (i.e. the number of dimensions) of
the variable (NDIMS).  The vector shall be ordered by the speed with
which a dimension varies: VDIMS(1) shall be the dimension ID of the
most rapidly varying dimension and VDIMS(NDIMS) shall be the dimension
ID of the most slowly varying dimension.  Consequently, if a variable
is a record variable, then VDIMS(NDIMS) shall be the dimension ID of
the record dimension.  The maximum possible number of dimensions for a
variable is given by the parameter MAXVDIMS.

\end{description}

\cleardoublepage


%......................end netcdf....................................

\small

\section*{References}
\addcontentsline{toc}{part}{References}

\begin{description}


\item{}Aagaard, K., and P. Greismann, 1975: Toward new mass and heat budgets
for the Arctic Ocean. {\em J.\ Geophys.\ Res.}, {\bf 80}, 3821--3827.



\item{}Alexander, R., and R. Mobley, 1976: Monthly average sea-surface
temperature and ice-pack limits on a 1\deg global grid. {\em Mon.\
Wea.\ Rev.}, {\bf 104}, 143--148.



\item{}Arkin, P. A., and B. N. Meisner, 1987: The relationship
between large-scale convective rainfall and cloud cover over the
western hemisphere during 1982--84. {\em Mon.\ Wea.\ Rev.}, {\bf 115},
51--74.


\item{}Barnes, S. L., 1964: A technique for maximizing details in
numerical weather map analysis. {\em J.\ Appl.\ Meteor.}, {\bf 3},
396--409. 


\item{}Baumgartner, A., and E. Reichel, 1975: {\em The World Water Balance}.
Elsevier, 179 pp.


\item{}Beaton, A. E., and J. W. Tukey, 1974: The fitting of power series,
meaning polynomials, illustrated on band-spectroscopic data. 
{\em Technometrics}, {\bf 16}, 147--185.

\item{}Bengtsson, L., and J. Shukla, 1988: Integration of space and in
situ observations to study global climate change. {\em Bull.\ Amer.\
Meteor.\ Soc.}, {\bf 69}, 1130--1143.

%#if (1==1)
%\item{}Bryan, F., and A. Oort, 1984: Seasonal variations of the global
%water balance based on aerological data. {\em J.\ Geophys.\ Res.},
%{\bf 89}, 11717--11730.
%#endif

%#if (1==1)
%\item{}Bryden, H. L., and M. M. Hall, 1980: Heat transport by currents
%across 25\deg N in the Atlantic Ocean. {\em Science}, {\bf 207}, 884--886.
%#endif

\item{}Bottomley, M., C. K. Follund, J. Hsiung, R. E. Newell and
D. E. Parker, 1990: {\em Global Ocean Surface Temperature
Atlas}.  Joint Meteorol.\ Off./Mass.\ Inst.\ Techno.\ Proj., supported by
U.~S.\ Dept.\ of Energy, U.~S.\ Natl.\ Sci.\ Found., and U.~S.\ Off.\ of
Nav.\ Res., funded by U.~K.\ Depts.\ of Energy and Environ., Her
Majesty's Stationery Office, London, 20 pp., 313 plates.


\item{}Budyko, M. I., 1956: {\em The Heat Balance of the Earth's
Surface}, translated by N.\ A.\ Stepanova, 1958. U.~S.\ Dept.\ of
Commerce, Washington D.~C.\ 259 pp.



\item{}Budyko, M. I., 1974: {\em Climate and Life}. Academic Press,
508 pp.



\item{}Bunker, A.\ F., 1976: Computations of surface energy flux and
annual air-sea interaction cycles of the North Atlantic Ocean. {\em
Mon.\ Wea.\ Rev.}, {\bf 104}, 1122--1140.



\item{}Brunt, D., 1932: Notes on radiation in the atmosphere. {\em
Quart. J. R. Met. Soc.}, {\bf 58}, 389-420.


\item{}Cardone, V. J., 1969: Specification of the wind distribution in
the marine boundary layer for wave forecasting.  Report TR69-1, New
York University, New York, NY, 131 pp. [NTIS AD 702 490].

\item{}Cardone, V. J., J. G. Greenwood and M. Cane, 1990: On trends in
historical marine wind data.  {\em J.\ Climate}, {\bf 3}, 113--127.


\item{}Chesneau, L.\ S., 1994: Aboard the Ike.  {\em Mariners Wea.\
Log}, {\bf 38}, 8--14.


\item{}Cressman, G. P., 1959: An operational objective analysis
scheme. {\em Mon.\ Wea.\ Rev.}, {\bf 87}, 329--340.

\item{}Daley, R., 1991: {\em Atmospheric Data Analysis}. Cambridge
University Press, Cambridge, 457pp.


\item{}Dorman, C. E., and R. H. Bourke, 1978: A temperature
correction for Tucker's ocean rainfall estimates. {\em Q.\ J.\ Royal
Meteor.\ Soc.}, {\bf 104}, 765--773.



\item{}Dyer, A.\ J., 1974: A review of flux-profile relationships.
{\em Bound.-Layer Meteor.}, {\bf 7}, 363--372.



\item{} Esbensen, S. K. and J. Kushnir, 1981:  The heat budget of the
global oceans: An atlas based on estimates from marine surface
observations.  Oregon State University Climate Research Institute Rep.
No. 29, 27 pp.



\item{}Esbensen, S. K., and R. Reynolds, 1981: Estimating monthly
averaged air--sea transfers of heat and momentum using the bulk
aerodynamic method. {\em J.\ Phys.\ Oceanogr.}, {\bf 11}, 457--465.


\item{}Farmer, G., T. M. L. Wigley, P. D. Jones and M. Salmon, 1989:
Documenting and explaining recent global-mean temperature changes.
{\em Final Report to Natural Environment Research Council.}, Climate
Research Unit, University of East Anglia, U.~K.


\item{}Fissel, D.\ B., S.\ Pond and M.\ Miyake, 1977: Computation of
surface fluxes from climatological and synoptic data.
{\em Mon.\ Wea.\ Rev.}, {\bf 105}, 26--36.


\item{}Folland, C. K., 1991: Sea temperature bucket models used to
correct historical SST data in the Meteorological Office.
Climate Research Technical Note No.\ 14, British Meteorological
Office, England.

\item{}Folland, C. K., and J. Hsiung, 1986: Correction of seasonally
varying biases in uninsulated bucket sea surface temperature data using
a physical model.  Met.\ Office Synoptic Climatology Branch Memo
No.\ 154.

\item{}Folland, C. K., D. E. Parker and F. E. Kates, 1984: World wide
marine temperature fluctuations 1856--1981. {\em Nature}, {\bf 310},
670--673. 


\item{}Hahn, C.\ J., S.\ G. Warren and J.\ London, 1992: The use of COADS ship
observations in cloud climatologies. {\em Proceedings of the International
COADS Workshop, Boulder, Colorado, 13--15 January}, U.~S.\ Dept.\ of Commerce
NOAA/ERL, 271--280.



\item{}Hall, M. M., and H. L. Bryden, 1982:  Direct estimates and
mechanisms of ocean heat transport. {\em Deep--Sea Res.}, {\bf 29}, 339--359.



\item{}Halpern, D., 1988: Moored surface wind observations at four
sites along the Pacific Equator between 140\deg and 95\deg~W\@.
{\em J.\ Climate}, {\bf 1}, 1251-1260.



\item{}Hellerman, S. and M. Rosenstein, 1983: Normal monthly wind
stress over the World Ocean with error estimates. {\em J. Phys.
Oceanogr.}, {\bf 13}, 1093--1104.



\item{}Hastenrath, S., 1982: On meridional heat transports in the world
ocean. {\em J.\ Phys.\ Oceanogr.}, {\bf 10}, 159-170.



\item{}Houghton, H.\ G., 1985: {\em Physical Meteorology}. MIT Press, 442pp.



\item{}Hsiung, J., 1985: Estimates of global oceanic meridional heat
transport. {\em J.\ Phys.\ Oceanogr.}, {\bf 15}, 1405--1413.



\item{}Hsiung, J., 1986: Mean surface energy fluxes over the global
ocean. {\em J. Geophys. Res.}, {\bf 91}, 10 585--10 606.


\item{}Isemer, H.--J. and L. Hasse, 1987: {\em The Bunker Atlas of the
North Atlantic Ocean. Vol.~2: Air--sea interactions.} Springer Verlag,
252 pp.

\item{}---------, 1991: The scientific Beaufort equivalent scale:
Effects on wind statistics and climatological air--sea flux estimates
in the North Atlantic ocean. {\em J.\ Climate}, {\bf 4}, 819--836.


\item{}Isemer, H.--J., J. Willebrand and L. Hasse, 1989: Fine adjustment
of large air-sea energy flux parameterizations by direct estimates of ocean
heat transport. {\em J.\ Climate}, {\bf 2}, 1173--1184.



\item Jazwinski,~A.~H., 1970: {\it Stochastic Processes and Filtering
Theory.} Academic Press, 376 pp.


\item{}Kalnay, E., and R.\ Jenne, 1991: Summary of the NMC/NCAR
reanalysis workshop of April 1991. {\em Bull.\ Amer.\ Meteor.\ Soc.},
{\bf 72}, 1897--1904.

\item{}Kaufeld, L., 1981: The development of a new Beaufort equivalent
scale. {\em Meteor.\ Rundsch.}, {\bf 34}, 17--23.

\item{}Kent, E. C. and P. K. Taylor, 1991: Ships observing marine
climate: a catalogue of the Voluntary Observing Ships Participating in
the VSOP-NA. {\em Marine and Oceanographic Activities Report 25}, WMO,
Geneva, 123pp.

\item{}Kent, E. C. and P. K. Taylor, 1995: A comparison of heat flux
estimates for the North Atlantic ocean. {\em J. Phys. Oceanogr.}. In
press. 

\item{}Kent, E. C., P. K. Taylor, B. S. Truscott and J. S. Hopkins,
1993a: The accuracy of voluntary observing ships' meteorological
observations -- Results of the VSOP-NA. {\em J.\ Atmos.\ \& Oceanic
Tech.}, {\bf 10}, 591--608.

\item{}Kent, E. C., R. J. Tiddy and P. K. Taylor, 1993b: Correction of
marine daytime air temperature observations for radiation effects.
{\em J.\ Atmos.\ \& Oceanic Tech.}, {\bf 10}, 900--906.

\item{}Kushnir, Y., 1994: Interdecadal variations in North
Atlantic sea surface temperature and associated atmospheric
conditions. {\em J. Climate}, {\bf 7}, 141--157.


\item{}Lacombe, H., and C. Richez, 1981: The regime of the Strait of
Gibraltar, in {\em Hydrodynamics of Semi-enclosed Seas}, J. Nihoul,
ed. Elsevier, 13--73.



\item{}Large, W., and S. Pond, 1981: Open ocean 
momentum flux measurements in moderate to strong 
winds. {\em J.\ Phys.\ Oceanogr.}, {\bf 11}, 324--336.



\item{}Large, W., and S. Pond, 1982: Sensible and
latent heat flux measurements over the ocean.
{\em J.\ Phys.\ Oceanogr.}, {\bf 12}, 464--482.


\item{}Levitus, S., 1982: Climatological Atlas of the World
Ocean, NOAA Prof.\ Paper No.\ 13, U.~S.\ Government Printing Office,
Washington D.~C., 17 fiches, 173 pp.


\item{}Levitus, S., R.\ Burgett and T.\ Boyer, 1994: {\em World Ocean
Atlas 1994, Volume 3: Salinity.} NOAA Atlas NESDIS 3, U.~S.\
Government Printing Office, Washington D.~C., 99pp.



\item{}List, R.\ J., 1958: {\em Smithsonian Meteorological
Tables}, 6th Revised Ed. Smithsonian Institution Press, 527pp.



\item Lorenc, A.\ C., 1986: Analysis methods for numerical weather
prediction. {\em Q.\ J.\ R.\ Met.\ Soc.},  {\bf 112,} 1177--1194.



\item{}Luther, D.\ S., and D.\ E.\ Harrison, 1984: Observing
long-period fluctuations of surface winds in the Tropical Pacific:
Initial results from island data.
{\em Mon.\ Wea.\ Rev.}, {\bf 112}, 285--302.



\item{}Menke, W. 1984: {\em Geophysical Data Analysis: Discrete Inverse
Theory.} Academic Press, 257 pp.



\item{}Oberhuber, J. M., 1988: An Atlas Based on the COADS Data Set:
The Budgets of Heat, Buoyancy, and Turbulent Kinetic Energy at the
Surface of the Global Ocean.  Report No.\ 15, Max-Planck Institut
f\"ur Meteorology.



\item{}Paulson, C.\ A., 1970: Representation of wind speed and
temperature profiles in the unstable atmospheric surface layer. {\em
J. Fluid Mech.}, {\bf 50}, 257--269.



\item{}Payne, R. E., 1972: Albedo of the sea surface. {\em J.\ Atmos.\
Sci.}, {\bf 29}, 959--970.



\item{}Peixoto, J.\ P., and A.\ H.\ Oort, 1992: {\em Physics of
Climate.} American Institute of Physics, 520pp.


\item{}Petersen, P., 1927: Zur Bestimmung der Windst\"arke auf See.
{\em Ann.\ Hydrogr.}, {\bf 55}, 69--72.

\item{}Rabiner, L.\ R., M.\ R.\ Sambur and C.\ E.\ Schmidt, 1975: Applications
of a nonlinear smoothing algorithm to speech processing. {\em IEEE Transactions
on Acoustics, Speech, and Signal Processing}, {\bf ASSP--23}, 552--557.


\item{}Rago, T. T., and H. T. Rossby, 1987: Heat transport into the
North Atlantic Ocean north of 27\deg N latitude.  {\em J.\ Phys.\ 
Oceanogr.}, {\bf 17}, 854--871.


\item{}Ramage, C. S., 1984: Can shipboard measurements reveal secular
changes in tropical air--sea heat flux? {\em J.\ Climate Appl.\
Meteor.}, {\bf 23}, 187--193.


\item{}Ramage, C.\ S., 1986: A comparative analysis of marine weather
records from ocean weather stations and merchant ships.
Proceedings of a COADS Workshop [NOAA Tech.\ Mem., ERL ESG-23].



\item{}Ramage, C.\ S., 1987: Secular changes in reported surface wind speeds
over the ocean. {\em J.\ Climate Appl.\ Meteor.}, {\bf 26}, 525--528.



\item{}Reed, R.\ K., 1977: On estimating insolation over the oceans.
{\em J.\ Phys.\ Oceanogr.}, {\bf 7}, 482-485.



\item{}Rew, R., G. Davis and S. Emmerson, 1993: {\em NetCDF User's Guide, an
Interface for Data Access}. Unidata Program Center, University
Corporation for Atmospheric Research, Boulder, CO, 186pp.


\item{}Reynolds, R. W., 1988: A real--time global sea surface temperature
analysis. {\em J.\ Climate}, {\bf 1}, 75--86.


\item{}Riehl, H., 1947: Diurnal variation of cloudiness over the subtropical
Atlantic ocean. {\em Bull.\ Amer.\ Meteor.\ Soc.}, {\bf 28}, 37--40.


\item{}Roll, H.\ U., 1965: {\em Physics of the Marine Atmosphere}.
Int.\ Geophys.\ Ser., Vol.\ 7, 426 pp.


\item{}Rosati, A., and K. Miyakoda, 1988: A general circulation model
for the upper ocean circulation. {\em J.\ Phys.\ Oceanogr.}, {\bf 18},
1601--1626.


\item{}Schlatter, T. W., and D. V. Baker, 1981: 
Algorithms for thermodynamic calculations. NOAA/ERL PROFS 
Program Office, Boulder, CO, 34 pp.


\item{}Schmitt, R. W., P. S. Bogden and C. E. Dorman, 1989:
Evaporation minus precipitation and density fluxes for the North
Atlantic. {\em J.\  Phys.\  Oceanogr.}, {\bf 19}, 1208--1221.



\item{}Schneider, G., P. Paluzzi and J. P. Oliver, 1989: Systematic error in
the synoptic sky cover record of the South Pole. {\em J.\ Climate}, {\bf 2}, 
295--302.


\item{}Schubert, S. D., R. B. Rood and J. Pfaendtner, 1993: An
assimilated dataset for earth sciences applications. {\em Bull.\ Amer.\
Meteor.\ Soc.}, {\bf 74}, 2331--2342.



\item{}Shapiro, R., 1970: Smoothing, filtering, and boundary effects. 
{\em Rev.\ of Geophys.\ and Space Phys.}, {\bf 8}, 359--387.

\item{}Simpson, G. C., 1906: The velocity equivalents of the Beaufort
scale.  Rep.\ of Director of Meteorological Office No.\ 180, London.


\item{}Simpson, J. J. and C. A. Paulson, 1979: Mid-ocean observations
of atmospheric radiation. {\em Quart. J. R. Met. Soc.}, {\bf 105},
487--502.


\item{}Slutz, R. J., S. J. Lubker, J. D. Hiscox, S. D. Woodruff, R. L.
Jenne, D. H. Joseph, P. M. Steurer and J. D. Elms, 1985: COADS,
Comprehensive Ocean--Atmosphere Data Set, Release 1.  Climate Research
Program, Environmental Research Laboratory, Boulder, CO, 262 pp.


\item{}Stommel, H. 1980: Assymetry of interoceanic fresh-water and
heat fluxes. {\em Proc. Natl. Acad. Sci. USA}, {\bf 77}, 2377--2381.




\item{}Sverdrup, H.\ U., 1933: {\em The Norwegian North Polar Expedition with
the ``Maud'', 1918--1925, Scientific Results}, Vol. II: Meteorology, Part I,
Discussion, John Griegs, Bergen, 331pp.



\item{}Trenberth, K.\ E., W.\ G.\ Large and J.\ G.\ Olson, 1989: The
effective drag coefficient for evaluating wind stress over the oceans.
{\em J.\ Climate}, {\bf 2}, 1507--1516.



\item{}Trenberth, K.\ E., W.\ G.\ Large and J.\ G.\ Olson, 1990:
The mean annual cycle in global
ocean wind stress. {\em J. Phys. Oceanogr.}, 
{\bf 20}, 1742-1760. 



\item{}Tucker, G.\ B., 1961: Precipitation over the North Atlantic Ocean.
{\em Q.\ J.\ Royal Meteor.\ Soc.}, {\bf 87}, 147--158.



\item{}United Nations Educational, Scientific, and Cultural
Organisation (UNESCO),
1969: {\em Discharge of Selected Rivers of the World}. UNESCO,
Switzerland, 3 volumes.



\item{}U.~S.\ Government Printing Office, 1990: {\em Astronomical Almanac.}  
Nautical Almanac Office, United States Naval Observatory.



\item{}van der Leeden, F., 1975: {\em Water Resources of the World:
Selected Statistics}. Water Information Center, Port Washington, NY,
568 pp.


\item{}Woodruff, S. D., R. J. Slutz, R. L. Jenne and P. M. Steurer,
1987: A comprehensive ocean--atmosphere data set. {\em  Bull.\ Amer.\
Meteor.\ Soc.}, {\bf 68}, 1239--1250.

\item{}World Meteorological Organization (WMO), 1970: Reports on
marine science affairs.  Rep.\ No.\ 3: The Beaufort scale of wind force.
WMO, Geneva, Switzerland, 22pp.

\item{}World Meteorological Organization (WMO), 1990: International
list of selected, suplementary and auxiliary ships. {\em WMO
Publ. No. 47}, World Meteorological Organization, Geneva.


\item{}Wunsch, C., 1984: An eclectic Atlantic Ocean circulation model.
Part I: The meridional flux of heat.
{\em J.\ Phys.\ Oceanogr.}, {\bf 14}, 1712--1733.



\item{}Yaglom, A.\ M., 1977: Comments on wind and temperature
flux-profile relationships. {\em Bound.-Layer Meteor.}, {\bf 11},
89--102.


\item{}Young, C.\ C., A.\ M.\ da Silva and S.\ Levitus, 1993: Monthly
Distribution of SST Observations in COADS: 1945-89. {\em Tech.\ Rep.\
Geosci.\ 93.01}, University of Wisconsin-Milwaukee, 275pp.

\end{description}


%.......................................................................
\end{document}










\end{document}


